{
  "text": "gitclonehttps://github.com/ios-control/ios-deploy.git cdios-deploy/ xcodebuild cdbuild/Release ./ios-deploy ln-s<your-path-to-ios-deploy>/build/Release/ios-deploy/usr/local/bin/ios-deploy Thelastlinecreatesasymboliclinkandmakestheexecutableavailablesystem-wide. Reloadyourshelltomakethenew commandsavailable: zsh: #.~/.zshrc bash: #.~/.bashrc iOSbackup Platform: ios Availableat: https://github.com/avibrazil/iOSbackup iOSbackupisaPython3classthatreadsandextractsfilesfromapassword-encryptediOSbackupcreatedbyiTuneson MacandWindows. MobSF for iOS Platform: ios Availableat: https://github.com/MobSF/Mobile-Security-Framework-MobSF ByrunningMobSFlocallyonamacOShostyou’llbenefitfromaslightlybetterclass-dumpoutput. OnceyouhaveMobSFupandrunningyoucanopenitinyourbrowserbynavigatingtohttp://127.0.0.1:8000. Simply dragtheIPAyouwanttoanalyzeintotheuploadareaandMobSFwillstartitsjob. AfterMobSFisdonewithitsanalysis,youwillreceiveaone-pageoverviewofalltheteststhatwereexecuted. Thepage issplitupintomultiplesectionsgivingsomefirsthintsontheattacksurfaceoftheapplication. 550\\nThefollowingisdisplayed: • Basicinformationabouttheappanditsbinaryfile. • Someoptionsto: – ViewtheInfo.plistfile. – Viewthestringscontainedintheappbinary. – Download a class-dump, if the app was written in Objective-C; if it is written in Swift no class-dump can be created. • ListallPurposeStringsextractedfromtheInfo.plistwhichgivesomehintsontheapp’spermissions. • ExceptionsintheAppTransportSecurity(ATS)configurationwillbelisted. • Abriefbinaryanalysisshowingiffreebinarysecurityfeaturesareactivatedore.g.ifthebinarymakesuseofbanned APIs. • ListoflibrariesusedbytheappbinaryandlistofallfilesinsidetheunzippedIPA. IncontrasttotheAndroidusecase,MobSFdoesnotofferanydynamicanalysisfeaturesforiOSapps. RefertoMobSFdocumentationformoredetails. class-dump Platform: ios Availableat: http://stevenygard.com/projects/class-dump/ class-dumpbySteveNygardisacommandlineutilityforexaminingtheObjective-CruntimeinformationstoredinMach-O (Machobject)files. Itgeneratesdeclarationsfortheclasses,categories,andprotocols. Sileo Platform: ios Availableat: https://cydia-app.com/sileo/ SinceiOS11jailbreaksareintroducingSileo,whichisanewjailbreakapp-storeforiOSdevices. ThejailbreakChimerafor iOS12isalsorelyingonSileoasapackagemanager. 551\\nCydia Platform: ios Availableat: https://cydia.saurik.com/ CydiaisanalternativeappstoredevelopedbyJayFreeman(aka“saurik”)forjailbrokendevices. Itprovidesagraphical user interface and a version of the Advanced Packaging Tool (APT). You can easily access many “unsanctioned” app packagesthroughCydia. MostjailbreaksinstallCydiaautomatically. Many tools on a jailbroken device can be installed by using Cydia, which is the unofficial AppStore for iOS devices and allowsyoutomanagerepositories. InCydiayoushouldadd(ifnotalreadydonebydefault)thefollowingrepositoriesby navigatingtoSources->Edit,thenclickingAddinthetopleft: • http://apt.thebigboss.org/repofiles/cydia/: OneofthemostpopularrepositoriesisBigBoss,whichcontainsvarious packages,suchastheBigBossRecommendedToolspackage. • https://cydia.akemi.ai/: Add“Karen’sRepo”togettheAppSyncpackage. • https://build.frida.re: InstallFridabyaddingtherepositorytoCydia. • https://repo.chariz.io: UsefulwhenmanagingyourjailbreakoniOS11. • https://apt.bingner.com/: Anotherrepository,withquietafewgoodtools,isElucubratus,whichgetsinstalledwhen youinstallCydiaoniOS12usingUnc0ver. IncaseyouareusingtheSileoAppStore,pleasekeepinmindthattheSileoCompatibilityLayersharesyoursources betweenCydiaandSileo,however,CydiaisunabletoremovesourcesaddedinSileo,andSileoisunabletoremove sourcesaddedinCydia. Keepthisinmindwhenyou’retryingtoremovesources. AfteraddingallthesuggestedrepositoriesaboveyoucaninstallthefollowingusefulpackagesfromCydiatogetstarted: • adv-cmds: Advancedcommandline,whichincludestoolssuchasfinger,fingerd,last,lsvfs,md,andps. • AppList: Allowsdeveloperstoquerythelistofinstalledappsandprovidesapreferencepanebasedonthelist. • Apt: AdvancedPackageTool,whichyoucanusetomanagetheinstalledpackagessimilarlytoDPKG,butinamore friendlyway. Thisallowsyoutoinstall,uninstall,upgrade,anddowngradepackagesfromyourCydiarepositories. ComesfromElucubratus. • AppSyncUnified: AllowsyoutosyncandinstallunsignediOSapplications. • BigBossRecommendedTools: InstallsmanyusefulcommandlinetoolsforsecuritytestingincludingstandardUnix utilitiesthataremissingfromiOS,includingwget,unrar,less,andsqlite3client. • class-dump: A command line tool for examining the Objective-C runtime information stored in Mach-O files and generatingheaderfileswithclassinterfaces. • class-dump-z: AcommandlinetoolforexaminingtheSwiftruntimeinformationstoredinMach-Ofilesandgener- atingheaderfileswithclassinterfaces. ThisisnotavailableviaCydia,thereforepleaserefertoinstallationstepsin ordertogetclass-dump-zrunningonyouriOSdevice. Notethatclass-dump-zisnotmaintainedanddoesnotwork wellwithSwift. Itisrecommendedtousedsdumpinstead. • Clutch: Usedtodecryptanappexecutable. • Cycript: Is an inlining, optimizing, Cycript-to-JavaScript compiler and immediate-mode console environment that canbeinjectedintorunningprocesses(associatedtoSubstrate). • CydiaSubstrate: Aplatformthatmakesdevelopingthird-partyiOSadd-onseasierviadynamicappmanipulation orintrospection. • cURL:Isawellknownhttpclientwhichyoucanusetodownloadpackagesfastertoyourdevice. Thiscanbeagreat helpwhenyouneedtoinstalldifferentversionsofFrida-serveronyourdeviceforinstance. • DarwinCCTools: Ausefulsetoftoolslikenm,andstripthatarecapableofauditingmach-ofiles. • IPAInstallerConsole: ToolforinstallingIPAapplicationpackagesfromthecommandline. Afterinstallingtwocom- mandswillbeavailableinstallipaandipainstallerwhichareboththesame. • Frida: Anappyoucanusefordynamicinstrumentation. PleasenotethatFridahaschangeditsimplementationof itsAPIsovertime,whichmeansthatsomescriptsmightonlyworkwithspecificversionsoftheFrida-server(which forces you to update/downgrade the version also on macOS). Running Frida Server installed via APT or Cydia is recommended. Upgrading/downgradingafterwardscanbedone,byfollowingtheinstructionsofthisGithubissue. • Grep: Handytooltofilterlines. • Gzip: AwellknownZIPutility. • PreferenceLoader: ASubstrate-basedutilitythatallowsdeveloperstoaddentriestotheSettingsapplication,similar totheSettingsBundlesthatAppStoreappsuse. 552\\n• SOcketCAT:autilitywithwhichyoucanconnecttosocketstoreadandwritemessages. Thiscancomeinhandyif youwanttotracethesyslogoniOS12devices. BesidesCydiayoucanalsosshintoyouriOSdeviceandyoucaninstallthepackagesdirectlyviaapt-get,likeforexample adv-cmds. apt-getupdate apt-getinstalladv-cmds class-dump-z Platform: ios Availableat: https://code.google.com/archive/p/networkpx/wikis/class_dump_z.wiki class-dump-zisclass-dumpre-writtenfromscratchinC++,avoidingtheuseofdynamiccalls. Removingtheseunneces- sarycallsmakesclass-dump-znearly10timesfasterthanitspredecessor. Plutil Platform: ios Availableat: https://www.theiphonewiki.com/wiki/Plutil Aprogramthatcanconvert.plistfilesbetweenabinaryversionandanXMLversion-https://www.theiphonewiki.com/wi ki/Plutil otool Platform: ios Availableat: http://www.manpagez.com/man/1/otool/ otoolisatoolfordisplayingspecificpartsofobjectfilesorlibraries. ItworkswithMach-Ofilesanduniversalfileformats. BinaryCookieReader Platform: ios Availableat: https://github.com/as0ler/BinaryCookieReader AtooltodumpallthecookiesfromthebinaryCookies.binarycookiesfile-https://github.com/as0ler/BinaryCookieReader /blob/master/BinaryCookieReader.py objection for iOS Platform: ios Availableat: https://github.com/sensepost/objection ObjectionoffersseveralfeaturesspecifictoiOS.Youcanfindthefulllistoffeaturesontheproject’spage,butherearea fewinterestingones: • RepackageapplicationstoincludetheFridagadget • DisableSSLpinningforpopularmethods 553\\n• Accessapplicationstoragetodownloadoruploadfiles • ExecutecustomFridascripts • DumptheKeychain • Readplistfiles Allthesetasksandmorecanbeeasilydonebyusingthecommandsinobjection’sREPL.Forexample,youcanobtainthe classesusedinanapp,functionsofclassesorinformationaboutthebundlesofanappbyrunning: OWASP.iGoat-Swifton (iPhone:12.0)[usb] #ioshookinglistclasses OWASP.iGoat-Swifton (iPhone:12.0)[usb] #ioshookinglistclass_methods<ClassName> OWASP.iGoat-Swifton (iPhone:12.0)[usb] #iosbundleslist_bundles If you have a jailbroken device with frida-server installed, Objection can connect directly to the running Frida server to provideallitsfunctionalitywithoutneedingtorepackagetheapplication. However,itisnotalwayspossibletojailbreak thelatestversionofiOS,oryoumayhaveanapplicationwithadvancedjailbreakdetectionmechanisms. Theabilitytoperformadvanceddynamicanalysisonnon-jailbrokendevicesisoneofthefeaturesthatmakesOb- jectionincrediblyuseful. Afterfollowingtherepackagingprocessyouwillbeabletorunalltheaforementionedcommands whichmakeitveryeasytoquicklyanalyzeanapplication,orgetaroundbasicsecuritycontrols. Using Objection on iOS StartingupObjectiondependsonwhetheryou’vepatchedtheIPAorwhetheryouareusingajailbrokendevicerunning Frida-server. ForrunningapatchedIPA,objectionwillautomaticallyfindanyattacheddevicesandsearchforalistening Frida gadget. However, when using frida-server, you need to explicitly tell frida-server which application you want to analyze. ##ConnectingtoapatchedIPA $objectionexplore ##Usingfrida-pstogetthecorrectapplicationname $frida-ps -Ua|grep -iTelegram 983 Telegram ##ConnectingtotheTelegramappthroughFrida-server $objection --gadget=\"Telegram\" explore OnceyouareintheObjectionREPL,youcanexecuteanyoftheavailablecommands. Belowisanoverviewofsomeof themostusefulones: ##Showthedifferentstoragelocationsbelongingtotheapp $env ##Disablepopularsslpinningmethods $iossslpinningdisable ##DumptheKeychain $ioskeychaindump ##DumptheKeychain,includingaccessmodifiers.Theresultwillbewrittentothehostinmyfile.json $ioskeychaindump --json <myfile.json> ##Showthecontentofaplistfile $iosplistcat <myfile.plist> MoreinformationonusingtheObjectionREPLcanbefoundontheObjectionWiki swift-demangle Platform: ios swift-demangleisanXcodetoolthatdemanglesSwiftsymbols. Formoreinformationrunxcrun swift-demangle -help onceinstalled. 554\\nKeychain-Dumper Platform: ios Availableat: https://github.com/mechanico/Keychain-Dumper Keychain-dumperisaniOStooltocheckwhichkeychainitemsareavailabletoanattackeronceaniOSdevicehasbeen jailbroken. TheeasiestwaytogetthetoolistodownloadthebinaryfromitsGitHubrepoandrunitfromyourdevice: $gitclonehttps://github.com/ptoomey3/Keychain-Dumper $scp -P2222Keychain-Dumper/keychain_dumperroot@localhost:/tmp/ $ssh -p2222root@localhost iPhone:~root#chmod+x/tmp/keychain_dumper iPhone:~root#/tmp/keychain_dumper ForusageinstructionspleaserefertotheKeychain-dumperGitHubpage. Grapefruit Platform: ios Availableat: https://github.com/ChiChou/grapefruit GrapefruitisaniOSappassessmenttoolthatisusingtheFridaserverontheiOSdeviceandisabstractingmanypene- trationtestingtasksintoaWebUI.Itcanbeinstalledvianpm. $npminstall -gigf $grapefruit listeningonhttp://localhost:31337 Whenyouexecutethecommandgrapefruitalocalserverwillbestartedonport31337. Connectyourjailbrokendevice withtheFridaserverrunning,oranon-jailbrokendevicewitharepackagedappincludingFridatoyourmachineviaUSB. Onceyouclickonthe“iPhone”iconyouwillgetanoverviewofallinstalledapps. With Grapfruit it’s possible to explore different kinds of information concerning an iOS app. Once you selected the iOS appyoucanperformmanytaskssuchas: • Getinformationaboutthebinary • Viewfoldersandfilesusedbytheapplicationanddownloadthem • InspecttheInfo.plist • GetaUIDumpoftheappscreenshownontheiOSdevice • Listthemodulesthatareloadedbytheapp • Dumpclassnames •",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 174
  },
  "embedding": [
    0.0011456083739176393,
    -0.038089971989393234,
    -0.018915388733148575,
    -0.015236889012157917,
    -0.013493411242961884,
    -0.012046333402395248,
    -0.037912510335445404,
    0.03375536948442459,
    -0.03732254356145859,
    0.03826332837343216,
    0.1115795150399208,
    -0.06193467974662781,
    -0.008865217678248882,
    0.06251659244298935,
    0.037555839866399765,
    0.038579657673835754,
    0.03219011053442955,
    0.04881351813673973,
    -0.02095249854028225,
    0.06076402962207794,
    0.017937790602445602,
    0.038824066519737244,
    0.05574547499418259,
    0.0020473517943173647,
    0.013563619926571846,
    -0.11086214333772659,
    -0.07262472808361053,
    -0.0357164666056633,
    -0.04008083790540695,
    -0.0192857813090086,
    0.0029442720115184784,
    0.02851141430437565,
    -0.017966587096452713,
    0.014164097607135773,
    0.05189934000372887,
    0.021602027118206024,
    0.11039512604475021,
    -0.007895193062722683,
    0.0010081998771056533,
    -0.10587012767791748,
    -0.043211109936237335,
    0.025381695479154587,
    -0.039343129843473434,
    0.05505293235182762,
    -0.06260442733764648,
    0.026740029454231262,
    0.0100099490955472,
    -0.030625084415078163,
    -0.003601330565288663,
    0.008128911256790161,
    0.046581488102674484,
    -0.01583370938897133,
    0.019118934869766235,
    0.088009774684906,
    0.010400519706308842,
    0.0349615179002285,
    -0.037974659353494644,
    0.052934449166059494,
    0.12971608340740204,
    0.09867437183856964,
    -0.017331551760435104,
    0.09477708488702774,
    -0.026633352041244507,
    0.004919431172311306,
    0.034087490290403366,
    0.035936057567596436,
    -0.010575816966593266,
    -0.015039796009659767,
    -0.046007443219423294,
    -0.0421924963593483,
    0.014527840539813042,
    -0.06948020309209824,
    0.0676637664437294,
    -0.005861160811036825,
    -0.018719768151640892,
    -0.005945305339992046,
    0.037933316081762314,
    -0.021675311028957367,
    -0.07416047155857086,
    -0.08685847371816635,
    -0.009376331232488155,
    0.049729399383068085,
    0.04185834154486656,
    0.06025046482682228,
    0.053036317229270935,
    0.09227537363767624,
    -0.02656514011323452,
    0.058025866746902466,
    0.016099052503705025,
    0.034195635467767715,
    0.057650379836559296,
    0.02287975326180458,
    -0.01228579506278038,
    -0.04462271183729172,
    0.04439206048846245,
    -0.062090080231428146,
    -0.0196885634213686,
    -0.007280539721250534,
    -0.0764043778181076,
    0.007176054175943136,
    0.03720453009009361,
    -0.06953004002571106,
    0.06864769756793976,
    0.004725698847323656,
    -0.025258978828787804,
    0.025198355317115784,
    0.062315285205841064,
    -0.0748077854514122,
    -0.07253944873809814,
    0.09437184780836105,
    -0.006406337954103947,
    0.04746752604842186,
    -0.034100063145160675,
    -0.03128249570727348,
    -0.002437211573123932,
    0.037767212837934494,
    -0.053733471781015396,
    0.08539488911628723,
    0.0442412868142128,
    -0.007494521792978048,
    0.005737655330449343,
    0.023902975022792816,
    -0.02468336932361126,
    -0.0733291506767273,
    -0.04685230553150177,
    0.011252474039793015,
    -0.0025290187913924456,
    1.0040606220403497e-32,
    -0.004595073871314526,
    0.03539780154824257,
    -0.09416300058364868,
    0.045686736702919006,
    0.04237309470772743,
    -0.09102649241685867,
    0.09124966710805893,
    0.012527888640761375,
    -0.04095440357923508,
    0.033108942210674286,
    0.00020636492990888655,
    0.027373241260647774,
    -0.061744287610054016,
    0.029233772307634354,
    -0.00021019937412347645,
    -0.1357743740081787,
    -0.0072837574407458305,
    -0.02548869326710701,
    0.06733357161283493,
    0.022039838135242462,
    0.028877006843686104,
    -0.04096272587776184,
    -0.06692171841859818,
    -0.01965814083814621,
    0.04599689319729805,
    0.04985887557268143,
    0.022365981712937355,
    -0.008067050948739052,
    0.018795335665345192,
    0.03986611217260361,
    -0.05101329833269119,
    0.02922293171286583,
    0.0045534223318099976,
    -0.07361870259046555,
    -0.00933411717414856,
    -0.09567698836326599,
    0.009648572653532028,
    -0.010842414572834969,
    0.015375519171357155,
    -0.03795306012034416,
    0.025314485654234886,
    -0.04424985125660896,
    -0.10365013033151627,
    0.007409317884594202,
    0.06163361668586731,
    0.004233873449265957,
    -0.016425468027591705,
    -0.07780800014734268,
    0.04425995051860809,
    -0.042066510766744614,
    0.025959284976124763,
    -0.08550650626420975,
    -0.04764947667717934,
    -0.0677066519856453,
    -0.05005042254924774,
    0.008643919602036476,
    -0.14274749159812927,
    -0.08085412532091141,
    0.007153693586587906,
    -0.005789484828710556,
    -0.05202346667647362,
    0.03645097091794014,
    -0.041379284113645554,
    0.00536578893661499,
    0.015362768433988094,
    -0.030752861872315407,
    -0.07520482689142227,
    -0.1003790944814682,
    -0.0884210616350174,
    0.02797550894320011,
    -0.10541357100009918,
    -0.014234665781259537,
    0.0728534534573555,
    0.04838201403617859,
    0.030657300725579262,
    0.01795146055519581,
    -0.006331841927021742,
    -0.011462483555078506,
    -0.013920614495873451,
    -0.04629356041550636,
    -0.02998477779328823,
    0.04239901155233383,
    -0.030447935685515404,
    0.042414892464876175,
    0.13753598928451538,
    -0.052360210567712784,
    -0.01967576891183853,
    -0.08740345388650894,
    -0.11936229467391968,
    0.07922445982694626,
    0.01886131800711155,
    -0.07550211995840073,
    -0.024223508313298225,
    -0.044385265558958054,
    -0.0835564136505127,
    -1.1859314182264447e-32,
    0.0783814787864685,
    -0.03692501783370972,
    -0.015117639675736427,
    -0.052524786442518234,
    -0.037402987480163574,
    -0.0291181281208992,
    -0.055311527103185654,
    0.04365336522459984,
    -0.01874062605202198,
    -0.11744512617588043,
    -0.053821075707674026,
    0.08238264918327332,
    0.04085079953074455,
    -0.02939104475080967,
    -0.020798368379473686,
    0.029240364208817482,
    -0.08501145243644714,
    -0.0249087642878294,
    0.04164182022213936,
    0.05505448207259178,
    0.029338205233216286,
    0.03482816740870476,
    0.07776977866888046,
    0.0603434257209301,
    0.05650104209780693,
    -0.050517406314611435,
    0.051703814417123795,
    0.12697121500968933,
    0.1330210417509079,
    -0.07918387651443481,
    -0.002578719751909375,
    -0.03231183439493179,
    -0.03836739808320999,
    -0.08022220432758331,
    -0.022668495774269104,
    0.08965891599655151,
    -0.020955612882971764,
    0.0029791665729135275,
    -0.09000855684280396,
    -0.0225080493837595,
    0.038615401834249496,
    -0.012106196023523808,
    -0.0819837898015976,
    -0.04779797047376633,
    0.003281934419646859,
    0.047589339315891266,
    0.019531825557351112,
    -0.025890810415148735,
    0.020880380645394325,
    -0.0007751038065180182,
    0.06810896843671799,
    -0.010711741633713245,
    -0.03487269580364227,
    0.012577463872730732,
    0.03243078291416168,
    0.024409251287579536,
    0.09201768785715103,
    -0.052576351910829544,
    -0.056821443140506744,
    -0.04751412570476532,
    0.034521616995334625,
    0.0013803469482809305,
    0.047321490943431854,
    -0.06130058318376541,
    -0.0069856783375144005,
    -0.057113200426101685,
    -0.03041980415582657,
    -0.006854363717138767,
    -0.020763110369443893,
    0.06475319713354111,
    -0.023092549294233322,
    -0.04364060238003731,
    0.03435319662094116,
    -0.03509065881371498,
    -0.019625574350357056,
    0.01519064512103796,
    -0.007310651242733002,
    -0.11102963984012604,
    0.002954813651740551,
    -0.0035935728810727596,
    0.07884792238473892,
    0.09722992777824402,
    0.025037242099642754,
    0.018114101141691208,
    0.06770750135183334,
    0.023183312267065048,
    0.010334162972867489,
    0.0856625959277153,
    0.07076724618673325,
    0.003786676563322544,
    -0.0174358319491148,
    -0.03684500232338905,
    0.032062068581581116,
    0.05362148955464363,
    -0.05402345955371857,
    -6.46633466772073e-08,
    0.03393840044736862,
    0.03275526314973831,
    0.012833824381232262,
    -0.08187184482812881,
    -0.03828331455588341,
    0.011784476228058338,
    0.07387179136276245,
    -0.03735532611608505,
    -0.02071254886686802,
    -0.1203525960445404,
    0.03627990186214447,
    0.07040297985076904,
    -0.029974907636642456,
    0.09891283512115479,
    -0.04503980278968811,
    0.015109528787434101,
    -0.0564936026930809,
    0.009548375383019447,
    0.029628077521920204,
    -0.04029644653201103,
    -0.09708357602357864,
    0.017606446519494057,
    0.0008667184156365693,
    0.01983492262661457,
    0.03804049640893936,
    0.07035037130117416,
    -0.006684494204819202,
    -0.046514466404914856,
    -0.025982799008488655,
    0.03141453117132187,
    0.020574059337377548,
    0.0037468241062015295,
    0.033355288207530975,
    -0.052497997879981995,
    -0.026282740756869316,
    0.03217966482043266,
    -0.07594646513462067,
    -0.05713532119989395,
    0.08331889659166336,
    -0.08972124755382538,
    0.0598791241645813,
    0.005130496341735125,
    0.05662929266691208,
    0.009027641266584396,
    -0.04069754481315613,
    -0.07144666463136673,
    -0.013447114266455173,
    0.02270839735865593,
    0.021229630336165428,
    -0.012374822050333023,
    -0.04181142523884773,
    -0.03491564095020294,
    -0.07659515738487244,
    0.00565158948302269,
    0.05756567791104317,
    0.0539981871843338,
    -0.03330758213996887,
    -0.05057087540626526,
    0.0006443598540499806,
    -0.009896408766508102,
    0.040133316069841385,
    -0.0365075021982193,
    0.06596031039953232,
    -0.024710509926080704
  ]
}