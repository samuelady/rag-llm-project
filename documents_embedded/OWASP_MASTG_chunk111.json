{
  "text": "//Returnsanintentobjectthatyouusetocheckforanupdate. Task<AppUpdateInfo>appUpdateInfo =appUpdateManager.getAppUpdateInfo(); //Checksthattheplatformwillallowthespecifiedtypeofupdate. if(appUpdateInfo.updateAvailability()==UpdateAvailability.UPDATE_AVAILABLE 297\\n//Foraflexibleupdate,useAppUpdateType.FLEXIBLE && appUpdateInfo.isUpdateTypeAllowed(AppUpdateType.IMMEDIATE)){ //...Part2:requestupdate appUpdateManager.startUpdateFlowForResult( //Passtheintentthatisreturnedby'getAppUpdateInfo()'. appUpdateInfo, //Or'AppUpdateType.FLEXIBLE'forflexibleupdates. AppUpdateType.IMMEDIATE, //Thecurrentactivitymakingtheupdaterequest. this, //Includearequestcodetolatermonitorthisupdaterequest. MY_REQUEST_CODE); //...Part3:checkifupdatecompletedsuccessfully @Override public void onActivityResult(intrequestCode,intresultCode,Intentdata){ if(myRequestCode ==MY_REQUEST_CODE){ if(resultCode !=RESULT_OK){ log(\"Updateflowfailed!Resultcode:\" +resultCode); //Iftheupdateiscancelledorfails, //youcanrequesttostarttheupdateagainincaseofforcedupdates } } } //..Part4: //Checksthattheupdateisnotstalledduring'onResume()'. //However,youshouldexecutethischeckatallentrypointsintotheapp. @Override protected void onResume(){ super.onResume(); appUpdateManager .getAppUpdateInfo() .addOnSuccessListener( appUpdateInfo ->{ ... if(appUpdateInfo.updateAvailability() ==UpdateAvailability.DEVELOPER_TRIGGERED_UPDATE_IN_PROGRESS) { //Ifanin-appupdateisalreadyrunning,resumetheupdate. manager.startUpdateFlowForResult( appUpdateInfo, IMMEDIATE, this, MY_REQUEST_CODE); } }); } } Source: https://developer.android.com/guide/app-bundle/in-app-updates Dynamic analysis Inordertotestforproperupdating: trydownloadinganolderversionoftheapplicationwithasecurityvulnerability,either byareleasefromthedevelopersorbyusingathirdpartyapp-store. Next,verifywhetherornotyoucancontinuetouse theapplicationwithoutupdatingit. Ifanupdatepromptisgiven,verifyifyoucanstillusetheapplicationbycancelingthe prompt or otherwise circumventing it through normal application usage. This includes validating whether the backend willstopcallstovulnerablebackendsand/orwhetherthevulnerableapp-versionitselfisblockedbythebackend. Lastly, seeifyoucanplaywiththeversionnumberofaman-in-the-middledappandseehowthebackendrespondstothis(and ifitisrecordedatallforinstance). Checking for Weaknesses in Third Party Libraries Platform: android MASVSV1: MSTG-CODE-5 MASVSV2: MASVS-CODE-3 298\\nOverview Static Analysis Detecting vulnerabilities in third party dependencies can be done by means of the OWASP Dependency checker. This is best done by using a gradle plugin, such as dependency-check-gradle. In order to use the plugin, the following steps need to be applied: Install the plugin from the Maven central repository by adding the following script to your build.gradle: buildscript{ repositories{ mavenCentral() } dependencies{ classpath'org.owasp:dependency-check-gradle:3.2.0' } } applyplugin:'org.owasp.dependencycheck' Oncegradlehasinvokedtheplugin,youcancreateareportbyrunning: gradleassemble gradledependencyCheckAnalyze --info Thereportwillbeinbuild/reportsunlessotherwiseconfigured. Usethereportinordertoanalyzethevulnerabilities found. Seeremediationonwhattodogiventhevulnerabilitiesfoundwiththelibraries. Please be advised that the plugin requires to download a vulnerability feed. Consult the documentation in case issues arisewiththeplugin. Lastly,pleasenotethatforhybridapplications,onewillhavetochecktheJavaScriptdependencieswithRetireJS.Similarly forXamarin,onewillhavetochecktheC#dependencies. Whenalibraryisfoundtocontainvulnerabilities,thenthefollowingreasoningapplies: • Isthelibrarypackagedwiththeapplication? Thencheckwhetherthelibraryhasaversioninwhichthevulnerability ispatched. Ifnot,checkwhetherthevulnerabilityactuallyaffectstheapplication. Ifthatisthecaseormightbethe caseinthefuture,thenlookforanalternativewhichprovidessimilarfunctionality,butwithoutthevulnerabilities. • Isthelibrarynotpackagedwiththeapplication? Seeifthereisapatchedversioninwhichthevulnerabilityisfixed. If thisisnotthecase,checkiftheimplicationsofthevulnerabilityforthebuild-process. Couldthevulnerabilityimpede abuildorweakenthesecurityofthebuild-pipeline? Thentrylookingforanalternativeinwhichthevulnerabilityis fixed. When the sources are not available, one can decompile the app and check the JAR files. When Dexguard or ProGuard areappliedproperly,thenversioninformationaboutthelibraryisoftenobfuscatedandthereforegone. Otherwiseyou canstillfindtheinformationveryofteninthecommentsoftheJavafilesofgivenlibraries. ToolssuchasMobSFcanhelp in analyzing the possible libraries packed with the application. If you can retrieve the version of the library, either via comments,orviaspecificmethodsusedincertainversions,youcanlookthemupforCVEsbyhand. Iftheapplicationisahigh-riskapplication, youwillendupvettingthelibrarymanually. Inthatcase, therearespecific requirements for native code, which you can find in the chapter “Testing Code Quality”. Next to that, it is good to vet whetherallbestpracticesforsoftwareengineeringareapplied. Dynamic Analysis Thedynamicanalysisofthissectioncomprisesvalidatingwhetherthecopyrightsofthelicenseshavebeenadheredto. ThisoftenmeansthattheapplicationshouldhaveanaboutorEULAsectioninwhichthecopyrightstatementsarenoted asrequiredbythelicenseofthethirdpartylibrary. Testing for URL Loading in WebViews 299\\nPlatform: android MASVSV1: MSTG-PLATFORM-2 MASVSV2: MASVS-CODE-4 Overview In order to test for URL loading in WebViews you need to carefully analyze handling page navigation, especially when usersmightbeabletonavigateawayfromatrustedenvironment. ThedefaultandsafestbehavioronAndroidistolet thedefaultwebbrowseropenanylinkthattheusermightclickinsidetheWebView. However,thisdefaultlogiccanbe modifiedbyconfiguringaWebViewClientwhichallowsnavigationrequeststobehandledbytheappitself. Static Analysis Check for Page Navigation Handling Override TotestiftheappisoverridingthedefaultpagenavigationlogicbyconfiguringaWebViewClientyoushouldsearchfor andinspectthefollowinginterceptioncallbackfunctions: • shouldOverrideUrlLoadingallowsyourapplicationtoeitherabortloadingWebViewswithsuspiciouscontentby returningtrueorallowtheWebViewtoloadtheURLbyreturningfalse. Considerations: – ThismethodisnotcalledforPOSTrequests. – ThismethodisnotcalledforXmlHttpRequests,iFrames,“src”attributesincludedinHTMLor<script>tags. Instead,shouldInterceptRequestshouldtakecareofthis. • shouldInterceptRequestallowstheapplicationtoreturnthedatafromresourcerequests. Ifthereturnvalueis null,theWebViewwillcontinuetoloadtheresourceasusual. Otherwise,thedatareturnedbytheshouldInter- ceptRequestmethodisused. Considerations: – This callback is invoked for a variety of URL schemes (e.g., http(s):, data:, file:, etc.), not only those schemeswhichsendrequestsoverthenetwork. – This is not called for javascript: or blob: URLs, or for assets accessed via file:///android_asset/ or file:///android_res/URLs. Inthecaseofredirects,thisisonlycalledfortheinitialresourceURL,notany subsequentredirectURLs. – WhenSafeBrowsingisenabled,theseURLsstillundergoSafeBrowsingchecksbutthedevelopercanallow theURLwithsetSafeBrowsingWhitelistorevenignorethewarningviatheonSafeBrowsingHitcallback. As you can see there are a lot of points to consider when testing the security of WebViews that have a WebViewClient configured,sobesuretocarefullyreadandunderstandallofthembycheckingtheWebViewClientDocumentation. Check for EnableSafeBrowsing Disabled WhilethedefaultvalueofEnableSafeBrowsingistrue,someapplicationsmightopttodisableit. ToverifythatSafeBrows- ingisenabled,inspecttheAndroidManifest.xmlfileandmakesurethattheconfigurationbelowisnotpresent: <manifest> <application> <meta-data android:name=\"android.webkit.WebView.EnableSafeBrowsing\" android:value=\"false\" /> ... </application> </manifest> Dynamic Analysis AconvenientwaytodynamicallytestdeeplinkingistouseFridaorfrida-traceandhooktheshouldOverrideUrlLoading, shouldInterceptRequestmethodswhileusingtheappandclickingonlinkswithintheWebView. Besuretoalsohook otherrelatedUrimethodssuchasgetHost,getSchemeorgetPathwhicharetypicallyusedtoinspecttherequestsand matchknownpatternsordenylists. 300\\nAndroid Anti-Reversing Defenses Overview General Disclaimer Thelackofanyofthesemeasuresdoesnotcauseavulnerability-instead,theyaremeanttoincreasetheapp’s resilienceagainstreverseengineeringandspecificclient-sideattacks. None of these measures can assure a 100% effectiveness, as the reverse engineer will always have full access to the deviceandwillthereforealwayswin(givenenoughtimeandresources)! Forexample,preventingdebuggingisvirtuallyimpossible. Iftheappispubliclyavailable,itcanberunonanuntrusted devicethatisunderfullcontroloftheattacker. Averydeterminedattackerwilleventuallymanagetobypassalltheapp’s anti-debuggingcontrolsbypatchingtheappbinaryorbydynamicallymodifyingtheapp’sbehavioratruntimewithtools suchasFrida. You can learn more about principles and technical risks of reverse engineering and code modification in these OWASP",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 111
  },
  "embedding": [
    -0.010171858593821526,
    -0.030577797442674637,
    0.014838391914963722,
    -0.016333015635609627,
    0.004495470318943262,
    -0.02179189771413803,
    -0.024520963430404663,
    -0.03521590679883957,
    -0.011737225577235222,
    0.06805039197206497,
    -0.024967284873127937,
    -0.04750820994377136,
    -0.06154602766036987,
    -0.048244982957839966,
    0.02275747060775757,
    -0.004944765008985996,
    0.041739173233509064,
    -0.014270895160734653,
    -0.03957202285528183,
    0.05127473175525665,
    -0.013541187159717083,
    -0.009187567047774792,
    0.0370861291885376,
    0.05008788779377937,
    0.05983436480164528,
    -0.005593535955995321,
    -0.052363935858011246,
    -0.05193601921200752,
    -0.0037743975408375263,
    0.03209457919001579,
    -0.02591465227305889,
    0.026984509080648422,
    -0.013805286027491093,
    -0.045619525015354156,
    0.11413782835006714,
    -0.05936136841773987,
    0.027345772832632065,
    0.020848190411925316,
    0.002013268182054162,
    0.01407746784389019,
    -0.047319382429122925,
    0.011239899322390556,
    0.00037475625867955387,
    0.047501590102910995,
    -0.0035491485614329576,
    -0.028366368263959885,
    -0.05074874684214592,
    -0.02089614048600197,
    -0.019528210163116455,
    0.03285760432481766,
    0.06092051416635513,
    -0.008872004225850105,
    -0.04246174544095993,
    0.05451212078332901,
    -0.002121287863701582,
    0.09771184623241425,
    0.013356762938201427,
    0.1246325820684433,
    0.007598253432661295,
    0.08072235435247421,
    0.039801646023988724,
    -0.057922959327697754,
    0.024858001619577408,
    -0.042024869471788406,
    -0.06470141559839249,
    0.04132981598377228,
    0.024481123313307762,
    -0.12164360284805298,
    0.04195242375135422,
    -0.1318345069885254,
    -0.08633214980363846,
    0.0963517501950264,
    -0.001062681432813406,
    -0.06108913570642471,
    -0.050747472792863846,
    -0.01451567467302084,
    0.0971350148320198,
    0.027944305911660194,
    -0.0034340969286859035,
    -0.06250332295894623,
    -0.020913027226924896,
    -0.04657431319355965,
    -0.060654573142528534,
    0.0372723788022995,
    0.06186927482485771,
    -0.03756795451045036,
    0.009928547777235508,
    0.0009017193806357682,
    0.04512324929237366,
    0.0434323213994503,
    -0.00017318558820988983,
    0.03323289379477501,
    0.026236524805426598,
    -0.04258298501372337,
    0.005211554002016783,
    0.04836203530430794,
    -0.11114208400249481,
    0.060589469969272614,
    -0.02900027483701706,
    0.05292224884033203,
    0.027758939191699028,
    -0.04845869913697243,
    -0.06094188615679741,
    -0.03333214670419693,
    0.1100989282131195,
    -0.030850732699036598,
    0.044795870780944824,
    0.02073707804083824,
    0.043486058712005615,
    0.032846931368112564,
    -0.04513457417488098,
    -0.009631757624447346,
    0.07034826278686523,
    -0.02576858177781105,
    -0.049925822764635086,
    -0.0038848849944770336,
    0.03295883163809776,
    0.06814000010490417,
    0.013780511915683746,
    0.04546122997999191,
    0.059720657765865326,
    -0.021733611822128296,
    -0.01883675903081894,
    -0.14189940690994263,
    -0.041510749608278275,
    -0.05177101120352745,
    0.062060341238975525,
    1.285341506107547e-32,
    0.03986836597323418,
    0.04985598102211952,
    0.051161397248506546,
    0.03546970337629318,
    0.02492358721792698,
    -0.03044302947819233,
    0.028785957023501396,
    0.008310734294354916,
    0.08213697373867035,
    -0.09772839397192001,
    -0.017283858731389046,
    0.036096084862947464,
    -0.07154952734708786,
    -0.0909983217716217,
    -0.03547254204750061,
    -0.09183602035045624,
    -0.036344923079013824,
    0.12392786890268326,
    0.07611970603466034,
    0.0420801006257534,
    0.04150049760937691,
    -0.12535740435123444,
    -0.0536319725215435,
    -0.030342571437358856,
    -0.025276727974414825,
    0.0011724407086148858,
    0.031030762940645218,
    0.11522959917783737,
    -0.042698267847299576,
    -0.004576772917062044,
    0.009087953716516495,
    -0.02115173637866974,
    -0.05389954894781113,
    -0.003963930532336235,
    0.0033208169043064117,
    -0.07453478872776031,
    -0.030399896204471588,
    -0.034483954310417175,
    -0.0009077221620827913,
    -0.05472138524055481,
    0.024985939264297485,
    -0.01069706305861473,
    -0.05477987602353096,
    0.0013595160562545061,
    0.007726432289928198,
    -0.09393710643053055,
    -0.04844769462943077,
    -0.012744896113872528,
    0.1090468317270279,
    -0.03555125370621681,
    0.030275054275989532,
    0.017161931842565536,
    -0.03435574471950531,
    -0.109415203332901,
    -0.12812988460063934,
    -0.0031799369025975466,
    -0.030142808333039284,
    -0.027889953926205635,
    0.02366340160369873,
    -0.020983349531888962,
    0.029536094516515732,
    -0.03045685961842537,
    -0.029018459841609,
    -0.06709658354520798,
    0.0034465256612747908,
    0.05594431236386299,
    0.012899467721581459,
    -0.06845267862081528,
    -0.021700387820601463,
    -0.05173823982477188,
    -0.016115743666887283,
    -0.022707698866724968,
    0.07680623233318329,
    0.035342853516340256,
    -0.007227436639368534,
    -0.0028486826922744513,
    0.0140073848888278,
    0.023956622928380966,
    -0.054450154304504395,
    -0.03716234862804413,
    0.05015798285603523,
    -0.028230521827936172,
    -0.05470782145857811,
    0.03716500848531723,
    0.016020184382796288,
    0.036724381148815155,
    0.010688521899282932,
    0.0036544424947351217,
    -0.014463860541582108,
    0.09616847336292267,
    -0.031892940402030945,
    0.010851297527551651,
    -0.026807909831404686,
    -0.03893072530627251,
    0.05560682713985443,
    -1.1187361938400088e-32,
    0.03403662517666817,
    -0.02031232975423336,
    -0.09264058619737625,
    -0.0737023800611496,
    0.038907986134290695,
    -0.05825328081846237,
    -0.011613825336098671,
    0.12277170270681381,
    0.04786532744765282,
    -0.03834336996078491,
    0.04931042715907097,
    -0.0017413925379514694,
    0.007166298571974039,
    -0.031464897096157074,
    -0.060882214456796646,
    0.04741379991173744,
    0.04008911922574043,
    -0.005326310638338327,
    0.021451812237501144,
    0.08711693435907364,
    -0.03288084641098976,
    0.04174928739666939,
    -0.09343724697828293,
    0.012377499602735043,
    -0.008799283765256405,
    0.020431920886039734,
    -0.03033202700316906,
    0.03620655834674835,
    0.013630892150104046,
    -0.03063931129872799,
    -0.0019440277246758342,
    -0.010580764152109623,
    -0.09809397906064987,
    -0.01999208703637123,
    0.005914298817515373,
    -0.038497790694236755,
    0.004654326941817999,
    -0.03416845574975014,
    -0.0716700553894043,
    0.06571199744939804,
    0.07450199127197266,
    -0.07110398262739182,
    -0.008704028092324734,
    0.04665220156311989,
    0.06360998004674911,
    0.020032892003655434,
    0.08223482221364975,
    0.03973176330327988,
    -0.04123019054532051,
    0.06983113288879395,
    0.04981571435928345,
    -0.04794137552380562,
    -0.0613134428858757,
    0.08902037888765335,
    0.08981610089540482,
    0.03774578124284744,
    0.08920211344957352,
    -0.08338941633701324,
    -0.025733014568686485,
    -0.006488502491265535,
    -0.003902047872543335,
    0.004033975303173065,
    0.0014091039774939418,
    -0.04893076419830322,
    0.07971885800361633,
    0.058633994311094284,
    0.026397155597805977,
    -0.01246619876474142,
    0.026237687095999718,
    0.06784028559923172,
    -0.044982340186834335,
    -0.08148995041847229,
    0.059162337332963943,
    -0.015834087505936623,
    0.05266956612467766,
    -0.00522327795624733,
    0.07990536093711853,
    -0.04847675561904907,
    -0.023910798132419586,
    -0.027427541092038155,
    -0.07141953706741333,
    0.05259183794260025,
    -0.027326731011271477,
    -0.0004984817933291197,
    -0.012352347373962402,
    -0.047453708946704865,
    -0.009898214600980282,
    0.011348491534590721,
    -0.04008977860212326,
    -0.01255328394472599,
    -0.06611428409814835,
    -0.03920120373368263,
    -0.035695139318704605,
    0.004799984395503998,
    -0.05310309678316116,
    -6.176117040013196e-08,
    -0.027518166229128838,
    0.034225642681121826,
    -0.045052580535411835,
    -0.009672642685472965,
    0.14287902414798737,
    0.042406000196933746,
    0.0029503514524549246,
    -0.010569947771728039,
    0.03850322961807251,
    -0.14660748839378357,
    -0.11283333599567413,
    0.033955030143260956,
    -0.006525476463139057,
    0.011150811798870564,
    0.05326993390917778,
    -0.027954954653978348,
    -0.05583928897976875,
    -0.03309500962495804,
    -0.00794339831918478,
    -0.01227249950170517,
    -0.058650869876146317,
    -0.050585705786943436,
    0.019958391785621643,
    -0.056594762951135635,
    0.08373613655567169,
    0.00847281888127327,
    0.05067802220582962,
    0.051289863884449005,
    0.020387934520840645,
    0.056265395134687424,
    0.023535702377557755,
    0.024402501061558723,
    0.040273841470479965,
    -0.10118845105171204,
    -0.03976444527506828,
    0.09116406738758087,
    0.03781137987971306,
    0.025546006858348846,
    0.0689609944820404,
    0.02545037865638733,
    0.13347291946411133,
    0.043228793889284134,
    -0.010928906500339508,
    0.038837842643260956,
    0.03096412681043148,
    0.042509064078330994,
    -0.006549265701323748,
    0.011686124838888645,
    -0.019526584073901176,
    -0.04336227849125862,
    -0.09628041088581085,
    -0.02342579886317253,
    0.06436614692211151,
    -0.026227742433547974,
    -0.08780370652675629,
    0.010350769385695457,
    0.017683645710349083,
    -0.07890883088111877,
    0.03819730132818222,
    0.0379691943526268,
    0.11689302325248718,
    0.012741858139634132,
    0.02595052868127823,
    0.031830813735723495
  ]
}