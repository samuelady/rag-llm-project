{
  "text": "yourAPIofchoice. WhentracingcodewiththeStalkerAPI,Fridaleveragesjust-in-timedynamicrecompilation(by usingCapstone): whenathreadisabouttoexecuteitsnextinstructions,Stalkerallocatessomememory,copies the original code over, and interlaces the copy with your custom code for instrumentation. Finally, it executes thecopy(leavingtheoriginalcodeuntouched,andthereforeavoidinganyanti-debuggingchecks). Thisapproach 563\\nincreases instrumentation performance considerably and allows for very high granularity when tracing (e.g. by tracingexclusivelyCALLorRETinstructions). Youcanlearnmorein-depthdetailsintheblogpost“Anatomyofa codetracer”byFrida’screatorOle[#vadla]. SomeexamplesofuseforStalkerare,forexamplewho-does-it-callor diff-calls. • Java: WhenworkingonAndroidyoucanusethisAPItoenumerateloadedclasses,enumerateclassloaders,create andusespecificclassinstances,enumerateliveinstancesofclassesbyscanningtheheap,etc. • ObjC:WhenworkingoniOSyoucanusethisAPItogetamappingofallregisteredclasses,registerorusespecific classorprotocolinstances,enumerateliveinstancesofclassesbyscanningtheheap,etc. Frida also provides a couple of simple tools built on top of the Frida API and available right from your terminal after installingfrida-toolsviapip. Forinstance: • YoucanusetheFridaCLI(frida)forquickscriptprototypingandtry/errorscenarios. • frida-pstoobtainalistofallapps(orprocesses)runningonthedeviceincludingtheirnames,identifiersandPIDs. • frida-ls-devicestolistyourconnecteddevicesrunningFridaserversoragents. • frida-tracetoquicklytracemethodsthatarepartofaniOSapporthatareimplementedinsideanAndroidnative library. Inaddition,you’llalsofindseveralopensourceFrida-basedtools,suchas: • Grapefruit: aRuntimeApplicationInstrumenttoolkigforiOS. • Fridump: amemorydumpingtoolforbothAndroidandiOS. • Objection: aruntimemobilesecurityassessmentframework. • r2frida: aprojectmergingthepowerfulreverseengineeringcapabilitiesofradare2withthedynamicinstrumenta- tiontoolkitofFrida. • jnitrace: atoolfortracingusageoftheAndroidJNIruntimemethodsbyanativelibrary. Wewillbeusingallofthesetoolsthroughouttheguide. Youcanusethesetoolsas-is,tweakthemtoyourneeds,ortakeasexcellentexamplesonhowtousetheAPIs. Having them as an example is very helpful when you write your own hooking scripts or when you build introspection tools to supportyourreverseengineeringworkflow. Frida CodeShare Platform: generic Availableat: https://codeshare.frida.re/ Frida CodeShare is a repository containing a collection of ready-to-run Frida scripts which can enormously help when performingconcretetasksbothonAndroidasoniOSaswellasalsoserveasinspirationtobuildyourownscripts. Two representativeexamplesare: • Universal Android SSL Pinning Bypass with Frida - https://codeshare.frida.re/@pcipolloni/universal-android-ssl- pinning-bypass-with-frida/ • ObjCmethodobserver-https://codeshare.frida.re/@mrmacete/objc-method-observer/ Usingthemisassimpleasincludingthe--codeshare<handler>flagandahandlerwhenusingtheFridaCLI.Forexample, touse“ObjCmethodobserver”,enterthefollowing: frida --codeshare mrmacete/objc-method-observer -fYOUR_BINARY LIEF Platform: generic Availableat: https://github.com/lief-project/LIEF ThepurposeofLIEFistoprovideacrossplatformlibrarytoparse,modifyandabstractELF,PEandMachOformats. With ityoucan,forinstance,injectacertainlibraryasadependencyofanativelibrary,whichanapplicationalreadyloadsby default. -https://lief.quarkslab.com/ 564\\nGhidra Platform: generic Availableat: https://github.com/NationalSecurityAgency/ghidra Ghidraisanopensourcesoftwarereverseengineering(SRE)suiteoftoolsdevelopedbytheUnitedStateofAmerica’s National Security Agency’s (NSA) Research Directorate. Ghidra is a versatile tool which comprises of a disassembler, decompilerandabuilt-inscriptingengineforadvancedusage. Pleaserefertotheinstallationguideonhowtoinstallit andalsolookatthecheatsheetforafirstoverviewofavailablecommandsandshortcuts. Inthissection,wewillhave walk-throughonhowtocreateaproject,viewdisassemblyanddecompiledcodeforabinary. StartGhidrausingghidraRun(*nix)orghidraRun.bat(Windows),dependingontheplatformyouareon. OnceGhidrais firedup,createanewprojectbyspecifyingtheprojectdirectory. Youwillbegreetedbyawindowasshownbelow: In your new Active Project you can import an app binary by going to File -> Import File and choosing the desired file. 565\\nIfthefilecanbeproperlyprocessed,Ghidrawillshowmeta-informationaboutthebinarybeforestartingtheanalysis. To get the disassembled code for the binary file chosen above, double click the imported file from the Active Project 566\\nwindow. Clickyesandanalyzeforauto-analysisonthesubsequentwindows. Auto-analysiswilltakesometimedepend- ingonthesizeofthebinary,theprogresscanbetrackedinthebottomrightcornerofthecodebrowserwindow. Once auto-analysisiscompletedyoucanstartexploringthebinary. The most important windows to explore a binary in Ghidra are the Listing (Disassembly) window, the Symbol Tree windowandtheDecompilerwindow,whichshowsthedecompiledversionofthefunctionselectedfordisassembly. The DisplayFunctionGraphoptionshowscontrolflowgraphoftheselectedfunction. 567\\nTherearemanyotherfunctionalitiesavailableinGhidraandmostofthemcanbeexploredbyopeningtheWindowmenu. Forexample,ifyouwanttoexaminethestringspresentinthebinary,opentheDefinedStringsoption. Wewilldiscuss otheradvancedfunctionalitieswhileanalyzingvariousbinariesforAndroidandiOSplatformsinthecomingchapters. 568\\nRMS Runtime Mobile Security Platform: generic Availableat: https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security RMS-RuntimeMobileSecurityisaruntimemobileapplicationanalysistoolkit,supportingAndroidandiOSApps. Itoffers awebGUIandiswritteninPython. It’sleveragingarunningFridaserveronajailbrokendevicewiththefollowingout-of-boxfunctionalities: • ExecutepopularFridascripts • ExecutecustomFridascripts • Dumpalltheloadedclassesandrelativemethods • Hookmethodsonthefly • (Android)MonitorAndroidAPIsandusageofnativeAPIs Theinstallationinstructionsand“how-toguide”ofRMScanbefoundintheReadmeoftheGithubrepo. iaito Platform: generic Availableat: https://github.com/radareorg/iaito Iaitoistheofficialgraphicaluserinterfaceforradare2,anopen-sourcereverseengineeringframework. Thisuser-friendly toolsimplifiesthereverseengineeringprocessbyprovidingagraphicalinterfacethatintegratesseamlesslywithradare2’s powerfulfeatures. Withafocusonsimplicity,keybindings,andradare2-styleworkflows,Iaitoisavaluableresourcefor bothexperiencedreverseengineersandthosenewtothefield,offeringamoreaccessibleandefficientwaytoworkwith radare2. 569\\nMobSF Platform: generic Availableat: https://github.com/MobSF/Mobile-Security-Framework-MobSF MobSF(MobileSecurityFramework)isanautomated,all-in-onemobileapplicationpentestingframeworkcapableofper- formingstaticanddynamicanalysis. TheeasiestwayofgettingMobSFstartedisviaDocker. dockerpullopensecurity/mobile-security-framework-mobsf dockerrun -it-p8000:8000opensecurity/mobile-security-framework-mobsf:latest Orinstallandstartitlocallyonyourhostcomputerbyrunning: ##Setup gitclonehttps://github.com/MobSF/Mobile-Security-Framework-MobSF.git cdMobile-Security-Framework-MobSF ./setup.sh #ForLinuxandMac setup.bat #ForWindows ##Installationprocess ./run.sh #ForLinuxandMac run.bat #ForWindows OnceyouhaveMobSFupandrunningyoucanopenitinyourbrowserbynavigatingtohttp://127.0.0.1:8000. Simply dragtheAPKyouwanttoanalyzeintotheuploadareaandMobSFwillstartitsjob. objection Platform: generic Availableat: https://github.com/sensepost/objection Objection is a “runtime mobile exploration toolkit, powered by Frida”. Its main goal is to allow security testing on non- rooteddevicesthroughanintuitiveinterface. ObjectionachievesthisgoalbyprovidingyouwiththetoolstoeasilyinjecttheFridagadgetintoanapplicationbyrepack- agingit. Thisway,youcandeploytherepackagedapptothenon-rooted/non-jailbrokendevicebysideloadingit. Objection alsoprovidesaREPLthatallowsyoutointeractwiththeapplication,givingyoutheabilitytoperformanyactionthatthe applicationcanperform. ObjectioncanbeinstalledthroughpipasdescribedonObjection’sWiki. pip3installobjection 570\\nReference applications Theapplicationslistedbelowcanbeusedastrainingmaterials. Note: onlytheMASTGappsandCrackmesaretestedand maintainedbytheMASproject. OVAA Platform: android Availableat: https://github.com/oversecured/ovaa AnAndroidappthataggregatesalltheplatform’sknownandpopularsecurityvulnerabilities. InsecureShop Platform: android Availableat: https://github.com/hax0rgb/InsecureShop/ InsecureShopisanintentionallydesignedAndroidapplicationthatshowcasesvulnerabilities,aimingtoeducatedevelop- ersandsecurityexpertsaboutcommonpitfallswithinmodernAndroidapps. Itservesasadynamicplatformforrefining Androidpentestingskills. The majority of these vulnerabilities can be exploited on non-rooted devices, posing risks from both remote users and malicious third-party applications. Notably, the app doesn’t utilize any APIs. InsecureShop presents an opportunity to explorearangeofvulnerabilities: • HardcodedCredentials: Embeddedlogincredentialswithinthecode. • InsufficientURLValidation: AllowsloadingofarbitraryURLsviaDeeplinks. • ArbitraryCodeExecution: Enablestheexecutionofcodefromthird-partypackages. • AccesstoProtectedComponents: Permitsthird-partyappstolaunchsecurecomponents. • InsecureBroadcastReceiver: RegistrationofabroadcastenablingURLinjection. • InsecureContentProvider: Accessiblecontentproviderputtinguserdataatrisk. Complementingtheselearningexperiences,InsecureShopprovidesdocumentationabouttheimplementedvulnerabilities andtheirassociatedcode. Thisdocumentation,however,refrainsfromofferingcompletesolutionsforeachvulnerability showcasedwithintheInsecureShopapp. AndroGoat Platform: android Availableat: https://github.com/satishpatnayak/AndroGoat Anopensourcevulnerable/insecureapp usingKotlin. This apphas awiderange ofvulnerabilities relatedto certificate pinning, custom URL schemes, Android Network Security Configuration, WebViews, root detection and over 20 other vulnerabilities. Android License Validator Platform: android Availableat: https://mas.owasp.org/crackmes/Android#android-license-validator 571\\nThe Android License Validator is a",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 177
  },
  "embedding": [
    -0.05469565838575363,
    -0.015579595230519772,
    -0.0009898905409500003,
    -0.031081106513738632,
    -0.02882213145494461,
    -0.12188185751438141,
    -0.0258726105093956,
    -0.005998021457344294,
    -0.000685369421262294,
    -0.030957404524087906,
    -0.03570009768009186,
    -0.09619125723838806,
    -0.050004325807094574,
    -0.04793666675686836,
    -0.11553499102592468,
    -0.10878627747297287,
    0.04945311322808266,
    0.07513361424207687,
    -0.06692837178707123,
    -0.025537312030792236,
    0.014383901841938496,
    -0.02195124141871929,
    -0.004531168844550848,
    0.009191310964524746,
    0.048997990787029266,
    0.04706933721899986,
    -0.04879867658019066,
    -0.07471812516450882,
    0.004231001250445843,
    -0.007579216733574867,
    -0.03553423285484314,
    0.03913694992661476,
    -0.033712733536958694,
    0.024687372148036957,
    0.02295473776757717,
    0.08986596763134003,
    -0.011463695205748081,
    -0.00038980445242486894,
    -0.03143944591283798,
    -0.02679707482457161,
    -0.05879967659711838,
    0.06767213344573975,
    -0.0401969812810421,
    0.07974576950073242,
    0.012597031891345978,
    -0.06323522329330444,
    0.010163001716136932,
    -0.05702652037143707,
    -0.0658666118979454,
    -0.011793884448707104,
    -0.048783715814352036,
    0.007250848226249218,
    0.0363137423992157,
    -0.035852499306201935,
    0.03772279620170593,
    0.021797826513648033,
    0.07773939520120621,
    -0.017212314531207085,
    -0.005136634223163128,
    0.03399604558944702,
    -0.010339946486055851,
    0.02573264203965664,
    -0.03797896206378937,
    -0.009401329793035984,
    0.024045024067163467,
    -0.011814776808023453,
    0.12493074685335159,
    0.011429766193032265,
    0.0762382447719574,
    -0.004423860460519791,
    -0.0521300844848156,
    0.06956762075424194,
    0.039030522108078,
    0.06909701228141785,
    0.014414298348128796,
    0.0803370326757431,
    -0.026678450405597687,
    0.04341684654355049,
    0.028795963153243065,
    -0.19689086079597473,
    0.03658974915742874,
    0.0027196311857551336,
    0.051522545516490936,
    0.061378028243780136,
    0.03136681392788887,
    0.005081921815872192,
    -0.0031803231686353683,
    0.04630595073103905,
    0.02824478968977928,
    0.10690078139305115,
    0.09232892841100693,
    0.01010379008948803,
    -0.0917547419667244,
    -0.04675096645951271,
    0.05607825145125389,
    0.0014933663187548518,
    -0.0398591049015522,
    0.026129091158509254,
    0.012023670598864555,
    0.031157810240983963,
    0.033412765711545944,
    0.026608474552631378,
    -0.023106710985302925,
    0.041422173380851746,
    -0.012125998735427856,
    0.005088140722364187,
    0.04044891148805618,
    -0.02153516188263893,
    -0.03360814228653908,
    0.058670055121183395,
    0.0681372657418251,
    0.03128262236714363,
    0.033814795315265656,
    0.016120364889502525,
    0.09844791889190674,
    0.12548471987247467,
    0.009746953845024109,
    0.009488089010119438,
    0.02238209918141365,
    0.06087447702884674,
    -0.009875660762190819,
    -0.04410874843597412,
    -0.0036776247434318066,
    -0.04931672662496567,
    0.01759227178990841,
    0.10689418017864227,
    -0.007227185647934675,
    1.2544564205972484e-32,
    0.016546927392482758,
    -0.02912747487425804,
    -0.02480653114616871,
    -0.03744865581393242,
    -0.11482428759336472,
    -0.046735502779483795,
    -0.0194495040923357,
    0.05842180177569389,
    0.017083875834941864,
    -0.029764803126454353,
    -0.01566893234848976,
    0.018904205411672592,
    -0.02297033928334713,
    -0.035514768213033676,
    0.002980821533128619,
    -0.005248130299150944,
    -0.0331372395157814,
    0.07437079399824142,
    -0.11903855204582214,
    0.05785747617483139,
    0.03417578712105751,
    -0.08803591132164001,
    -0.07443264871835709,
    -0.028830554336309433,
    -0.024775611236691475,
    0.09343821555376053,
    -0.02730504795908928,
    0.034419409930706024,
    0.003677887376397848,
    0.061137452721595764,
    0.006278591230511665,
    -0.05645173415541649,
    -0.0669017881155014,
    0.03124375455081463,
    0.06270922720432281,
    -0.07026439160108566,
    0.025996532291173935,
    -0.017142990604043007,
    -0.02775285392999649,
    -0.032386381179094315,
    -0.07179605215787888,
    0.022807825356721878,
    -0.038971200585365295,
    -0.04665931314229965,
    -0.014792770147323608,
    -0.08495413511991501,
    -0.09670461714267731,
    0.026312997564673424,
    0.042740847915410995,
    0.013489838689565659,
    0.07656098157167435,
    0.055903561413288116,
    0.029710033908486366,
    -0.09105563908815384,
    -0.05880536511540413,
    0.03587058559060097,
    0.09337923675775528,
    -0.018197108060121536,
    0.04705782234668732,
    0.1597769856452942,
    -0.009417301043868065,
    0.06759834289550781,
    -0.022294113412499428,
    0.013072390109300613,
    0.03847959637641907,
    0.03892877325415611,
    -0.10970001667737961,
    -0.03607965260744095,
    -0.013519203290343285,
    -0.004679682198911905,
    -0.09050270169973373,
    0.02089148759841919,
    0.022306034341454506,
    0.030429016798734665,
    0.0793248638510704,
    -0.04823540523648262,
    0.022222958505153656,
    -0.02352810837328434,
    -0.08220318704843521,
    -0.14458726346492767,
    0.029013730585575104,
    0.07481472194194794,
    0.033267777413129807,
    -0.06686683744192123,
    -0.028467396274209023,
    -0.013931991532444954,
    0.0089087700471282,
    -0.060261648148298264,
    -0.07904089987277985,
    0.08227144181728363,
    0.037372052669525146,
    0.011768744327127934,
    -0.01540380623191595,
    -0.06500756740570068,
    -0.03323718532919884,
    -1.2348854682136143e-32,
    0.028567474335432053,
    -0.020210394635796547,
    -0.019137509167194366,
    0.02341339737176895,
    0.002435073023661971,
    0.002603044267743826,
    -0.06740445643663406,
    0.026479270309209824,
    -0.006763471756130457,
    -0.03491688147187233,
    -0.00876628514379263,
    -0.0722539946436882,
    -0.0670272558927536,
    -0.012659687548875809,
    0.03931223973631859,
    -0.05231788381934166,
    -0.009472489356994629,
    -0.05690062791109085,
    0.018961135298013687,
    0.03680556267499924,
    0.09296458214521408,
    0.048735056072473526,
    0.0307119432836771,
    -0.03197736293077469,
    -0.03161555528640747,
    0.0005042995908297598,
    -0.06139100715517998,
    0.03608066216111183,
    0.06745067238807678,
    -0.05294542387127876,
    0.022765347734093666,
    0.058154020458459854,
    -0.06922590732574463,
    -0.033797986805438995,
    0.01945001631975174,
    -0.0015814529033377767,
    0.029745351523160934,
    -0.04519858956336975,
    -0.035529982298612595,
    -0.0017894682241603732,
    0.06129441782832146,
    0.024501821026206017,
    -0.04129587113857269,
    0.010904157534241676,
    0.021022431552410126,
    0.0305373203009367,
    -0.13089683651924133,
    0.01900424249470234,
    0.00960056483745575,
    -0.02779533341526985,
    0.03739031031727791,
    0.018679477274417877,
    -0.010374799370765686,
    0.09512137621641159,
    0.01664753444492817,
    0.09397292137145996,
    0.047850336879491806,
    -0.026462214067578316,
    -0.005567476153373718,
    0.053766340017318726,
    -0.009442673064768314,
    -0.10144399851560593,
    -0.023789484053850174,
    -0.0344184972345829,
    0.09839333593845367,
    0.05766703933477402,
    0.09795054793357849,
    0.013786613941192627,
    -0.008638925850391388,
    0.027240881696343422,
    -0.00791094545274973,
    -0.016631489619612694,
    -0.10730578750371933,
    -0.037946730852127075,
    0.015925133600831032,
    0.04790342599153519,
    -0.0029517735820263624,
    -0.10485517978668213,
    -0.06071223318576813,
    -0.0031736092641949654,
    -0.009386877529323101,
    0.016538318246603012,
    -0.014008363708853722,
    0.034877657890319824,
    0.07753699272871017,
    0.015492413192987442,
    -0.04443041980266571,
    0.03797922283411026,
    -0.02546999417245388,
    0.0014582364819943905,
    0.007094902917742729,
    -0.012104002758860588,
    -0.05026828125119209,
    -0.017761798575520515,
    -0.054731495678424835,
    -6.291452336881775e-08,
    0.010370960459113121,
    -0.034381523728370667,
    -0.011082641780376434,
    0.03272699564695358,
    0.020772410556674004,
    -0.06746527552604675,
    -0.027502937242388725,
    0.05715928226709366,
    0.007402408868074417,
    -0.001448322320356965,
    0.05034118518233299,
    -0.01755991391837597,
    0.006644465960562229,
    -0.012830897234380245,
    0.05492666736245155,
    -0.035955760627985,
    0.010567714460194111,
    -0.03693314269185066,
    -0.08243803679943085,
    -0.022056056186556816,
    -0.028975069522857666,
    -0.02061709761619568,
    -0.06335988640785217,
    -0.006129991263151169,
    -0.055462583899497986,
    -0.03415367379784584,
    0.12736307084560394,
    0.12085916101932526,
    0.02475503645837307,
    -0.06189768388867378,
    -0.014168900437653065,
    0.049111589789390564,
    0.0391603522002697,
    -0.019123252481222153,
    -0.0829964429140091,
    0.05364028736948967,
    0.012326324358582497,
    0.03231353685259819,
    0.06604895740747452,
    0.07783649116754532,
    -0.05347970128059387,
    0.03121306747198105,
    -0.0770254135131836,
    0.0351560041308403,
    0.05248769372701645,
    -0.07873683422803879,
    -0.04637483134865761,
    0.014655913226306438,
    -0.0009085154160857201,
    0.032874636352062225,
    -0.1000552698969841,
    0.0009283299441449344,
    -0.053225841373205185,
    0.030171535909175873,
    -0.029002508148550987,
    0.006048071198165417,
    0.018447909504175186,
    -0.06909511983394623,
    0.02189694158732891,
    0.08523523062467575,
    0.04467270150780678,
    -0.024065818637609482,
    0.017958665266633034,
    -0.031869832426309586
  ]
}