{
  "text": "-UYourApp -m\"*[NSURL**HTTP*]\" ForaquickstartyoucangothroughtheiOSexamples. Installing Frida on iOS ToconnectFridatoaniOSapp,youneedawaytoinjecttheFridaruntimeintothatapp. Thisiseasytodoonajailbroken device: justinstallfrida-serverthroughCydia. Onceithasbeeninstalled,theFridaserverwillautomaticallyrunwith rootprivileges,allowingyoutoeasilyinjectcodeintoanyprocess. StartCydiaandaddFrida’srepositorybynavigatingtoManage->Sources->Edit->Addandenteringhttps://build.fr ida.re. YoushouldthenbeabletofindandinstalltheFridapackage. Using Frida on iOS ConnectyourdeviceviaUSBandmakesurethatFridaworksbyrunningthefrida-pscommandandtheflag‘-U’.This shouldreturnthelistofprocessesrunningonthedevice: $frida-ps -U PID Name --- ---------------- 963 Mail 952 Safari 416 BTServer 422 BlueTool 791 CalendarWidget 451 CloudKeychainPro 239 CommCenter 764 ContactsCoreSpot (...) Frida Bindings Inordertoextendthescriptingexperience,FridaoffersbindingstoprogramminglanguagessuchasPython,C,NodeJS, andSwift. TakingPythonasanexample,thefirstthingtonoteisthatnofurtherinstallationstepsarerequired. StartyourPython scriptwithimport fridaandyou’rereadytogo. SeethefollowingscriptthatsimplyrunsthepreviousJavaScriptsnip- pet: ##frida_python.py importfrida session =frida.get_usb_device().attach('com.android.chrome') source =\"\"\" Java.perform(function(){ varview=Java.use(\"android.view.View\"); varmethods=view.class.getMethods(); for(vari=0;i<methods.length;i++){ console.log(methods[i].toString()); } }); \"\"\" script =session.create_script(source) script.load() session.detach() 545\\nInthiscase,runningthePythonscript(python3 frida_python.py)hasthesameresultasthepreviousexample: itwill printallmethodsoftheandroid.view.Viewclasstotheterminal. However,youmightwanttoworkwiththatdatafrom Python. Using send instead of console.log will send data in JSON format from JavaScript to Python. Please read the commentsintheexamplebelow: ##python3frida_python_send.py importfrida session =frida.get_usb_device().attach('com.android.chrome') ##1.wewanttostoremethodnamesinsidealist android_view_methods =[] source =\"\"\" Java.perform(function(){ varview=Java.use(\"android.view.View\"); varmethods=view.class.getMethods(); for(vari=0;i<methods.length;i++){ send(methods[i].toString()); } }); \"\"\" script =session.create_script(source) ##2.thisisacallbackfunction,onlymethodnamescontaining\"Text\"willbeappendedtothelist defon_message(message,data): if\"Text\" inmessage['payload']: android_view_methods.append(message['payload']) ##3.wetellthescripttorunourcallbackeachtimeamessageisreceived script.on('message',on_message) script.load() ##4.wedosomethingwiththecollecteddata,inthiscasewejustprintit formethod inandroid_view_methods: print(method) session.detach() Thiseffectivelyfiltersthemethodsandprintsonlytheonescontainingthestring“Text”: $python3frida_python_send.py public boolean android.view.View.canResolveTextAlignment() public boolean android.view.View.canResolveTextDirection() public void android.view.View.setTextAlignment(int) public void android.view.View.setTextDirection(int) public void android.view.View.setTooltipText(java.lang.CharSequence) ... Intheend, itisuptoyoutodecidewherewouldyouliketoworkwiththedata. Sometimesitwillbemoreconvenient todoitfromJavaScriptandinothercasesPythonwillbethebestchoice. Ofcourseyoucanalsosendmessagesfrom Python to JavaScript by using script.post. Refer to the Frida docs for more information about sending and receiving messages. security Platform: ios Availableat: https://ss64.com/osx/security.html securityisamacOScommandtoadministerKeychains,keys,certificatesandtheSecurityframework. SwiftShield Platform: ios Availableat: https://github.com/rockbruno/swiftshield SwiftShieldisatoolthatgeneratesirreversible,encryptednamesforyouriOSproject’sobjects(includingyourPodsand Storyboards). Thisraisesthebarforreverseengineersandwillproducelesshelpfuloutputwhenusingreverseengineering toolssuchasclass-dumpandFrida. 546\\nWarning: SwiftShield irreversibly overwrites all your source files. Ideally, you should have it run only on your CI server,andonreleasebuilds. AsampleSwiftprojectisusedtodemonstratetheusageofSwiftShield. • Checkoutsushi2k/SwiftSecurity. • OpentheprojectinXcodeandmakesurethattheprojectisbuildingsuccessfully(Product/BuildorApple-Key+B). • DownloadthelatestreleaseofSwiftShieldandunzipit. • GotothedirectorywhereyoudownloadedSwiftShieldandcopytheswiftshieldexecutableto/usr/local/bin: cpswiftshield/swiftshield/usr/local/bin/ • InyourterminalgointotheSwiftSecuritydirectory(whichyoucheckedoutinstep1)andexecutethecommand swiftshield(whichyoudownloadedinstep3): $cdSwiftSecurity $swiftshield -automatic -project-root .-automatic-project-file SwiftSecurity.xcodeproj -automatic-project-scheme SwiftSecurity SwiftShield3.4.0 Automaticmode Buildingprojecttogathermodulesandcompilerarguments... --IndexingReverseEngineeringToolsChecker.swift -- FounddeclarationofReverseEngineeringToolsChecker (s:13SwiftSecurity30ReverseEngineeringToolsCheckerC) FounddeclarationofamIReverseEngineered (s:13SwiftSecurity30ReverseEngineeringToolsCheckerC20amIReverseEngineeredSbyFZ) FounddeclarationofcheckDYLD (s:13SwiftSecurity30ReverseEngineeringToolsCheckerC9checkDYLD33_D6FE91E9C9AEC4D13973F8ABFC1AC788LLSbyFZ) FounddeclarationofcheckExistenceOfSuspiciousFiles ↪ (s:13SwiftSecurity30ReverseEngineeringToolsCheckerC31checkExistenceOfSuspiciousFiles33_D6FE91E9C9AEC4D13973F8ABFC1AC788LLSbyFZ) ... SwiftShieldisnowdetectingclassandmethodnamesandisreplacingtheiridentifierwithanencryptedvalue. Intheoriginalsourcecodeyoucanseealltheclassandmethodidentifiers: SwiftShieldwasnowreplacingallofthemwithencryptedvaluesthatleavenotracetotheiroriginalnameorintentionof theclass/method: Afterexecutingswiftshieldanewdirectorywillbecreatedcalledswiftshield-output. Inthisdirectoryanotherdirec- toryiscreatedwithatimestampinthefoldername. ThisdirectorycontainsatextfilecalledconversionMap.txt,that mapstheencryptedstringstotheiroriginalvalues. 547\\n$catconversionMap.txt // //SwiftShieldConversionMap //AutomaticmodeforSwiftSecurity,2020-01-0213.51.03 //Deobfuscatecrashlogs (oranytextfile)byrunning: //swiftshield -deobfuscate CRASH_FILE -deobfuscate_map THIS_FILE // ViewController===>hTOUoUmUcEZUqhVHRrjrMUnYqbdqWByU viewDidLoad===>DLaNRaFbfmdTDuJCPFXrGhsWhoQyKLnO sceneDidBecomeActive===>SUANAnWpkyaIWlGUqwXitCoQSYeVilGe AppDelegate===>KftEWsJcctNEmGuvwZGPbusIxEFOVcIb Deny_Debugger===>lKEITOpOvLWCFgSCKZdUtpuqiwlvxSjx Button_Emulator===>akcVscrZFdBBYqYrcmhhyXAevNdXOKeG Thisisneededfordeobfuscatingencryptedcrashlogs. AnotherexampleprojectisavailableinSwiftShield’sGithubrepo,thatcanbeusedtotesttheexecutionofSwiftShield. MachoOView Platform: ios Availableat: https://sourceforge.net/projects/machoview/ MachoOViewisausefulvisualMach-Ofilebrowserthatalsoallowsin-fileeditingofARMbinaries. Usbmuxd Platform: ios Availableat: https://github.com/libimobiledevice/usbmuxd usbmuxdisasocketdaemonthatmonitorsUSBiPhoneconnections. Youcanuseittomapthemobiledevice’slocalhost listeningsocketstoTCPportsonyourhostcomputer. ThisallowsyoutoconvenientlySSHintoyouriOSdevicewithout settingupanactualnetworkconnection. WhenusbmuxddetectsaniPhonerunninginnormalmode,itconnectstothe phoneandbeginsrelayingrequeststhatitreceivesvia/var/run/usbmuxd. Xcode Platform: ios Availableat: https://developer.apple.com/xcode/ide/ XcodeisanIntegratedDevelopmentEnvironment(IDE)formacOSthatcontainsasuiteoftoolsfordevelopingsoftware formacOS,iOS,watchOS,andtvOS.YoucandownloadXcodeforfreefromtheofficialApplewebsite. Xcodewillofferyou differenttoolsandfunctionstointeractwithaniOSdevicethatcanbehelpfulduringapenetrationtest,suchasanalyzing logsorsideloadingofapps. Frida-ios-dump Platform: ios Availableat: https://github.com/AloneMonkey/frida-ios-dump Frida-ios-dump is a Python script that helps you retrieve the decrypted version of an iOS app (IPA) from an iOS device. ItsupportsbothPython2andPython3andrequiresFridarunningonyouriOSdevice(jailbrokenornot). Thistooluses Frida’sMemoryAPItodumpthememoryoftherunningappandrecreateanIPAfile. Becausethecodeisextractedfrom memory,itisautomaticallydecrypted. 548\\ngdb Platform: ios Availableat: https://cydia.radare.org/pool/main/g/gdb/ AtooltoperformruntimeanalysisofiOSapplications-https://cydia.radare.org/pool/main/g/gdb/ radare2 for iOS Platform: ios Availableat: https://github.com/radare/radare2 Radare2 is a complete framework for reverse-engineering and analyzing binaries. The installation instructions can be foundintheGitHubrepository. Tolearnmoreonradare2youmaywanttoreadtheofficialradare2book. Learnmore: • r2wiki • LoadingiOSbinariestoradare2 • GitHubradare2Docs-iOS Frida-cycript Platform: ios Availableat: https://github.com/nowsecure/frida-cycript AforkofCycriptincludingabrandnewruntimecalledMjølnerpoweredbyFrida. Thisenablesfrida-cycripttorunonall theplatformsandarchitecturesmaintainedbyfrida-core-https://github.com/nowsecure/frida-cycript iProxy Platform: ios Availableat: https://github.com/tcurdt/iProxy AtoolusedtoconnectviaSSHtoajailbrokeniPhoneviaUSB-https://github.com/tcurdt/iProxy nm - iOS Platform: ios Availableat: http://www.manpagez.com/man/1/nm/osx-10.12.6.php nm is a tool that displays the name list (symbol table) of the given binary. You can find here more information for for iOS. SSL Kill Switch 2 Platform: ios Availableat: https://github.com/nabla-c0d3/ssl-kill-switch2 Blackbox tool to disable SSL certificate validation - including certificate pinning - within iOS and macOS Apps - https: //github.com/nabla-c0d3/ssl-kill-switch2 549\\nios-deploy Platform: ios Availableat: https://github.com/ios-control/ios-deploy Withios-deployyoucaninstallanddebugiOSappsfromthecommandline,withoutusingXcode. Itcanbeinstalledvia brewonmacOS: brewinstallios-deploy Alternatively: gitclonehttps://github.com/ios-control/ios-deploy.git cdios-deploy/ xcodebuild cdbuild/Release ./ios-deploy ln-s<your-path-to-ios-deploy>/build/Release/ios-deploy/usr/local/bin/ios-deploy Thelastlinecreatesasymboliclinkandmakestheexecutableavailablesystem-wide. Reloadyourshelltomakethenew commandsavailable: zsh: #.~/.zshrc bash: #.~/.bashrc iOSbackup Platform: ios Availableat: https://github.com/avibrazil/iOSbackup iOSbackupisaPython3classthatreadsandextractsfilesfromapassword-encryptediOSbackupcreatedbyiTuneson MacandWindows. MobSF for iOS Platform: ios Availableat: https://github.com/MobSF/Mobile-Security-Framework-MobSF ByrunningMobSFlocallyonamacOShostyou’llbenefitfromaslightlybetterclass-dumpoutput. OnceyouhaveMobSFupandrunningyoucanopenitinyourbrowserbynavigatingtohttp://127.0.0.1:8000. Simply dragtheIPAyouwanttoanalyzeintotheuploadareaandMobSFwillstartitsjob. AfterMobSFisdonewithitsanalysis,youwillreceiveaone-pageoverviewofalltheteststhatwereexecuted. Thepage issplitupintomultiplesectionsgivingsomefirsthintsontheattacksurfaceoftheapplication. 550\\nThefollowingisdisplayed: • Basicinformationabouttheappanditsbinaryfile. • Someoptionsto: – ViewtheInfo.plistfile. – Viewthestringscontainedintheappbinary. – Download a class-dump, if the app",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 173
  },
  "embedding": [
    -0.0189676433801651,
    -0.05608085170388222,
    -0.01334021333605051,
    -0.05878171697258949,
    -0.019181791692972183,
    0.011888098903000355,
    -0.06241786852478981,
    -0.01596711575984955,
    0.007233692333102226,
    0.05210605263710022,
    0.03299880772829056,
    -0.032120537012815475,
    -0.08061924576759338,
    0.03860392048954964,
    0.050697825849056244,
    -0.007123833987861872,
    0.06252846866846085,
    -0.03786042332649231,
    -0.06128469109535217,
    0.0019865522626787424,
    0.008538748137652874,
    -0.054506123065948486,
    0.03793353959918022,
    -0.039953041821718216,
    0.0442536287009716,
    -0.011676286347210407,
    -0.09505566209554672,
    -0.03006153367459774,
    0.04578305780887604,
    0.03911673650145531,
    0.04268520697951317,
    -0.009311242960393429,
    0.002087114378809929,
    0.009706595912575722,
    0.021909186616539955,
    -0.033178187906742096,
    0.02564067579805851,
    -0.014151404611766338,
    -0.05430035665631294,
    -0.04722656309604645,
    -0.0034662445541471243,
    0.03187115490436554,
    -0.01964212954044342,
    0.07982821017503738,
    -0.0041118585504591465,
    -0.01702466979622841,
    -0.09142528474330902,
    0.01596893183887005,
    -0.014063344337046146,
    -0.015420082025229931,
    0.03330700099468231,
    0.0153646320104599,
    0.010459407232701778,
    0.058716077357530594,
    -0.01058060210198164,
    0.06283030658960342,
    -0.051315467804670334,
    0.051832545548677444,
    0.10367195308208466,
    0.11606887727975845,
    0.038646068423986435,
    -0.030534159392118454,
    0.0001751478121150285,
    -0.03914393484592438,
    -0.028719782829284668,
    0.02143906243145466,
    -0.07130347192287445,
    -0.07849607616662979,
    0.04417368769645691,
    -0.003872873727232218,
    -0.08571283519268036,
    0.018037430942058563,
    0.03813451528549194,
    0.053337808698415756,
    0.03907504677772522,
    0.03702400624752045,
    0.05809707194566727,
    -0.0030796073842793703,
    -0.07278948277235031,
    -0.09664703160524368,
    0.032707180827856064,
    0.025132905691862106,
    0.07333876192569733,
    0.06620272994041443,
    0.06485537439584732,
    0.05565482750535011,
    0.00681312195956707,
    0.0011580962454900146,
    0.041327521204948425,
    0.0159287191927433,
    0.025375979021191597,
    0.03560008481144905,
    -0.03192942962050438,
    -0.06065298989415169,
    -0.043029557913541794,
    -0.012990540824830532,
    0.002145267091691494,
    -0.023719599470496178,
    -0.16152235865592957,
    0.03923150897026062,
    0.017983850091695786,
    -0.06345604360103607,
    0.03605109453201294,
    0.0037702172994613647,
    -0.008756790310144424,
    -0.08455664664506912,
    0.010382236912846565,
    -8.013760816538706e-05,
    0.03488485515117645,
    0.005462694447487593,
    -0.05188934504985809,
    -0.0420268289744854,
    0.014851522631943226,
    -0.030378447845578194,
    -0.03953597694635391,
    -0.0040156105533242226,
    -0.0866614356637001,
    0.03043787181377411,
    0.10053784400224686,
    0.002305328380316496,
    -0.011734038591384888,
    0.015246158465743065,
    -0.0321706123650074,
    -0.04583987221121788,
    -0.03062998130917549,
    -0.03784245252609253,
    0.037281669676303864,
    2.2192176950957167e-32,
    -0.0009505685302428901,
    0.0731923058629036,
    -0.01724962331354618,
    -0.05821995064616203,
    0.0339462086558342,
    -0.11377336084842682,
    0.07945199310779572,
    0.05301133915781975,
    0.016889022663235664,
    -0.015470781363546848,
    0.020260903984308243,
    -0.021128347143530846,
    -0.027595961466431618,
    -0.05991314351558685,
    0.01685347408056259,
    -0.07464819401502609,
    -0.02297389879822731,
    0.025445425882935524,
    0.03321992978453636,
    -0.042340680956840515,
    0.010816866531968117,
    -0.07163209468126297,
    0.04550700634717941,
    -0.03939314931631088,
    -0.01916617527604103,
    0.023962372913956642,
    0.01041323784738779,
    0.05133981630206108,
    0.06175840646028519,
    0.04590101167559624,
    0.007570616900920868,
    -0.013828828930854797,
    -0.10867788642644882,
    -0.046284325420856476,
    -0.04826154187321663,
    -0.08560320734977722,
    0.05225171148777008,
    -0.0695502907037735,
    -0.03171171247959137,
    -0.027424132451415062,
    -0.04178173840045929,
    -0.03717399016022682,
    -0.13539940118789673,
    0.006058718077838421,
    -0.00045099775888957083,
    -0.043461404740810394,
    -0.03003651276230812,
    -0.034980081021785736,
    0.10615837574005127,
    0.045221708714962006,
    -0.07860512286424637,
    -0.0655025839805603,
    0.034356825053691864,
    -0.03277324512600899,
    -0.10779290646314621,
    0.04123791679739952,
    -0.04960222169756889,
    -0.07048193365335464,
    0.014950348995625973,
    -0.07312905043363571,
    0.004805320408195257,
    -0.05847103148698807,
    -0.0603463388979435,
    -0.09657789766788483,
    -0.043563686311244965,
    -0.02845943346619606,
    -0.015858467668294907,
    -0.02488069050014019,
    -0.04171097278594971,
    -0.014242380857467651,
    -0.08396577090024948,
    0.0012126921210438013,
    0.040058910846710205,
    0.05100776255130768,
    -0.022613761946558952,
    0.05888545140624046,
    -0.007938118651509285,
    0.05194826424121857,
    -0.05437332019209862,
    -0.03240241855382919,
    0.05245305225253105,
    0.019941121339797974,
    0.017065204679965973,
    0.008990484289824963,
    0.10380306094884872,
    -0.005902902223169804,
    -0.004481451120227575,
    -0.030258456245064735,
    -0.05272107571363449,
    0.09135999530553818,
    -0.003873507957905531,
    0.007514374330639839,
    -0.016056358814239502,
    0.09230628609657288,
    -0.047463059425354004,
    -2.1827075752431457e-32,
    0.0069769700057804585,
    -0.054792068898677826,
    -0.10104047507047653,
    -0.050054147839546204,
    0.021445540711283684,
    0.0015237496700137854,
    -0.07794640958309174,
    0.0524202324450016,
    0.02915043942630291,
    -0.03513438627123833,
    0.09817681461572647,
    0.013998459093272686,
    0.045757438987493515,
    -0.053063489496707916,
    -0.02976320870220661,
    0.016092510893940926,
    -0.03732260689139366,
    -0.009444545954465866,
    -0.02864012122154236,
    0.07646200805902481,
    -0.01572440378367901,
    0.02161240391433239,
    -0.04695885255932808,
    0.006831803359091282,
    -0.012437752448022366,
    0.017991499975323677,
    0.09370245039463043,
    0.07439154386520386,
    0.02685193531215191,
    -0.029497621580958366,
    0.09337179362773895,
    -0.027702953666448593,
    -0.1315804123878479,
    -0.0172419473528862,
    -0.02037810906767845,
    0.030334098264575005,
    -0.04152148216962814,
    0.030588464811444283,
    -0.05760394036769867,
    0.004744724836200476,
    0.15713101625442505,
    0.004654013551771641,
    -0.04441104456782341,
    -0.0033088475465774536,
    0.045901067554950714,
    0.016489339992403984,
    -2.9587970857392065e-05,
    -0.0799662247300148,
    -0.06376415491104126,
    0.024612249806523323,
    0.08323106169700623,
    -0.01472205575555563,
    0.001480525592342019,
    0.005519434344023466,
    -0.009211432188749313,
    0.0922904759645462,
    0.13443352282047272,
    -0.08283785730600357,
    -0.02051997371017933,
    -0.06105202063918114,
    0.03899739310145378,
    -0.06639522314071655,
    0.004949725233018398,
    -0.04944339022040367,
    0.0639277771115303,
    -0.007776066195219755,
    -0.00047755002742633224,
    0.0783587321639061,
    0.052975818514823914,
    0.026075191795825958,
    -0.10705310106277466,
    -0.05383624508976936,
    -0.010873290710151196,
    -0.04659677669405937,
    -0.0039052171632647514,
    -0.004823718685656786,
    0.03173534944653511,
    -0.09336809813976288,
    -0.03824634850025177,
    -0.018189428374171257,
    -0.035405561327934265,
    0.08149274438619614,
    -0.030554581433534622,
    -0.04532676562666893,
    0.06036504730582237,
    -0.06290558725595474,
    0.011058724485337734,
    0.05055530369281769,
    0.013294179923832417,
    0.016049932688474655,
    -0.03959278017282486,
    0.044584356248378754,
    0.011661066673696041,
    0.10656587034463882,
    0.042319606989622116,
    -7.824903747177814e-08,
    -0.016354313120245934,
    -0.012937687337398529,
    -0.02538904920220375,
    -0.006298779975622892,
    0.12434111535549164,
    -0.015335284173488617,
    0.023787138983607292,
    -0.024493513628840446,
    0.02482297085225582,
    -0.05808036029338837,
    -0.037103403359651566,
    0.04431649670004845,
    -0.05641243979334831,
    0.05827001854777336,
    0.008584286086261272,
    -0.048517078161239624,
    -0.04992269352078438,
    0.03526866063475609,
    0.04576211795210838,
    -0.054380230605602264,
    -0.06492149084806442,
    -0.07050926983356476,
    0.013570745475590229,
    -0.05165921151638031,
    0.033658869564533234,
    0.0045333243906497955,
    0.08251611143350601,
    0.021258478984236717,
    -0.029957106336951256,
    0.03262701630592346,
    -0.05791991576552391,
    0.00671130558475852,
    -0.009762933477759361,
    -0.08998299390077591,
    -0.07180826365947723,
    0.10234896093606949,
    -0.035623542964458466,
    -0.09195955097675323,
    -0.007714078761637211,
    -0.09336680173873901,
    0.11642931401729584,
    0.0801084041595459,
    0.04067331552505493,
    0.026984401047229767,
    0.050527166575193405,
    0.05545957759022713,
    -0.005969577003270388,
    0.05304979905486107,
    0.0665929839015007,
    -0.02362550050020218,
    -0.07161448150873184,
    -0.08040915429592133,
    0.004482611082494259,
    -0.007814847864210606,
    0.006316575221717358,
    -0.010975377634167671,
    -0.0257575623691082,
    -0.0863155871629715,
    -0.020402180030941963,
    0.01806558109819889,
    0.09949859976768494,
    0.01716754212975502,
    0.06774973124265671,
    0.013868022710084915
  ]
}