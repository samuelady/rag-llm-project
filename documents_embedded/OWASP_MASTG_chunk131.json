{
  "text": "-W-d-v-m Xcode ItisalsopossibletousetheXcodeIDEtoinstalliOSappsbydoingthefollowingsteps: 1. StartXcode 2. SelectWindow/DevicesandSimulators 3. SelecttheconnectediOSdeviceandclickonthe+signinInstalledApps. Allow Application Installation on a Non-iPad Device SometimesanapplicationcanrequiretobeusedonaniPaddevice. IfyouonlyhaveiPhoneoriPodtouchdevicesthen youcanforcetheapplicationtoaccepttobeinstalledandusedonthesekindsofdevices. Youcandothisbychanging thevalueofthepropertyUIDeviceFamilytothevalue1intheInfo.plistfile. <?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE plist PUBLIC\"-//Apple//DTDPLIST1.0//EN\"\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"> <plist version=\"1.0\"> <dict> <key>UIDeviceFamily</key> <array> <integer>1</integer> </array> </dict> </plist> 372\\nItisimportanttonotethatchangingthisvaluewillbreaktheoriginalsignatureoftheIPAfilesoyouneedtore-signthe IPA,aftertheupdate,inordertoinstallitonadeviceonwhichthesignaturevalidationhasnotbeendisabled. ThisbypassmightnotworkiftheapplicationrequirescapabilitiesthatarespecifictomoderniPadswhileyouriPhoneor iPodisabitolder. PossiblevaluesforthepropertyUIDeviceFamilycanbefoundintheAppleDeveloperdocumentation. Onefundamentalstepwhenanalyzingappsisinformationgathering. Thiscanbedonebyinspectingtheapppackage on your host computer or remotely by accessing the app data on the device. You’ll find more advance techniques in thesubsequentchaptersbut,fornow,wewillfocusonthebasics: gettingalistofallinstalledapps,exploringtheapp packageandaccessingtheappdatadirectoriesonthedeviceitself. Thisshouldgiveyouabitofcontextaboutwhatthe app is all about without even having to reverse engineer it or perform more advanced analysis. We will be answering questionssuchas: • Whichfilesareincludedinthepackage? • WhichFrameworksdoestheappuse? • Whichcapabilitiesdoestheapprequire? • Whichpermissionsdoestheapprequesttotheuserandforwhatreason? • Doestheappallowanyunsecuredconnections? • Doestheappcreateanynewfileswhenbeinginstalled? Get Open Connections Platform: ios lsofcommandwheninvokedwithoption-i,itgivesthelistofopennetworkportsforallactiveprocessesonthedevice. Togetalistofopennetworkportsforaspecificprocess,thelsof-i-a-p<pid>commandcanbeused,where-a(AND) optionisusedforfiltering. BelowafilteredoutputforPID1isshown. iPhone:~root#lsof -i-a-p1 COMMANDPIDUSER FD TYPE DEVICESIZE/OFFNODENAME launchd 1root 27u IPv60x69c2ce210efdc023 0t0 TCP *:ssh (LISTEN) launchd 1root 28u IPv60x69c2ce210efdc023 0t0 TCP *:ssh (LISTEN) launchd 1root 29u IPv40x69c2ce210eeaef53 0t0 TCP *:ssh (LISTEN) launchd 1root 30u IPv40x69c2ce210eeaef53 0t0 TCP *:ssh (LISTEN) launchd 1root 31u IPv40x69c2ce211253b90b 0t0 TCP192.168.1.12:ssh->192.168.1.8:62684 (ESTABLISHED) launchd 1root 42u IPv40x69c2ce211253b90b 0t0 TCP192.168.1.12:ssh->192.168.1.8:62684 (ESTABLISHED) Dumping KeyChain Data Platform: ios DumpingtheKeyChaindatacanbedonewithmultipletools,butnotallofthemwillworkonanyiOSversion. Asismore oftenthecase,trythedifferenttoolsorlookuptheirdocumentationforinformationonthelatestsupportedversions. Objection (Jailbroken / non-Jailbroken) The KeyChain data can easily be viewed using Objection. First, connect objection to the app as described in “Recom- mendedTools-Objection”. Then,usetheios keychain dumpcommandtogetanoverviewofthekeychain: $objection --gadget=\"iGoat-Swift\" explore ...[usb]#ioskeychaindump ... Note:YoumaybeaskedtoauthenticateusingthedevicespasscodeorTouchID Savetheoutputbyadding `--jsonkeychain.json`tothiscommand DumpingtheiOSkeychain... Created Accessible ACL Type Account Service Data ------------------------- ------------------------------ ----- -------- ------------------- -------------------------- ↪ ---------------------------------------------------------------------- 2019-06-0610:53:09+0000 WhenUnlocked None Password keychainValue com.highaltitudehacks.dvia mypassword123 2019-06-0610:53:30+0000 WhenUnlockedThisDeviceOnly None Password SCAPILazyVector com.toyopagroup.picaboo (failedtodecode) 2019-06-0610:53:30+0000 AfterFirstUnlockThisDeviceOnly None Password fideliusDeviceGraph com.toyopagroup.picaboo (failedtodecode) 373\\n2019-06-0610:53:30+0000 AfterFirstUnlockThisDeviceOnly None Password SCDeviceTokenKey2 com.toyopagroup.picaboo ↪ 00001:FKsDMgVISiavdm70v9Fhv5z+pZfBTTN7xkwSwNvVr2IhVBqLsC7QBhsEjKMxrEjh 2019-06-0610:53:30+0000 AfterFirstUnlockThisDeviceOnly None Password SCDeviceTokenValue2 com.toyopagroup.picaboo ↪ CJ8Y8K2oE3rhOFUhnxJxDS1Zp8Z25XzgY2EtFyMbW3U= OWASP.iGoat-Swifton (iPhone:12.0)[usb] #quit Notethatcurrently,thelatestversionsoffrida-serverandobjectiondonotcorrectlydecodeallkeychaindata. Different combinationscanbetriedtoincreasecompatibility. Forexample,thepreviousprintoutwascreatedwithfrida-tools==1. 3.0,frida==12.4.8andobjection==1.5.0. Finally, sincethekeychaindumperisexecutedfromwithintheapplicationcontext, itwillonlyprintoutkeychainitems thatcanbeaccessedbytheapplicationandnottheentirekeychainoftheiOSdevice. Grapefruit (Jailbroken / non-Jailbroken) WithGrapefruitit’spossibletoaccessthekeychaindataoftheappyouhaveselected. InsidetheStoragesection,click onKeychainandyoucanseealistingofthestoredKeychaininformation. Keychain-dumper (Jailbroken) YoucanuseKeychain-dumperdumpthejailbrokendevice’sKeyChaincontents. Onceyouhaveitrunningonyourdevice: iPhone:~root#/tmp/keychain_dumper (...) GenericPassword ---------------- Service:myApp Account:key3 EntitlementGroup:RUD9L355Y.sg.vantagepoint.example Label: (null) GenericField: (null) KeychainData:SmJSWxEs GenericPassword ---------------- 374\\nService:myApp Account:key7 EntitlementGroup:RUD9L355Y.sg.vantagepoint.example Label: (null) GenericField: (null) KeychainData:WOg1DfuH In newer versions of iOS (iOS 11 and up), additional steps are necessary. See the README.md for more details. Note thatthisbinaryissignedwithaself-signedcertificatethathasa“wildcard”entitlement. Theentitlementgrantsaccess toallitemsintheKeychain. Ifyouareparanoidorhaveverysensitiveprivatedataonyourtestdevice,youmaywantto buildthetoolfromsourceandmanuallysigntheappropriateentitlementsintoyourbuild;instructionsfordoingthisare availableintheGitHubrepository. Disassembling Native Code Platform: ios BecauseObjective-CandSwiftarefundamentallydifferent,theprogramminglanguageinwhichtheappiswrittenaffects thepossibilitiesforreverseengineeringit. Forexample,Objective-Callowsmethodinvocationstobechangedatruntime. Thismakeshookingintootherappfunctions(atechniqueheavilyusedbyCycriptandotherreverseengineeringtools) easy. This“methodswizzling”isnotimplementedthesamewayinSwift,andthedifferencemakesthetechniqueharder toexecutewithSwiftthanwithObjective-C. On iOS, all the application code (both Swiftand Objective-C) is compiled to machine code (e.g. ARM). Thus, to analyze iOSapplicationsadisassemblerisneeded. IfyouwanttodisassembleanapplicationfromtheAppStore,removetheFairplayDRMfirst. Section“AcquiringtheApp Binary”inthechapter“iOSBasicSecurityTesting”explainshow. In this section the term “app binary” refers to the Macho-O file in the application bundle which contains the compiled code,andshouldnotbeconfusedwiththeapplicationbundle-theIPAfile. Seesection“ExploringtheAppPackage”in chapter“BasiciOSSecurityTesting”formoredetailsonthecompositionofIPAfiles. Disassembling With IDA Pro IfyouhavealicenseforIDAPro,youcananalyzetheappbinaryusingIDAProaswell. ThefreeversionofIDAunfortunatelydoesnotsupporttheARMprocessortype. Togetstarted,simplyopentheappbinaryinIDAPro. 375\\nUpon opening the file, IDA Pro will perform auto-analysis, which can take a while depending on the size of the binary. Oncetheauto-analysisiscompletedyoucanbrowsethedisassemblyintheIDAView(Disassembly)windowandexplore functionsintheFunctionswindow,bothshowninthescreenshotbelow. A regular IDA Pro license does not include a decompiler by default and requires an additional license for the Hex-Rays decompiler, which is expensive. In contrast, Ghidra comes with a very capable free builtin decompiler, making it a compellingalternativetouseforreverseengineering. IfyouhavearegularIDAProlicenseanddonotwanttobuytheHex-Raysdecompiler,youcanuseGhidra’sdecompiler byinstallingtheGhIDApluginforIDAPro. ThemajorityofthischapterappliestoapplicationswritteninObjective-Corhavingbridgedtypes,whicharetypescom- patible with both Swift and Objective-C. The Swift compatibility of most tools that work well with Objective-C is being improved. 376\\nReviewing Decompiled Objective-C and Swift Code Platform: ios TODO:Don’thavethisyet Reviewing Disassembled Objective-C and Swift Code Platform: ios In this section we will",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 131
  },
  "embedding": [
    0.0027276016771793365,
    -0.09458751976490021,
    0.04105307534337044,
    -0.10611655563116074,
    -0.0039427918381989,
    0.015022920444607735,
    0.025482552126049995,
    -0.024757688865065575,
    -0.05624665319919586,
    0.02093527838587761,
    0.09722533822059631,
    -0.07826963067054749,
    -0.07038796693086624,
    0.011358081363141537,
    0.027588853612542152,
    0.10661590844392776,
    0.05529434606432915,
    -0.013658120296895504,
    0.04941810294985771,
    0.08985760807991028,
    0.039872538298368454,
    0.020371869206428528,
    0.04784076660871506,
    0.0059083858504891396,
    0.03297625854611397,
    0.014547575265169144,
    -0.023638347163796425,
    0.0030748965218663216,
    0.008975893259048462,
    0.09089944511651993,
    -0.003893760498613119,
    0.015121807344257832,
    0.03989316150546074,
    0.03369142860174179,
    0.028705444186925888,
    -0.07319001853466034,
    -0.013307052664458752,
    -0.021741701290011406,
    -0.07978907227516174,
    -0.08577888458967209,
    -0.026993131265044212,
    -0.006253482308238745,
    -0.051759250462055206,
    0.04468650370836258,
    -0.007928364910185337,
    0.00862290058284998,
    -0.03887965530157089,
    0.040402911603450775,
    -0.020799843594431877,
    -0.010517576709389687,
    0.08582128584384918,
    0.020333940163254738,
    0.03945716843008995,
    -0.06038523092865944,
    0.01863294467329979,
    -0.012406731955707073,
    0.06970717757940292,
    0.12549421191215515,
    0.08648883551359177,
    0.0490451417863369,
    0.0606660470366478,
    -0.00830327533185482,
    0.0273515023291111,
    -0.040635716170072556,
    -0.0006360283587127924,
    0.07632105052471161,
    -0.10030132532119751,
    -0.06396721303462982,
    -0.021119941025972366,
    -0.08790138363838196,
    -0.07947038859128952,
    0.04780230298638344,
    0.046765975654125214,
    -0.04734310507774353,
    -0.018732750788331032,
    -0.02392948605120182,
    -0.01668022759258747,
    0.03711700439453125,
    -0.05297368764877319,
    -0.15324008464813232,
    0.03134516254067421,
    0.08622291684150696,
    -0.007270936854183674,
    0.07374243438243866,
    0.04608257859945297,
    0.05022581294178963,
    -0.042053692042827606,
    0.01812199503183365,
    0.02039339393377304,
    0.028683293610811234,
    -0.01882076822221279,
    -0.01487219799309969,
    -0.023962315171957016,
    -0.053533926606178284,
    0.0729779377579689,
    0.008455191738903522,
    -0.0017549063777551055,
    -0.04312146082520485,
    -0.09968564659357071,
    -0.036308761686086655,
    -0.004980176687240601,
    -0.054213620722293854,
    -0.01970967836678028,
    -0.00017229923105333,
    0.01681184209883213,
    -0.07671888172626495,
    -0.02486700750887394,
    -0.12485185265541077,
    -0.007543899584561586,
    0.006743334699422121,
    0.03765923157334328,
    -0.04250563681125641,
    0.002615405945107341,
    0.00040080153848975897,
    -0.0037674380000680685,
    -0.0021049724891781807,
    -0.005828117020428181,
    0.10296982526779175,
    0.07757343351840973,
    -0.0825614184141159,
    -0.04190190136432648,
    -0.017535891383886337,
    -0.018993765115737915,
    -0.10346579551696777,
    -0.027497904375195503,
    -0.029598407447338104,
    0.03033965453505516,
    1.6562518507782268e-32,
    -0.044271841645240784,
    -0.003727327100932598,
    -0.08372661471366882,
    -0.05951135605573654,
    -0.049872830510139465,
    -0.18090759217739105,
    0.07758435606956482,
    0.07541579753160477,
    0.017824377864599228,
    -4.015178274130449e-05,
    0.022861476987600327,
    -0.004622108768671751,
    -0.01335744746029377,
    -0.01893073506653309,
    0.013836637139320374,
    -0.03919080272316933,
    -0.024624235928058624,
    0.027230823412537575,
    0.0016828973311930895,
    -0.029066255316138268,
    0.014149028807878494,
    -0.040489666163921356,
    -0.025290239602327347,
    -0.003633034648373723,
    -0.05194474384188652,
    0.045644279569387436,
    -0.03837483748793602,
    0.0029013906605541706,
    0.09272556006908417,
    0.012725341133773327,
    -0.050029415637254715,
    -0.009366101585328579,
    -0.027382129803299904,
    -0.06658225506544113,
    -0.028554335236549377,
    -0.0007358435541391373,
    0.03182828426361084,
    -0.0015838430263102055,
    0.0343695729970932,
    -0.03662913665175438,
    -0.02824278548359871,
    -0.13047873973846436,
    -0.023559430614113808,
    -0.036016859114170074,
    0.07930014282464981,
    -0.024458564817905426,
    -0.03195616230368614,
    -0.03784799948334694,
    0.04088906571269035,
    -0.012989619746804237,
    -0.020409725606441498,
    -0.09110219776630402,
    0.0028625107370316982,
    -0.06754515320062637,
    -0.05751298740506172,
    -0.10935765504837036,
    -0.12459735572338104,
    0.025733405724167824,
    -0.04179317131638527,
    -0.03315558284521103,
    0.002421436831355095,
    -0.05209111049771309,
    0.029670249670743942,
    -0.022694235667586327,
    -0.037731289863586426,
    0.03187219426035881,
    0.01387988030910492,
    -0.07305116206407547,
    -0.03817065432667732,
    0.0014310419792309403,
    -0.04635145515203476,
    0.04031800106167793,
    -0.013036022894084454,
    -0.05840262025594711,
    -0.032520849257707596,
    0.014004470780491829,
    0.028767088428139687,
    0.058793842792510986,
    -0.02068571373820305,
    0.018436316400766373,
    0.01663774996995926,
    0.02260802499949932,
    -0.01804671250283718,
    0.04785366356372833,
    0.03566144034266472,
    -0.025738036260008812,
    -0.035048533231019974,
    -0.07235639542341232,
    -0.10236005485057831,
    0.11791474372148514,
    -0.00455285981297493,
    0.03461895138025284,
    -0.043065331876277924,
    0.02678806334733963,
    0.012574001215398312,
    -1.6757731385255387e-32,
    0.02964126132428646,
    -0.04565531760454178,
    -0.03505926579236984,
    -0.04278320074081421,
    -0.022528670728206635,
    0.016847927123308182,
    -0.06661177426576614,
    0.05984903872013092,
    -0.002338780788704753,
    -0.02939581498503685,
    0.04609953239560127,
    0.054930612444877625,
    0.02141835168004036,
    -0.060085978358983994,
    -0.01352053601294756,
    0.11567187309265137,
    -0.08738411962985992,
    0.10043580830097198,
    -0.005426566116511822,
    0.09762421250343323,
    0.07232819497585297,
    0.045963265001773834,
    0.055564332753419876,
    0.019308658316731453,
    -0.011183029972016811,
    -0.07186786085367203,
    0.04956630617380142,
    0.04902778938412666,
    0.06535445153713226,
    -0.06202991306781769,
    0.05768923461437225,
    0.04295401647686958,
    -0.10666554421186447,
    -0.043482016772031784,
    0.01640387251973152,
    0.06379834562540054,
    0.01363405678421259,
    0.021128948777914047,
    -0.08138902485370636,
    0.06912633776664734,
    0.06818002462387085,
    -0.04526064917445183,
    0.0002731761778704822,
    -0.05334778130054474,
    0.06447458267211914,
    0.023770252242684364,
    0.05520409345626831,
    0.006075361743569374,
    -0.015276306308805943,
    0.018577929586172104,
    0.0749247744679451,
    0.04367677494883537,
    0.008379040285944939,
    0.009377891197800636,
    -0.04110395908355713,
    0.13259455561637878,
    0.13784873485565186,
    -0.041705720126628876,
    -0.01112582627683878,
    0.031001824885606766,
    0.026294775307178497,
    -0.086451455950737,
    0.017881818115711212,
    -0.016804300248622894,
    0.018382493406534195,
    -0.03873279318213463,
    -0.014438655227422714,
    0.0685647577047348,
    -0.0007592503097839653,
    0.05334960296750069,
    -0.06847553700208664,
    -0.07862076908349991,
    0.049518685787916183,
    -0.08810196071863174,
    -0.024319732561707497,
    0.05568227171897888,
    -0.017481569200754166,
    -0.10244081169366837,
    0.0006986958323977888,
    -0.04487339407205582,
    0.05665160343050957,
    0.09245035797357559,
    0.077125184237957,
    -0.01728961616754532,
    -0.025380583480000496,
    0.015825124457478523,
    0.014589802362024784,
    0.018463000655174255,
    0.00883937906473875,
    0.032427962869405746,
    -0.06701122224330902,
    0.026106316596269608,
    0.11676432192325592,
    0.02214929275214672,
    -0.04315909743309021,
    -7.266163493113709e-08,
    -0.027287155389785767,
    -0.02494684047996998,
    0.03242315724492073,
    -0.09416408091783524,
    0.03655305877327919,
    0.018054191023111343,
    0.015956027433276176,
    0.013321779668331146,
    0.011990172788500786,
    -0.09418876469135284,
    -0.021781738847494125,
    -0.007538502104580402,
    -0.0794292688369751,
    0.10256941616535187,
    0.01178645994514227,
    0.0024658122565597296,
    -0.03389656916260719,
    -0.02587887831032276,
    0.008023791015148163,
    -0.04625161737203598,
    0.0015700464136898518,
    -0.056920718401670456,
    -0.007658596150577068,
    -0.03942018747329712,
    0.01218837033957243,
    -0.06983450800180435,
    0.05909699201583862,
    -0.014161279425024986,
    0.001942731672897935,
    0.05901690945029259,
    -0.020374180749058723,
    0.012389149516820908,
    -0.0009482339955866337,
    0.0032708679791539907,
    -0.0569302961230278,
    0.0761929303407669,
    0.006902581546455622,
    -0.0362740196287632,
    0.030633145943284035,
    -0.08899837732315063,
    0.03922460973262787,
    0.025952152907848358,
    -0.05585331842303276,
    0.0004883884685114026,
    0.03126085549592972,
    -0.006872573401778936,
    0.05909837409853935,
    -0.014611191116273403,
    0.06240103766322136,
    0.03061327338218689,
    -0.032308198511600494,
    0.026419077068567276,
    0.05387026444077492,
    0.0005752620636485517,
    0.05347345396876335,
    0.03182462602853775,
    -0.0069712079130113125,
    -0.0346933975815773,
    0.013843387365341187,
    0.014348677359521389,
    0.05627483129501343,
    0.018508732318878174,
    0.0429966002702713,
    0.02825135365128517
  ]
}