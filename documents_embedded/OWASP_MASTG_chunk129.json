{
  "text": "truncated for betterreadabilityandoverview: $ls -1Payload/iGoat-Swift.app rutger.html mansi.html splash.html about.html LICENSE.txt Sentinel.txt README.txt URLSchemeAttackExerciseVC.nib CutAndPasteExerciseVC.nib RandomKeyGenerationExerciseVC.nib KeychainExerciseVC.nib CoreData.momd archived-expanded-entitlements.xcent SVProgressHUD.bundle Base.lproj Assets.car PkgInfo _CodeSignature AppIcon60x60@3x.png Frameworks embedded.mobileprovision Credentials.plist 362\\nAssets.plist Info.plist iGoat-Swift Themostrelevantitemsare: • Info.plist contains configuration information for the application, such as its bundle ID, version number, and displayname. • _CodeSignature/containsaplistfilewithasignatureoverallfilesinthebundle. • Frameworks/containstheappnativelibrariesas.dylibor.frameworkfiles. • PlugIns/maycontainappextensionsas.appexfiles(notpresentintheexample). • iGoat-Swiftistheappbinarycontainingtheapp’scode. Itsnameisthesameasthebundle’snameminusthe.app extension. • Various resources such as images/icons, *.nib files (storing the user interfaces of iOS app), localized content (<language>.lproj),textfiles,audiofiles,etc. The Info.plist File The information property list or Info.plist (named by convention) is the main source of information for an iOS app. It consists of a structured file containing key-value pairs describing essential configuration information about the app. Actually,allbundledexecutables(appextensions,frameworksandapps)areexpectedtohaveanInfo.plistfile. You canfindallpossiblekeysintheAppleDeveloperDocumentation. ThefilemightbeformattedinXMLorbinary(bplist). YoucanconvertittoXMLformatwithonesimplecommand: • OnmacOSwithplutil,whichisatoolthatcomesnativelywithmacOS10.2andaboveversions(noofficialonline documentationiscurrentlyavailable): plutil -convert xml1Info.plist • OnLinux: aptinstall libplist-utils plistutil -iInfo.plist -oInfo_xml.plist Here’sanon-exhaustivelistofsomeinfoandthecorrespondingkeywordsthatyoucaneasilysearchforintheInfo.plist filebyjustinspectingthefileorbyusinggrep -i <keyword> Info.plist: • ApppermissionsPurposeStrings: UsageDescription(see“iOSPlatformAPIs”) • CustomURLschemes: CFBundleURLTypes(see“iOSPlatformAPIs”) • Exported/importedcustomdocumenttypes: UTExportedTypeDeclarations/UTImportedTypeDeclarations(see “iOSPlatformAPIs”) • AppTransportSecurity(ATS)configuration: NSAppTransportSecurity(see“iOSNetworkCommunication”) Pleaserefertothementionedchapterstolearnmoreabouthowtotesteachofthesepoints. App Binary iOSappbinariesarefatbinaries(theycanbedeployedonalldevices32-and64-bit). IncontrasttoAndroid,whereyou canactuallydecompiletheappbinarytoJavacode,theiOSappbinariescanonlybedisassembled. RefertothechapterTamperingandReverseEngineeringoniOSformoredetails. Native Libraries iOSappscanmaketheircodebasemodularbyusingdifferentelements. IntheMASTGwewillrefertoallofthemasnative libraries,buttheycancomeindifferentforms: • StaticandDynamicLibraries: 363\\n– StaticLibrariescanbeusedandwillbecompiledintheappbinary. – Dynamic Libraries (typically having the .dylib extension) are also used but must be part of a framework bundle. Standalone Dynamic Libraries are not supported on iOS, watchOS, or tvOS, except for the system SwiftlibrariesprovidedbyXcode. • Frameworks(sinceiOS8). AFrameworkisahierarchicaldirectorythatencapsulatesadynamiclibrary,headerfiles, andresources,suchasstoryboards,imagefiles,andlocalizedstrings,intoasinglepackage. • BinaryFrameworks(XCFrameworks): Xcode11supportsdistributingbinarylibrariesusingtheXCFrameworksformat whichisanewwaytobundleupmultiplevariantsofaFramework,e.g.foranyoftheplatformsthatXcodesupports (includingsimulatoranddevices). Theycanalsobundleupstaticlibraries(andtheircorrespondingheaders)and supportbinarydistributionofSwiftandC-basedcode. XCFrameworkscanbedistributedasSwiftPackages. • SwiftPackages: Xcode11addsupportsforSwiftpackages, whicharereusablecomponentsofSwift, Objective-C, Objective-C++,C,orC++codethatdeveloperscanuseintheirprojectsandaredistributedassourcecode. Since Xcode12theycanalsobundleresources,suchasimages,storyboards,andotherfiles. SincePackagelibrariesare staticbydefault. Xcodecompilesthem,andthepackagestheydependon,andthenlinksandcombineseverything intotheapplication. YoucanviewnativelibrariesinGrapefruitbyclickingontheModulesiconintheleftmenubar: 364\\nAndgetamoredetailedviewincludingtheirimports/exports: TheyareavailableintheFrameworksfolderintheIPA,youcanalsoinspectthemfromtheterminal: $ls -1Frameworks/ Realm.framework libswiftCore.dylib libswiftCoreData.dylib libswiftCoreFoundation.dylib orfromthedevicewithobjection(aswellasperSSHofcourse): OWASP.iGoat-Swifton (iPhone:11.1.2)[usb] #ls NSFileType Perms NSFileProtection ... Name ------------ ------- ------------------ ... ---------------------------- Directory 493 None ... Realm.framework Regular 420 None ... libswiftCore.dylib Regular 420 None ... libswiftCoreData.dylib Regular 420 None ... libswiftCoreFoundation.dylib ... Pleasenotethatthismightnotbethecompletelistofnativecodeelementsbeingusedbytheappassomecanbepartof thesourcecode,meaningthatthey’llbecompiledintheappbinaryandthereforecannotbefoundasstandalonelibraries orFrameworksintheFrameworksfolder. FornowthisisallinformationyoucangetabouttheFrameworksunlessyoustartreverseengineeringthem. Refertothe chapterTamperingandReverseEngineeringoniOSformoreinformationabouthowtoreverseengineerFrameworks. Other App Resources ItisnormallyworthtakingalookattherestoftheresourcesandfilesthatyoumayfindintheApplicationBundle(.app) insidetheIPAassometimestheycontainadditionalgoodieslikeencrypteddatabases,certificates,etc. 365\\nAccessing the Device Shell Platform: ios Oneofthemostcommonthingsyoudowhentestinganappisaccessingthedeviceshell. Inthissectionwe’llseehowto accesstheiOSshellbothremotelyfromyourhostcomputerwith/withoutaUSBcableandlocallyfromthedeviceitself. Remote Shell IncontrasttoAndroidwhereyoucaneasilyaccessthedeviceshellusingtheadbtool,oniOSyouonlyhavetheoption to access the remote shell via SSH. This also means that your iOS device must be jailbroken in order to connect to its shellfromyourhostcomputer. Forthissectionweassumethatyou’veproperlyjailbrokenyourdeviceandhaveeither Cydia(seescreenshotbelow)orSileoinstalled. IntherestoftheguidewewillreferencetoCydia,butthesamepackages shouldbeavailableinSileo. 366\\nInordertoenableSSHaccesstoyouriOSdeviceyoucaninstalltheOpenSSHpackage. Onceinstalled,besuretoconnect bothdevicestothesameWi-FinetworkandtakeanoteofthedeviceIPaddress,whichyoucanfindintheSettings-> Wi-Fimenuandtappingonceontheinfoiconofthenetworkyou’reconnectedto. Youcannowaccesstheremotedevice’sshellbyrunningssh root@<device_ip_address>,whichwilllogyouinasthe rootuser: $sshroot@192.168.197.234 root@192.168.197.234'spassword: iPhone:~root# PressControl+Dortypeexittoquit. WhenaccessingyouriOSdeviceviaSSHconsiderthefollowing: • Thedefaultusersarerootandmobile. • Thedefaultpasswordforbothisalpine. Remembertochangethedefaultpasswordforbothusersrootandmobileasanyoneonthesamenetworkcanfind theIPaddressofyourdeviceandconnectviathewell-knowndefaultpassword,whichwillgivethemrootaccessto yourdevice. Ifyouforgetyourpasswordandwanttoresetittothedefaultalpine: 1. Edit the file /private/etc/master.password on your jailbroken iOS device (using an on-device shell as shown below) 367\\n2. Findthelines: root:xxxxxxxxx:0:0::0:0:SystemAdministrator:/var/root:/bin/sh mobile:xxxxxxxxx:501:501::0:0:MobileUser:/var/mobile:/bin/sh 3. Changexxxxxxxxxto/smx7MYTQIi2M(whichisthehashedpasswordalpine) 4. Saveandexit Connect to a Device via SSH over USB Duringarealblackboxtest,areliableWi-Ficonnectionmaynotbeavailable. Inthissituation,youcanuseusbmuxdto connecttoyourdevice’sSSHserverviaUSB. ConnectmacOStoaniOSdevicebyinstallingandstartingiproxy: $brewinstalllibimobiledevice $iproxy222222 waitingforconnection Theabovecommandmapsport22ontheiOSdevicetoport2222onlocalhost. Youcanalsomakeiproxyrunautomatically inthebackgroundifyoudon’twanttorunthebinaryeverytimeyouwanttoSSHoverUSB. Withthefollowingcommandinanewterminalwindow,youcanconnecttothedevice: $ssh -p2222root@localhost root@localhost'spassword: iPhone:~root# SmallnoteonUSBofaniDevice: onaniOSdeviceyoucannotmakedataconnectionsanymoreafter1hourofbeing inalockedstate,unlessyouunlockitagainduetotheUSBRestrictedMode,whichwasintroducedwithiOS11.4.1 On-device Shell App Whileusuallyusinganon-deviceshell(terminalemulator)mightbeverytediouscomparedtoaremoteshell,itcanprove handyfordebuggingincaseof,forexample,networkissuesorchecksomeconfiguration. Forexample,youcaninstall NewTerm2viaCydiaforthispurpose(itsupportsiOS6.0to12.1.2atthetimeofthiswriting). Inaddition,thereareafewjailbreaksthatexplicitlydisableincomingSSHforsecurityreasons. Inthosecases,itisvery convenienttohaveanon-deviceshellapp,whichyoucanusetofirstSSHoutofthedevicewithareverseshell,andthen connectfromyourhostcomputertoit. OpeningareverseshelloverSSHcanbedonebyrunningthecommandssh -R <remote_port>:localhost:22 <user- name>@<host_computer_ip>. Ontheon-deviceshellapprunthefollowingcommandand,whenasked,enterthepasswordofthemstguserofthehost computer: ssh-R2222:localhost:22mstg@192.168.197.235 On your host computer run the following command and, when asked, enter the password of the root user of the iOS device: ssh-p2222root@localhost Extracting Information from the Application Binary 368\\nPlatform: ios You can use radare to get information about the binary, such as the architecture, the list of shared libraries, the list of classesandmethods,stringsandmore. Let’susetheDamnVulnerableiOSAppDVIAv1asanexample. Openitsmainbinarywithradare2: r2DamnVulnerableIOSApp Binary Information Togetinformationaboutthebinary, youcanusetheicommand. Thiscommandwilllistinformationaboutthebinary, suchasthearchitecture,thelistofsharedlibraries,thelistofclassesandmethods,stringsandmore. [0x1000180c8]>i ... size 0x43d5f0 humansz 4.2M mode r-x format mach064 iorw false block 0x100 packet xtr.fatmach0 ... lang objcwithblocks linenum false lsyms false nx false os ios",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 129
  },
  "embedding": [
    -0.015035971067845821,
    -0.002033326542004943,
    0.01448649913072586,
    -0.02746897004544735,
    0.09044530242681503,
    -0.01685313694179058,
    0.03056989423930645,
    0.06345139443874359,
    -0.043311528861522675,
    0.0052640424109995365,
    0.04840635135769844,
    -0.02027387171983719,
    -0.06523766368627548,
    -0.023540852591395378,
    -0.00020222237799316645,
    0.011884357780218124,
    -0.047665126621723175,
    0.008049264550209045,
    -0.05772404745221138,
    0.021419772878289223,
    0.041759125888347626,
    0.057002224028110504,
    0.07899786531925201,
    0.03855882212519646,
    0.01599552296102047,
    -0.002205920871347189,
    -0.0704987570643425,
    -0.012909125536680222,
    0.013014523312449455,
    -0.026656555011868477,
    0.07144083827733994,
    0.02718139998614788,
    0.09576410055160522,
    0.05610527843236923,
    0.1577809453010559,
    0.007101595867425203,
    0.05334499850869179,
    -0.10703259706497192,
    -0.04096745327115059,
    -0.04657911881804466,
    -0.054386164993047714,
    0.05342968925833702,
    -0.0027795610949397087,
    0.13532283902168274,
    -0.03410870209336281,
    0.025051552802324295,
    -0.011874102987349033,
    -0.02878762036561966,
    -0.0005482013802975416,
    -0.00013909602421335876,
    -0.04405854269862175,
    0.04049113392829895,
    -0.01483530830591917,
    0.012774110771715641,
    0.03650937229394913,
    0.00041754319681786,
    -0.07056204229593277,
    0.07415945827960968,
    0.04671534523367882,
    0.08350472897291183,
    0.07299210876226425,
    0.022339211776852608,
    -0.03476011008024216,
    -0.007073863409459591,
    -0.023935530334711075,
    0.011177963577210903,
    -0.003390772268176079,
    -0.053202491253614426,
    -0.03387318179011345,
    -0.04923643171787262,
    0.011158404871821404,
    -0.03919726982712746,
    -0.03991040587425232,
    0.05705317482352257,
    -0.04699677973985672,
    -0.003906299360096455,
    0.0485883504152298,
    0.011925200931727886,
    -0.03196810930967331,
    -0.12136878818273544,
    -0.07985400408506393,
    -0.02414252981543541,
    0.07190396636724472,
    0.13833869993686676,
    0.012616208754479885,
    0.025003230199217796,
    0.02256723679602146,
    -0.05312233790755272,
    0.03754209727048874,
    0.04446566477417946,
    0.0010531045263633132,
    -0.0882817730307579,
    -0.0072654858231544495,
    0.04079386591911316,
    -0.005287382286041975,
    0.043858930468559265,
    0.007820343598723412,
    -0.023596053943037987,
    -0.10583910346031189,
    0.08540598303079605,
    -0.01530229952186346,
    -0.0495472252368927,
    0.04318268969655037,
    0.017690613865852356,
    -0.021714946255087852,
    -0.011007312685251236,
    0.06670178472995758,
    0.006045368500053883,
    -0.0380130372941494,
    0.03384418040513992,
    0.05201270431280136,
    0.029794203117489815,
    -0.04849914833903313,
    0.0271709356456995,
    0.023571064695715904,
    -0.05018315836787224,
    -0.0960962250828743,
    0.03579642251133919,
    0.0700705423951149,
    0.09160394221544266,
    0.020050086081027985,
    0.04325714707374573,
    -0.09222935885190964,
    -0.024615155532956123,
    -0.07729359716176987,
    -0.0151735944673419,
    0.08276771008968353,
    1.882278108606244e-32,
    -0.08007656782865524,
    -0.018834946677088737,
    -0.04979759082198143,
    0.011115905828773975,
    -7.273526716744527e-05,
    -0.06985912472009659,
    0.035188768059015274,
    0.00877182837575674,
    -0.07210222631692886,
    0.025629060342907906,
    -0.009869550354778767,
    -0.01656358502805233,
    -0.08660868555307388,
    0.031006546691060066,
    0.01375732570886612,
    -0.054392002522945404,
    -0.03047832101583481,
    0.03676680102944374,
    -0.004283866845071316,
    0.029130322858691216,
    0.012185698375105858,
    -0.017007987946271896,
    -0.05854029953479767,
    -0.10503806173801422,
    0.011307577602565289,
    0.061727795749902725,
    0.01953347958624363,
    -0.017782703042030334,
    -8.158314449246973e-05,
    0.04273994639515877,
    -0.04168931394815445,
    0.00944426003843546,
    0.01192407589405775,
    -0.026555854827165604,
    -0.031048769131302834,
    -0.07148326188325882,
    0.07702729851007462,
    -0.044652584940195084,
    -0.1118517741560936,
    0.02654813788831234,
    0.02470330335199833,
    0.0056482721120119095,
    -0.11488670110702515,
    -0.010232865810394287,
    0.032303519546985626,
    -0.030067497864365578,
    0.047698333859443665,
    -0.012559100985527039,
    0.011237203143537045,
    0.022010859102010727,
    -0.06422708183526993,
    0.018362147733569145,
    -0.027033206075429916,
    -0.09369195252656937,
    -0.05210617557168007,
    -0.048034559935331345,
    -0.01720103621482849,
    -0.030527468770742416,
    0.02167470008134842,
    -0.06903911381959915,
    -0.05992122367024422,
    -0.03293335437774658,
    0.04566469416022301,
    -0.021571587771177292,
    0.07211504131555557,
    0.01672695204615593,
    -0.027239376679062843,
    -0.06171299144625664,
    0.013367331586778164,
    -0.03330361098051071,
    -0.09500467032194138,
    -0.0725143551826477,
    0.09259939193725586,
    0.048798609524965286,
    -0.0313679464161396,
    -0.09630303829908371,
    0.027404354885220528,
    0.05479995533823967,
    -0.031939759850502014,
    -0.045137859880924225,
    0.008231919258832932,
    0.005431284196674824,
    0.046140700578689575,
    -0.015558522194623947,
    0.019956132397055626,
    -0.002550859237089753,
    0.01989559642970562,
    -0.055748455226421356,
    -0.03747585415840149,
    0.051841218024492264,
    -0.07254105806350708,
    -0.05033787339925766,
    -0.005904395133256912,
    -0.06570324301719666,
    -0.08854666352272034,
    -1.7076294762432043e-32,
    0.05522330477833748,
    -0.05501988157629967,
    -0.022953564301133156,
    -0.0019828362856060266,
    0.02620224468410015,
    -0.0444193035364151,
    -0.02263842336833477,
    0.11030226200819016,
    0.05043991282582283,
    -0.05996396020054817,
    -0.009796244092285633,
    -0.005339751020073891,
    -0.02145683392882347,
    -0.060891248285770416,
    -0.031978361308574677,
    0.06558404862880707,
    -0.033866818994283676,
    -0.05848119035363197,
    0.03973734751343727,
    0.046113789081573486,
    -0.023391665890812874,
    0.04772806167602539,
    0.011669996194541454,
    0.057286422699689865,
    0.0439169704914093,
    0.02557700127363205,
    0.03156733885407448,
    0.06105281412601471,
    0.049979813396930695,
    -0.08609072118997574,
    0.07166638225317001,
    -0.045737896114587784,
    -0.13044290244579315,
    -0.013094536028802395,
    -0.01763354428112507,
    -0.08087677508592606,
    0.020158983767032623,
    0.054489608854055405,
    -0.05141465365886688,
    0.045967984944581985,
    0.06795372813940048,
    -0.004029280971735716,
    -0.02502216212451458,
    -0.008611264638602734,
    0.0273148026317358,
    -0.038562096655368805,
    0.044632766395807266,
    0.01702497899532318,
    0.036245424300432205,
    -0.013765392825007439,
    0.09175297617912292,
    -0.033071547746658325,
    0.00734605360776186,
    0.043901458382606506,
    -0.0006149961845949292,
    0.014759893529117107,
    0.085688017308712,
    -0.029771961271762848,
    -0.030024323612451553,
    -0.04953726381063461,
    0.056381452828645706,
    0.028043583035469055,
    -0.06766408681869507,
    -0.05774686112999916,
    0.07840489596128464,
    -0.04187534376978874,
    -0.07059254497289658,
    -0.01093288417905569,
    -0.02113567292690277,
    0.03185905143618584,
    -0.09640297293663025,
    -0.09378569573163986,
    -0.02634693868458271,
    -0.05988721549510956,
    -0.01584991067647934,
    0.06765394657850266,
    0.04223109781742096,
    -0.06539406627416611,
    0.09358734637498856,
    0.005381796974688768,
    0.011868252418935299,
    0.08309619873762131,
    0.014875438995659351,
    0.027766341343522072,
    0.12347331643104553,
    0.000363137514796108,
    -0.06126846373081207,
    0.09242551028728485,
    0.03152676671743393,
    0.036014676094055176,
    -0.0360676534473896,
    0.00961181428283453,
    0.039301108568906784,
    0.09594054520130157,
    -0.02210146002471447,
    -7.636204912842004e-08,
    -0.006785712204873562,
    0.04222295060753822,
    -0.10043540596961975,
    0.012861238792538643,
    0.09053342789411545,
    -0.01424932200461626,
    -0.025536440312862396,
    0.018553070724010468,
    0.027104174718260765,
    -0.08874385058879852,
    -0.0006241226219572127,
    0.0004222359857521951,
    -0.15117104351520538,
    0.03146544471383095,
    -0.030550092458724976,
    -0.07704560458660126,
    -0.06221412494778633,
    0.04522319510579109,
    -0.04327496141195297,
    -0.020591288805007935,
    -0.02897568978369236,
    -0.02945970743894577,
    -0.04169885441660881,
    -0.07485249638557434,
    -0.015273405238986015,
    0.0387730672955513,
    0.024850569665431976,
    0.07075121998786926,
    0.002872466342523694,
    0.03674847632646561,
    -0.0388360358774662,
    0.03643482178449631,
    0.06520471721887589,
    -0.07060621678829193,
    0.057859476655721664,
    0.04843364655971527,
    0.040981873869895935,
    -0.026501387357711792,
    0.0553731769323349,
    -0.006896266248077154,
    0.08879508823156357,
    0.03772813826799393,
    0.09632176160812378,
    -0.014270228333771229,
    -0.0018075662665069103,
    -0.07434296607971191,
    0.005069912876933813,
    0.004611374344676733,
    0.028827771544456482,
    0.03899966925382614,
    -0.01530368160456419,
    -0.0657188892364502,
    -0.07945322245359421,
    0.049563534557819366,
    0.007814683020114899,
    0.03746023029088974,
    0.0352834053337574,
    -0.03433692827820778,
    -0.04940924048423767,
    0.05102851614356041,
    0.09607841074466705,
    -0.023653941228985786,
    -0.033510975539684296,
    0.025889195501804352
  ]
}