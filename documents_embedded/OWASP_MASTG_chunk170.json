{
  "text": "CLI tool (frida) to work with Frida interactively. It hooks into a process and gives you a command line interfacetoFrida’sAPI. frida -Ucom.android.chrome Withthe-loption,youcanalsousetheFridaCLItoloadscripts,e.g.,toloadmyscript.js: 530\\nfrida -U-lmyscript.jscom.android.chrome FridaalsoprovidesaJavaAPI,whichisespeciallyhelpfulfordealingwithAndroidapps. ItletsyouworkwithJavaclasses andobjectsdirectly. HereisascripttooverwritetheonResumefunctionofanActivityclass: Java.perform(function (){ varActivity =Java.use(\"android.app.Activity\"); Activity.onResume.implementation =function (){ console.log(\"[*]onResume()gotcalled!\"); this.onResume(); }; }); TheabovescriptcallsJava.performtomakesurethatyourcodegetsexecutedinthecontextoftheJavaVM.Itinstantiates awrapperfortheandroid.app.ActivityclassviaJava.useandoverwritestheonResumefunction. ThenewonResume functionimplementationprintsanoticetotheconsoleandcallstheoriginalonResumemethodbyinvokingthis.onResume everytimeanactivityisresumedintheapp. The JADX decompiler (v1.3.3 and above) can generate Frida snippets through its graphical code browser. To use this feature,opentheAPKorDEXwithjadx-gui,browsetothetargetmethod,rightclickthemethodname,andselect“Copy asfridasnippet(f)”. ForexampleusingtheMASTGUnCrackableAppforAndroidLevel1: Theabovestepsplacethefollowingoutputinthepasteboard,whichyoucanthenpasteinaJavaScriptfileandfeedinto frida -U -l. leta=Java.use(\"sg.vantagepoint.a.a\"); a[\"a\"].implementation =function (bArr,bArr2){ console.log('aiscalled' +',' +'bArr:' +bArr +',' +'bArr2:' +bArr2); letret=this.a(bArr,bArr2); console.log('aretvalueis' +ret); return ret; }; The above code hooks the a method within the sg.vantagepoint.a.a class and logs its input parameters and return values. 531\\nFridaalsoletsyousearchforandworkwithinstantiatedobjectsthatareontheheap. Thefollowingscriptsearchesfor instancesofandroid.view.ViewobjectsandcallstheirtoStringmethod. Theresultisprintedtotheconsole: setImmediate(function(){ console.log(\"[*]Startingscript\"); Java.perform(function (){ Java.choose(\"android.view.View\",{ \"onMatch\":function(instance){ console.log(\"[*]Instancefound:\" +instance.toString()); }, \"onComplete\":function(){ console.log(\"[*]Finishedheapsearch\") } }); }); }); Theoutputwouldlooklikethis: [*]Startingscript [*]Instancefound:android.view.View{7ccea78G.ED...........ID0,0-0,0 #7f0c01fcapp:id/action_bar_black_background} [*]Instancefound:android.view.View{2809551V.ED.............0,1731-0,1731 #7f0c01ffapp:id/menu_anchor_stub} [*]Instancefound:android.view.View{be471b6G.ED...........I.0,0-0,0 #7f0c01f5app:id/location_bar_verbose_status_separator} [*]Instancefound:android.view.View{3ae0eb7V.ED.............0,0-1080,63 #102002fandroid:id/statusBarBackground} [*]Finishedheapsearch YoucanalsouseJava’sreflectioncapabilities. Tolistthepublicmethodsoftheandroid.view.Viewclass,youcouldcreate awrapperforthisclassinFridaandcallgetMethodsfromthewrapper’sclassproperty: Java.perform(function (){ varview =Java.use(\"android.view.View\"); varmethods =view.class.getMethods(); for(vari=0;i<methods.length;i++){ console.log(methods[i].toString()); } }); Thiswillprintaverylonglistofmethodstotheterminal: public boolean android.view.View.canResolveLayoutDirection() public boolean android.view.View.canResolveTextAlignment() public boolean android.view.View.canResolveTextDirection() public boolean android.view.View.canScrollHorizontally(int) public boolean android.view.View.canScrollVertically(int) public final void android.view.View.cancelDragAndDrop() public void android.view.View.cancelLongPress() public final void android.view.View.cancelPendingInputEvents() ... Apktool Platform: android Availableat: https://github.com/iBotPeaches/Apktool Apktool is used to unpack Android app packages (APKs). Simply unzipping APKs with the standardunzip utility leaves somefilesunreadable. AndroidManifest.xmlisencodedintobinaryXMLformatwhichisn’treadablewithatexteditor. Also,theappresourcesarestillpackagedintoasinglearchivefile. When run with default command line flags, apktool automatically decodes the Android Manifest file to text-based XML formatandextractsthefileresources(italsodisassemblesthe.DEXfilestosmalicode-afeaturethatwe’llrevisitlater inthisbook). Amongtheunpackedfilesyoucanusuallyfind(afterrunningapktool d base.apk): • AndroidManifest.xml: ThedecodedAndroidManifestfile,whichcanbeopenedandeditedinatexteditor. • apktool.yml: filecontaininginformationabouttheoutputofapktool • original: foldercontainingtheMANIFEST.MFfile,whichcontainsinformationaboutthefilescontainedintheJARfile • res: directorycontainingtheapp’sresources 532\\n• smali: directorycontainingthedisassembledDalvikbytecode. You can also use apktool to repackage decoded resources back to binary APK/JAR. See the section “Exploring the App Package”lateronthischapterandsection“Repackaging”inthechapterTamperingandReverseEngineeringonAndroid formoreinformationandpracticalexamples. Termux Platform: android TermuxisaterminalemulatorforAndroidthatprovidesaLinuxenvironmentthatworksdirectlywithorwithoutrooting andwithnosetuprequired. TheinstallationofadditionalpackagesisatrivialtaskthankstoitsownAPTpackagemanager (whichmakesadifferenceincomparisontootherterminalemulatorapps). Youcansearchforspecificpackagesbyusing thecommandpkgsearch<pkg_name>andinstallpackageswithpkginstall<pkg_name>. YoucaninstallTermuxstraight fromGooglePlay. adb Platform: android adb(AndroidDebugBridge),shippedwiththeAndroidSDK,bridgesthegapbetweenyourlocaldevelopmentenvironment andaconnectedAndroiddevice. You’llusuallyleverageittotestappsontheemulatororaconnecteddeviceviaUSBor Wi-Fi. Usetheadb devicescommandtolisttheconnecteddevicesandexecuteitwiththe-largumenttoretrievemore detailsonthem. $adbdevices -l Listofdevicesattached 090c285c0b97f748deviceusb:1-1product:razormodel:Nexus_7device:flo emulator-5554 deviceproduct:sdk_google_phone_x86model:Android_SDK_built_for_x86device:generic_x86transport_id:1 adb provides other useful commands such as adb shell to start an interactive shell on a target and adb forward to forwardtrafficonaspecifichostporttoadifferentportonaconnectdevice. adbforwardtcp:<hostport>tcp:<deviceport> $adb -semulator-5554shell root@generic_x86:/ #ls acct cache charger config ... You’llcomeacrossdifferentusecasesonhowyoucanuseadbcommandswhentestinglaterinthisbook. Notethatyou mustdefinetheserialnummerofthetargetdevicewiththe-sargument(asshownbythepreviouscodesnippet)incase youhavemultipledevicesconnected. SSLUnpinning Platform: android Availableat: https://github.com/ac-pm/SSLUnpinning_Xposed AnXposedModuletobypassSSLcertificatepinning-https://github.com/ac-pm/SSLUnpinning_Xposed apkx 533\\nPlatform: android Availableat: https://github.com/muellerberndt/apkx apkxisaPythonwrappertopopularfreeDEXconvertersandJavadecompilers. Itautomatestheextraction,conversion, anddecompilationofAPKs. Installitasfollows: gitclonehttps://github.com/muellerberndt/apkx cdapkx sudo ./install.sh Thisshouldcopyapkxto/usr/local/bin. Seesection“DecompilingJavaCode”ofthe“ReverseEngineeringandTam- pering”chapterformoreinformationaboutusage. RootCloak Plus Platform: android Availableat: https://github.com/devadvance/rootcloakplus ACydiaSubstrateModuleusedtocheckforcommonlyknownindicationsofroot-https://github.com/devadvance/rootcl oakplus Angr Platform: android AngrisaPythonframeworkforanalyzingbinaries. Itisusefulforbothstaticanddynamicsymbolic(“concolic”)analysis. Inotherwords: givenabinaryandarequestedstate,Angrwilltrytogettothatstate,usingformalmethods(atechnique used for static code analysis) to find a path, as well as brute forcing. Using angr to get to the requestedstate is often muchfasterthantakingmanualstepsfordebuggingandsearchingthepathtowardstherequiredstate. Angroperates ontheVEXintermediatelanguageandcomeswithaloaderforELF/ARMbinaries,soitisperfectfordealingwithnative code,suchasnativeAndroidbinaries. Angrallowsfordisassembly,programinstrumentation,symbolicexecution,control-flowanalysis,data-dependencyanal- ysis,decompilationandmore,givenalargesetofplugins. Since version 8, Angr is based on Python 3, and can be installed with pip on *nix operating systems, macOS and Win- dows: pipinstallangr Someofangr’sdependenciescontainforkedversionsofthePythonmodulesZ3andPyVEX,whichwouldoverwrite theoriginalversions. Ifyou’reusingthosemodulesforanythingelse,youshouldcreateadedicatedvirtualenviron- mentwithVirtualenv. Alternatively,youcanalwaysusetheprovideddockercontainer. Seetheinstallationguide formoredetails. Comprehensive documentation, including an installation guide, tutorials, and usage examples are available on Angr’s Gitbookspage. AcompleteAPIreferenceisalsoavailable. YoucanuseangrfromaPythonREPL-suchasiPython-orscriptyourapproaches. Althoughangrhasabitofasteep learningcurve,wedorecommendusingitwhenyouwanttobruteforceyourwaytoagivenstateofanexecutable. Please seethe “SymbolicExecution” sectionof the “ReverseEngineering and Tampering”chapter as a greatexampleon how thiscanwork. Magisk 534\\nPlatform: android Magisk (“Magic Mask”) is one way to root your Android device. It’s specialty lies in the way the modifications on the systemareperformed. Whileotherrootingtoolsaltertheactualdataonthesystempartition,Magiskdoesnot(whichis called“systemless”). Thisenablesa waytohidethemodificationsfromroot-sensitiveapplications (e.g.forbankingor games)andallowsusingtheofficialAndroidOTAupgradeswithouttheneedtounrootthedevicebeforehand. YoucangetfamiliarwithMagiskreadingtheofficialdocumentationonGitHub. Ifyoudon’thaveMagiskinstalled,youcan findinstallationinstructionsinthedocumentation. IfyouuseanofficialAndroidversionandplantoupgradeit,Magisk providesatutorialonGitHub. LearnmoreaboutrootingyourdevicewithMagisk. FlowDroid Platform: android Availableat: https://github.com/secure-software-engineering/FlowDroid FlowDroid is an open-source tool based",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 170
  },
  "embedding": [
    -0.08599060028791428,
    -0.06355945765972137,
    -0.0009374195360578597,
    -0.02035430632531643,
    0.038688939064741135,
    0.041223492473363876,
    -0.015492511913180351,
    0.1022326797246933,
    0.0009928499348461628,
    -0.054908622056245804,
    -0.023726683109998703,
    -0.030423451215028763,
    -0.0003521746548358351,
    -0.00932593084871769,
    0.047774240374565125,
    -0.04076477885246277,
    0.08744128048419952,
    -0.011730367317795753,
    -0.05453237518668175,
    0.0014663953334093094,
    0.1277460753917694,
    -0.07166434824466705,
    0.0284550990909338,
    -0.08599965274333954,
    -0.012278726324439049,
    -0.029043514281511307,
    -0.0195907112210989,
    -0.1292257308959961,
    0.03863256797194481,
    0.025177806615829468,
    0.06938537210226059,
    -0.0019783983007073402,
    0.016463927924633026,
    -0.013730349019169807,
    -0.07390829175710678,
    -0.007030553184449673,
    -0.03566141426563263,
    -0.10802777856588364,
    -0.019938474521040916,
    0.023513760417699814,
    -0.05876791849732399,
    0.06401440501213074,
    -0.053135551512241364,
    -0.001432188437320292,
    -0.007628346793353558,
    -0.14536216855049133,
    -0.06902265548706055,
    0.023742102086544037,
    -0.03783649578690529,
    0.05196266621351242,
    0.03559765964746475,
    -0.031042244285345078,
    0.020921558141708374,
    -0.014582030475139618,
    -0.12412849813699722,
    0.06901376694440842,
    -0.09456416219472885,
    -0.08204632997512817,
    0.0582507848739624,
    0.075234554708004,
    -0.009861249476671219,
    -0.039199862629175186,
    0.06150900945067406,
    0.045441724359989166,
    -0.05485944449901581,
    0.08245433866977692,
    -0.019977722316980362,
    -0.05111726000905037,
    -0.021763285622000694,
    0.010778358206152916,
    -0.018734661862254143,
    0.009263801388442516,
    0.00898525770753622,
    0.03429889306426048,
    0.03018883243203163,
    -0.08415253460407257,
    0.016329767182469368,
    0.09721322357654572,
    -0.06426461040973663,
    -0.07192220538854599,
    -0.029360832646489143,
    -0.10251236706972122,
    -0.019640127196907997,
    0.05274386331439018,
    0.08176995068788528,
    0.029360979795455933,
    0.06663595139980316,
    0.05458759889006615,
    0.06658942252397537,
    0.08680344372987747,
    -0.04288209602236748,
    0.04172288253903389,
    -0.09012678265571594,
    -0.036652762442827225,
    -0.10510820895433426,
    0.023274388164281845,
    -0.0380355603992939,
    0.022832008078694344,
    -0.08392105996608734,
    0.05179905891418457,
    0.03547298163175583,
    0.007119795307517052,
    0.004876174498349428,
    -0.1120673418045044,
    -0.09766852855682373,
    0.016778912395238876,
    -0.013873961754143238,
    0.004901268985122442,
    -0.008183090016245842,
    -0.012193681672215462,
    -0.015834471210837364,
    -0.06098747253417969,
    0.033617570996284485,
    -0.0360620878636837,
    -0.0238964781165123,
    0.053304579108953476,
    0.030371256172657013,
    -0.04504556953907013,
    0.1815086305141449,
    0.004728467203676701,
    0.12402597069740295,
    0.030866974964737892,
    -0.08176881074905396,
    -0.01498922798782587,
    0.09989511966705322,
    -0.009666568599641323,
    0.004348700400441885,
    7.311693880917649e-33,
    0.04867618530988693,
    -0.04606905207037926,
    -0.021745590493083,
    -0.02250535972416401,
    -0.02605108544230461,
    -0.03771691396832466,
    0.10645989328622818,
    0.06204448267817497,
    -0.047049831598997116,
    -0.03856077417731285,
    0.0616646483540535,
    0.09947225451469421,
    0.014482355676591396,
    -0.017387621104717255,
    -0.0027112504467368126,
    0.001054474152624607,
    0.030283167958259583,
    0.0073015098460018635,
    0.06159401312470436,
    -0.04161600023508072,
    0.045465998351573944,
    -0.05281111225485802,
    0.04587719962000847,
    0.0039497260004282,
    0.032798271626234055,
    0.06946443766355515,
    -0.016328537836670876,
    0.061554353684186935,
    0.022217849269509315,
    0.05260300636291504,
    -0.004200002644211054,
    -0.02396877110004425,
    -0.15341611206531525,
    0.0019429376116022468,
    -0.0014046085998415947,
    -0.007031059358268976,
    -0.08350679278373718,
    -0.005013035610318184,
    0.010134994983673096,
    0.0020950569305568933,
    0.04515612870454788,
    -0.03788461163640022,
    -0.10277554392814636,
    0.01940731704235077,
    -0.0477115698158741,
    -0.0820753276348114,
    -0.058344993740320206,
    0.04020696133375168,
    0.04147789254784584,
    -0.018846843391656876,
    -0.046037353575229645,
    0.03587297350168228,
    0.03706939518451691,
    -0.025882625952363014,
    -0.026473185047507286,
    -0.011285079643130302,
    -0.0851198136806488,
    -0.02076973207294941,
    -0.042739126831293106,
    -0.044528376311063766,
    0.07463130354881287,
    0.007435645908117294,
    -0.037096209824085236,
    0.023772642016410828,
    -0.031078021973371506,
    -0.01212999876588583,
    -0.004933758173137903,
    -0.006209713406860828,
    -0.07623904198408127,
    -0.04335472360253334,
    -0.01599905826151371,
    -0.00990552268922329,
    0.08055576682090759,
    0.06294196099042892,
    0.031013375148177147,
    -0.017051048576831818,
    -0.021394552662968636,
    -0.07227975875139236,
    -0.044127531349658966,
    0.02507266215980053,
    0.09511629492044449,
    -0.04459856450557709,
    0.008714034222066402,
    -0.02520955726504326,
    0.06555578857660294,
    0.031064564362168312,
    0.04529896005988121,
    -0.05102799832820892,
    -0.05490205064415932,
    0.027516324073076248,
    -0.015966759994626045,
    0.005014465656131506,
    0.01336478441953659,
    -0.019158603623509407,
    -0.012250497005879879,
    -9.48800559139797e-33,
    0.0058950032107532024,
    0.0022645131684839725,
    -0.062337253242731094,
    0.008581288158893585,
    0.02010193280875683,
    0.004984625615179539,
    -0.07774979621171951,
    0.08973070234060287,
    0.05374986678361893,
    -0.006077094469219446,
    -0.008452645502984524,
    -0.0021623733919113874,
    -0.011715168133378029,
    -0.040047526359558105,
    0.033288341015577316,
    0.06517421454191208,
    0.004877963103353977,
    0.007742369081825018,
    -0.0712159126996994,
    -0.033650483936071396,
    -0.013570440001785755,
    0.01015556138008833,
    0.07895759493112564,
    0.08627461642026901,
    0.029473159462213516,
    -0.02877218835055828,
    0.007826238870620728,
    0.035351864993572235,
    -0.04879283532500267,
    0.0014730191323906183,
    0.016607176512479782,
    0.027312953025102615,
    -0.04343104735016823,
    -0.00605281675234437,
    0.02220451459288597,
    0.02143934927880764,
    -0.01620749570429325,
    0.008217457681894302,
    0.04177611321210861,
    0.05342261120676994,
    0.06946326047182083,
    -0.10106643289327621,
    0.04344070330262184,
    0.04031343385577202,
    0.01653192564845085,
    0.027740802615880966,
    -0.09526247531175613,
    -0.021281737834215164,
    -0.024809449911117554,
    0.0017959376564249396,
    0.007430308032780886,
    -0.02687174268066883,
    -0.033720992505550385,
    -0.029574517160654068,
    0.051686372607946396,
    0.04478390887379646,
    0.027286536991596222,
    -0.08016310632228851,
    -0.053275175392627716,
    -0.027684761211276054,
    0.027447223663330078,
    -0.10263387113809586,
    -0.009381970390677452,
    -0.060421187430620193,
    0.049850258976221085,
    -0.015316645614802837,
    0.020911768078804016,
    0.03470874950289726,
    0.007826682180166245,
    0.035472165793180466,
    -0.03772344812750816,
    -0.07734308391809464,
    -0.018234271556138992,
    0.01362962182611227,
    0.009713387116789818,
    0.0400090254843235,
    0.06390153616666794,
    -0.12310625612735748,
    -0.04288984835147858,
    -0.009766923263669014,
    0.060722142457962036,
    0.03438090160489082,
    -0.011671542190015316,
    -0.1181066706776619,
    0.07739699631929398,
    -0.016030283644795418,
    -0.08775240182876587,
    0.044026605784893036,
    0.01738807186484337,
    -0.013298598118126392,
    -0.04303675517439842,
    0.02050250768661499,
    0.017730124294757843,
    0.0021936562843620777,
    0.004014612641185522,
    -6.201829449992147e-08,
    0.017421279102563858,
    -0.005341855343431234,
    -0.01750946044921875,
    -0.022466221824288368,
    0.020565252751111984,
    -0.05424114316701889,
    -0.024768052622675896,
    -0.024899084120988846,
    -0.016912542283535004,
    -0.11611398309469223,
    -0.05348588153719902,
    0.0246152151376009,
    0.07468042522668839,
    0.07678752392530441,
    0.025676166638731956,
    0.01629890315234661,
    0.046388305723667145,
    0.07187540829181671,
    0.010990187525749207,
    0.009116584435105324,
    -0.004419012926518917,
    -0.03800646960735321,
    0.0645003691315651,
    0.06070515513420105,
    0.07438961416482925,
    0.0032185709569603205,
    0.006803142838180065,
    0.03170381486415863,
    0.0030913245864212513,
    0.03845018148422241,
    -0.038390349596738815,
    -0.03841659799218178,
    0.05232468619942665,
    -0.03940129652619362,
    -0.023114699870347977,
    0.05222854018211365,
    0.05984093248844147,
    -0.06564640253782272,
    -0.016975698992609978,
    -0.013942371122539043,
    0.09856671839952469,
    0.10314305126667023,
    -0.047352951020002365,
    0.02946668304502964,
    0.029675645753741264,
    -0.02635031007230282,
    0.015261276625096798,
    -0.014606267213821411,
    0.02631932497024536,
    0.007920080795884132,
    -0.11906008422374725,
    -0.008347579278051853,
    -0.05294516682624817,
    0.03330465033650398,
    -0.04837999492883682,
    -0.022382449358701706,
    -0.03915739431977272,
    -0.08032553642988205,
    -5.7380344514967874e-05,
    0.021914968267083168,
    0.04077856242656708,
    0.10036949068307877,
    0.06006002798676491,
    0.01326326560229063
  ]
}