{
  "text": "coulddoany(orall) ofthefollowing: accesslocalfiles, triggerHTTPrequeststoar- bitraryhostsandports, launchacross-siterequestforgery(CSRF)attack, andcauseadenial-of-servicecondition. The OWASPwebtestingguidecontainsthefollowingexampleforXXE: <?xml version=\"1.0\" encoding=\"ISO-8859-1\"?> <!DOCTYPE foo[ <!ELEMENT fooANY> <!ENTITY xxeSYSTEM \"file:///dev/random\" >]><foo>&xxe;</foo> Inthisexample,thelocalfile/dev/randomisopenedwhereanendlessstreamofbytesisreturned,potentiallycausinga denial-of-service. The current trend in app development focuses mostly on REST/JSON-based services as XML is becoming less common. However,intherarecaseswhereuser-suppliedorotherwiseuntrustedcontentisusedtoconstructXMLqueries,itcould be interpreted by local XML parsers, such as NSXMLParser on iOS. As such, said input should always be validated and meta-charactersshouldbeescaped. Injection Attack Vectors Theattacksurfaceofmobileappsisquitedifferentfromtypicalwebandnetworkapplications. Mobileappsdon’toften exposeservicesonthenetwork,andviableattackvectorsonanapp’suserinterfacearerare. Injectionattacksagainstan apparemostlikelytooccurthroughinter-processcommunication(IPC)interfaces,whereamaliciousappattacksanother apprunningonthedevice. Locatingapotentialvulnerabilitybeginsbyeither: • Identifying possible entry points for untrusted input then tracing from those locations to see if the destination containspotentiallyvulnerablefunctions. • Identifying known, dangerous library / API calls (e.g. SQL queries) and then checking whether unchecked input successfullyinterfaceswithrespectivequeries. Duringamanualsecurityreview,youshouldemployacombinationofbothtechniques. Ingeneral,untrustedinputsenter mobileappsthroughthefollowingchannels: • IPCcalls • CustomURLschemes • QRcodes • InputfilesreceivedviaBluetooth,NFC,orothermeans • Pasteboards • Userinterface Verifythatthefollowingbestpracticeshavebeenfollowed: • Untrustedinputsaretype-checkedand/orvalidatedusingalistofacceptablevalues. • Preparedstatementswithvariablebinding(i.e.parameterizedqueries)areusedwhenperformingdatabasequeries. Ifpreparedstatementsaredefined,user-supplieddataandSQLcodeareautomaticallyseparated. • WhenparsingXMLdata,ensuretheparserapplicationisconfiguredtorejectresolutionofexternalentitiesinorder topreventXXEattack. • When working with x509 formatted certificate data, ensure that secure parsers are used. For instance Bouncy Castlebelowversion1.6allowsforRemoteCodeExecutionbymeansofunsafereflection. WewillcoverdetailsrelatedtoinputsourcesandpotentiallyvulnerableAPIsforeachmobileOSintheOS-specifictesting guides. 78\\nCross-Site Scripting Flaws Cross-site scripting (XSS) issues allow attackers to inject client-side scripts into web pages viewed by users. This type ofvulnerabilityisprevalentinwebapplications. Whenauserviewstheinjectedscriptinabrowser, theattackergains theabilitytobypassthesameoriginpolicy,enablingawidevarietyofexploits(e.g.stealingsessioncookies,loggingkey presses,performingarbitraryactions,etc.). Inthecontextofnativeapps,XSSrisksarefarlessprevalentforthesimplereasonthesekindsofapplicationsdonotrely onawebbrowser. However,appsusingWebViewcomponents,suchasWKWebVieworthedeprecatedUIWebViewoniOS andWebViewonAndroid,arepotentiallyvulnerabletosuchattacks. Anolderbutwell-knownexampleisthelocalXSSissueintheSkypeappforiOS,firstidentifiedby PhilPurviance. The Skypeappfailedtoproperlyencodethenameofthemessagesender,allowinganattackertoinjectmaliciousJavaScript tobeexecutedwhenauserviewsthemessage. Inhisproof-of-concept,Philshowedhowtoexploittheissueandsteala user’saddressbook. Static Analysis - Security Testing Considerations TakeacloselookatanyWebViewspresentandinvestigateforuntrustedinputrenderedbytheapp. XSSissuesmayexistiftheURLopenedbyWebViewispartiallydeterminedbyuserinput. Thefollowingexampleisfrom anXSSissueintheZohoWebService,reportedbyLinusSärud. Java webView.loadUrl(\"javascript:initialize(\" +myNumber +\");\"); Kotlin webView.loadUrl(\"javascript:initialize($myNumber);\") AnotherexampleofXSSissuesdeterminedbyuserinputispublicoverriddenmethods. Java @Override public boolean shouldOverrideUrlLoading(WebViewview,Stringurl){ if(url.substring(0,6).equalsIgnoreCase(\"yourscheme:\")){ //parsetheURLobjectandexecutefunctions } } Kotlin funshouldOverrideUrlLoading(view:WebView,url:String):Boolean { if(url.substring(0,6).equals(\"yourscheme:\",ignoreCase =true)){ //parsetheURLobjectandexecutefunctions } } SergeyBobrovwasabletotakeadvantageofthisinthefollowingHackerOnereport. AnyinputtotheHTMLparameter wouldbetrustedinQuora’sActionBarContentActivity. Payloadsweresuccessfulusingadb,clipboarddataviaModalCon- tentActivity,andIntentsfrom3rdpartyapplications. • ADB $adb shell $am start -ncom.quora.android/com.quora.android.ActionBarContentActivity \\ -eurl 'http://test/test' -ehtml 'XSS<script>alert(123)</script>' • ClipboardData 79\\n$am start -ncom.quora.android/com.quora.android.ModalContentActivity \\ -eurl 'http://test/test' -ehtml \\ '<script>alert(QuoraAndroid.getClipboardData());</script>' • 3rdpartyIntentinJavaorKotlin: Intenti =newIntent(); i.setComponent(newComponentName(\"com.quora.android\", \"com.quora.android.ActionBarContentActivity\")); i.putExtra(\"url\",\"http://test/test\"); i.putExtra(\"html\",\"XSSPoC <script>alert(123)</script>\"); view.getContext().startActivity(i); vali=Intent() i.component =ComponentName(\"com.quora.android\", \"com.quora.android.ActionBarContentActivity\") i.putExtra(\"url\",\"http://test/test\") i.putExtra(\"html\",\"XSSPoC <script>alert(123)</script>\") view.context.startActivity(i) IfaWebViewisusedtodisplayaremotewebsite,theburdenofescapingHTMLshiftstotheserverside. IfanXSSflaw exists on the web server, this can be used to execute script in the context of the WebView. As such, it is important to performstaticanalysisofthewebapplicationsourcecode. Verifythatthefollowingbestpracticeshavebeenfollowed: • NountrusteddataisrenderedinHTML,JavaScriptorotherinterpretedcontextsunlessitisabsolutelynecessary. • Appropriateencodingisappliedtoescapecharacters,suchasHTMLentityencoding. Note: escapingrulesbecome complicatedwhenHTMLisnestedwithinothercode,forexample,renderingaURLlocatedinsideaJavaScriptblock. Considerhowdatawillberenderedinaresponse. Forexample,ifdataisrenderedinaHTMLcontext,sixcontrolcharacters thatmustbeescaped: Character Escaped & &amp; < &lt; > &gt; ” &quot; ’ &#x27; / &#x2F; For a comprehensive list of escaping rules and other prevention measures, refer to the OWASP XSS Prevention Cheat Sheet. Dynamic Analysis - Security Testing Considerations XSS issues can be best detected using manual and/or automated input fuzzing, i.e. injecting HTML tags and special characters into all available input fields to verify the web application denies invalid inputs or escapes the HTML meta- charactersinitsoutput. AreflectedXSSattackreferstoanexploitwheremaliciouscodeisinjectedviaamaliciouslink. Totestfortheseattacks, automatedinputfuzzingisconsideredtobeaneffectivemethod. Forexample,theBURPScannerishighlyeffectivein identifyingreflectedXSSvulnerabilities. Asalwayswithautomatedanalysis,ensureallinputvectorsarecoveredwitha manualreviewoftestingparameters. Memory Corruption Bugs Memorycorruptionbugsareapopularmainstaywithhackers. Thisclassofbugresultsfromaprogrammingerrorthat causes the program to access an unintended memory location. Under the right conditions, attackers can capitalize on thisbehaviortohijacktheexecutionflowofthevulnerableprogramandexecutearbitrarycode. Thiskindofvulnerability occursinanumberofways: 80\\n• Bufferoverflows: Thisdescribesaprogrammingerrorwhereanappwritesbeyondanallocatedmemoryrangefor aparticularoperation. Anattackercanusethisflawtooverwriteimportantcontroldatalocatedinadjacentmemory, suchasfunctionpointers. Bufferoverflowswereformerlythemostcommontypeofmemorycorruptionflaw,but havebecomelessprevalentovertheyearsduetoanumberoffactors. Notably,awarenessamongdevelopersof therisksinusingunsafeClibraryfunctionsisnowacommonbestpracticeplus,catchingbufferoverflowbugsis relativelysimple. However,itisstillworthtestingforsuchdefects. • Out-of-bounds-access: Buggypointerarithmeticmaycauseapointerorindextoreferenceapositionbeyondthe boundsoftheintendedmemorystructure(e.g.bufferorlist). Whenanappattemptstowritetoanout-of-bounds address, a crash or unintended behavior occurs. If the attackercan control the targetoffset and manipulate the contentwrittentosomeextent,codeexecutionexploitislikelypossible. • Dangling pointers: These occur when an object with an incoming reference to a memory location is deleted ordeallocated, buttheobjectpointerisnotreset. Iftheprogramlaterusesthedanglingpointertocallavirtual functionofthealreadydeallocatedobject,itispossibletohijackexecutionbyoverwritingtheoriginalvtablepointer. Alternatively,itispossibletoreadorwriteobjectvariablesorothermemorystructuresreferencedbyadangling pointer. • Use-after-free: Thisreferstoaspecialcaseofdanglingpointersreferencingreleased(deallocated)memory. After amemoryaddressiscleared,allpointersreferencingthelocationbecomeinvalid,causingthememorymanagerto returntheaddresstoapoolofavailablememory. Whenthismemorylocationiseventuallyre-allocated,accessing theoriginalpointerwillreadorwritethedatacontainedinthenewlyallocatedmemory. Thisusuallyleadstodata corruptionandundefinedbehavior,butcraftyattackerscansetuptheappropriatememorylocationstoleverage controloftheinstructionpointer. • Integeroverflows: Whentheresultofanarithmeticoperationexceedsthemaximumvaluefortheintegertype defined by the programmer, this results in the value “wrapping around” the",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 52
  },
  "embedding": [
    -0.08336074650287628,
    0.02757635898888111,
    -0.051274944096803665,
    -0.022184617817401886,
    0.011067204177379608,
    -0.07918433845043182,
    0.04606028273701668,
    -0.04191805422306061,
    0.011581345461308956,
    0.006075906101614237,
    0.07347986102104187,
    -0.022908100858330727,
    0.09052807837724686,
    0.010150504298508167,
    0.08900295943021774,
    0.0035639493726193905,
    0.08744219690561295,
    -0.03824283555150032,
    -0.05717092007398605,
    0.11838963627815247,
    0.0661700963973999,
    0.09234866499900818,
    -0.018418002873659134,
    -0.02552289515733719,
    -0.045959021896123886,
    -0.02300579473376274,
    -0.05922413989901543,
    -0.0680900365114212,
    -0.03208465129137039,
    -0.006744477432221174,
    0.002464397344738245,
    0.06755167990922928,
    -0.05173040181398392,
    -0.004049305804073811,
    0.10850518196821213,
    -0.028456205502152443,
    0.11235997825860977,
    -0.08811268955469131,
    -0.0026813026051968336,
    0.02540239691734314,
    -0.054925352334976196,
    0.02412421442568302,
    -0.02720075659453869,
    0.051352616399526596,
    -0.09016586095094681,
    -0.08285117149353027,
    -0.003965175710618496,
    -0.06837186217308044,
    -0.08194396644830704,
    0.0601000152528286,
    -0.02156124636530876,
    -0.014178394339978695,
    0.04285931587219238,
    0.00881840568035841,
    -0.00024308671709150076,
    -0.07669118046760559,
    -0.051649365574121475,
    0.05328715965151787,
    -0.0259713064879179,
    0.08464044332504272,
    -0.022410620003938675,
    -0.060392845422029495,
    0.0019099953351542354,
    0.018568705767393112,
    -0.027280300855636597,
    0.0016175626078620553,
    -0.005266271065920591,
    -0.02795957215130329,
    0.0590679757297039,
    -0.08899285644292831,
    -0.07000823318958282,
    0.017746901139616966,
    -0.04137055575847626,
    0.058741603046655655,
    0.06231807544827461,
    0.07381880283355713,
    0.0552823506295681,
    -0.04626190662384033,
    0.017799723893404007,
    -0.18268492817878723,
    0.02074235863983631,
    0.03412293270230293,
    0.02799656242132187,
    0.02906290628015995,
    -0.00935184583067894,
    0.06680701673030853,
    0.04548834264278412,
    -0.03415445610880852,
    0.07141384482383728,
    0.06863455474376678,
    -0.007686325814574957,
    -0.05877913907170296,
    0.019821256399154663,
    0.01190667413175106,
    0.10156404227018356,
    0.03171640262007713,
    0.054661449044942856,
    -0.055838629603385925,
    -0.04634835943579674,
    0.07847253978252411,
    0.0745551660656929,
    -0.032122232019901276,
    0.019229043275117874,
    -0.013217482715845108,
    0.012909827753901482,
    -0.05974961072206497,
    -0.01651490107178688,
    0.0335407555103302,
    -0.024814261123538017,
    0.001490466995164752,
    -0.018818844109773636,
    -0.006742694415152073,
    -0.011239857412874699,
    -0.0888085886836052,
    -0.01667766273021698,
    -0.02164744958281517,
    0.06988754868507385,
    -0.006735419854521751,
    0.02076007053256035,
    -0.0015270436415448785,
    0.005702590104192495,
    0.0012835272355005145,
    -0.03208371251821518,
    -0.05036276951432228,
    0.05434839054942131,
    0.005261620506644249,
    0.0150096220895648,
    1.2867851601071507e-32,
    0.030314378440380096,
    0.02393445186316967,
    -0.04647751525044441,
    0.014168759807944298,
    0.04202583059668541,
    -0.06722943484783173,
    0.06985624879598618,
    0.09147148579359055,
    0.04136420413851738,
    -0.0782480239868164,
    -0.02351914532482624,
    0.025522220879793167,
    -0.002145220059901476,
    -0.040951795876026154,
    0.05197069048881531,
    -0.026692908257246017,
    -0.06410066783428192,
    0.049474943429231644,
    0.008160898461937904,
    0.022277016192674637,
    0.003222948405891657,
    -0.03669646009802818,
    -0.006053032819181681,
    -0.03839598968625069,
    -0.07873469591140747,
    0.013818827457726002,
    -0.029993997886776924,
    0.0033309664577245712,
    0.0065363310277462006,
    0.04291710630059242,
    -0.004451926331967115,
    -0.026388080790638924,
    -0.06313037127256393,
    0.02538510225713253,
    0.03618660941720009,
    0.00735463947057724,
    0.06827639043331146,
    -0.0801922008395195,
    -0.04061480239033699,
    -0.08643922954797745,
    -0.09205520153045654,
    0.025127271190285683,
    -0.049714069813489914,
    -0.012103695422410965,
    -0.017928417772054672,
    -0.100995734333992,
    -0.08357446640729904,
    -0.035655610263347626,
    0.00953288096934557,
    -0.04041437432169914,
    -0.013423549942672253,
    0.07061070203781128,
    0.12595024704933167,
    -0.04745475947856903,
    -0.0339728482067585,
    -0.0325181782245636,
    -0.013354063034057617,
    -0.007241825107485056,
    0.0056049637496471405,
    0.03364484757184982,
    -0.019084634259343147,
    -0.027709294110536575,
    0.012500112876296043,
    -0.0052507114596664906,
    -0.004314945079386234,
    -0.020540595054626465,
    -0.012120517902076244,
    -0.08807557821273804,
    -0.0172776710242033,
    -0.05721983686089516,
    0.0011085813166573644,
    0.011216620914638042,
    0.048395272344350815,
    0.059900250285863876,
    -0.0197362769395113,
    -0.05571197345852852,
    0.03004356473684311,
    0.05314774438738823,
    0.03173569217324257,
    -0.01204544398933649,
    0.054028403013944626,
    -0.002795733977109194,
    -0.010476339608430862,
    0.01047759409993887,
    -0.05311992019414902,
    0.04104015231132507,
    0.01865214854478836,
    -0.11927297711372375,
    -0.012130011804401875,
    0.0029948290903121233,
    0.06922199577093124,
    -0.012012702412903309,
    -0.004543227609246969,
    -0.007526157423853874,
    0.03120977245271206,
    -1.2348751826380446e-32,
    0.0016045289812609553,
    -0.089616559445858,
    -0.04933525249361992,
    -0.031438879668712616,
    0.00582785764709115,
    -0.06299448758363724,
    -0.05553947016596794,
    0.04833267256617546,
    -0.0016068477416411042,
    -0.046071428805589676,
    0.016790293157100677,
    0.03255593031644821,
    0.01586097478866577,
    -0.04483233019709587,
    -0.04514646530151367,
    -0.009076278656721115,
    0.030444923788309097,
    -0.06531528383493423,
    -0.009961041621863842,
    0.08627182990312576,
    0.01977476477622986,
    0.025936735793948174,
    0.02449548989534378,
    0.0007411154801957309,
    0.04121675342321396,
    -0.005742110777646303,
    -0.04607139527797699,
    0.017248883843421936,
    -0.036116357892751694,
    -0.016793930903077126,
    0.031117768958210945,
    0.041896574199199677,
    -0.023090604692697525,
    -0.04317597672343254,
    -0.03136404976248741,
    -0.07644760608673096,
    -0.013417528010904789,
    0.03224469721317291,
    0.002435555448755622,
    -0.027790894731879234,
    0.01730550266802311,
    -0.023641565814614296,
    0.027744127437472343,
    0.041091594845056534,
    0.01857212744653225,
    -0.00631612166762352,
    -0.03330592066049576,
    -0.02503761276602745,
    0.08099771291017532,
    0.04133330658078194,
    0.017699923366308212,
    0.018338246271014214,
    -0.012952122837305069,
    0.053826648741960526,
    0.02341109700500965,
    0.06285493820905685,
    -0.004177586175501347,
    -0.07296939939260483,
    -0.09751182794570923,
    0.022183718159794807,
    0.0705467090010643,
    0.04242329299449921,
    -0.046886786818504333,
    0.042390257120132446,
    0.10891664773225784,
    -0.0030879927799105644,
    -0.0914849266409874,
    -0.06870219856500626,
    -0.01261430699378252,
    -0.026098433881998062,
    0.011750752106308937,
    -0.07298135757446289,
    -0.06886978447437286,
    -0.040088050067424774,
    0.030398253351449966,
    -0.04699082672595978,
    0.07058835029602051,
    -0.09979551285505295,
    -0.08562420308589935,
    0.03150833398103714,
    -0.05306407809257507,
    0.014865029603242874,
    -0.06354611366987228,
    0.07385507971048355,
    0.055026400834321976,
    -0.066700778901577,
    -0.013809418305754662,
    0.020990388467907906,
    -0.03266650438308716,
    0.02129090577363968,
    -0.04614289104938507,
    -0.00399555591866374,
    -0.08841388672590256,
    0.08926854282617569,
    0.008373246528208256,
    -6.59106973444068e-08,
    -0.06910686194896698,
    -0.020096680149435997,
    -0.06000193953514099,
    -0.01813792623579502,
    0.004133055917918682,
    0.1074935644865036,
    -0.03826342523097992,
    -0.0186091810464859,
    0.014576368033885956,
    -0.04179725795984268,
    0.08879069238901138,
    0.04593988507986069,
    -0.07554110884666443,
    -0.04231993108987808,
    -0.0006997414748184383,
    -0.03742848336696625,
    0.010033363476395607,
    -0.0012320830719545484,
    -0.061755772680044174,
    -0.004248322453349829,
    -0.012434592470526695,
    0.006150009110569954,
    -0.01202886551618576,
    -0.015078387223184109,
    0.015135991387069225,
    0.08065705001354218,
    0.09854259341955185,
    0.05449702963232994,
    0.044907793402671814,
    -0.0035210885107517242,
    -0.08511358499526978,
    -0.021823668852448463,
    -0.01647239737212658,
    -0.03747120499610901,
    -0.11081945151090622,
    0.14330248534679413,
    0.027289079502224922,
    -0.00396591005846858,
    -0.01055330689996481,
    0.019426042214035988,
    0.0678480863571167,
    0.021753309294581413,
    0.008342020213603973,
    0.0928228348493576,
    0.10120442509651184,
    0.009748035110533237,
    -0.08362308144569397,
    0.0935908704996109,
    0.06397819519042969,
    -0.08194839209318161,
    -0.07783743739128113,
    -0.02204767055809498,
    0.0538509264588356,
    0.03576341271400452,
    0.019459305331110954,
    0.06326701492071152,
    0.029031241312623024,
    -0.029503904283046722,
    0.018106749281287193,
    0.1577189564704895,
    0.11645350605249405,
    0.005463010165840387,
    0.08967757970094681,
    0.05489235743880272
  ]
}