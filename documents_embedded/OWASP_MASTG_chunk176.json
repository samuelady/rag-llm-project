{
  "text": "mechanisms. You need to install it on your host computer that will act as the MITM. On macOS it can be installedbyusingbrew. brewinstallbettercap ForKaliLinuxyoucaninstallbettercapwithapt-get: apt-getupdate apt-getinstallbettercap ThereareinstallationinstructionsaswellforUbuntuLinux18.04onLinuxHint. Burp Suite Platform: network Availableat: https://portswigger.net/burp/communitydownload BurpSuiteisanintegratedplatformforperformingsecuritytestingmobileandwebapplications. Its tools work together seamlessly to support the entire testing process, from initial mapping and analysis of attack surfaces to finding and exploiting security vulnerabilities. Burp Proxy operates as a web proxy server for Burp Suite, which is positioned as a man-in-the-middle between the browser and web servers. Burp Suite allows you to intercept, inspect,andmodifyincomingandoutgoingrawHTTPtraffic. SettingupBurptoproxyyourtrafficisprettystraightforward. Weassumethatbothyourdeviceandhostcomputerare connectedtoaWi-Finetworkthatpermitsclient-to-clienttraffic. PortSwiggerprovidesgoodtutorialsonsettingupbothAndroidasiOSdevicestoworkwithBurp: • ConfiguringanAndroidDevicetoWorkWithBurp. • InstallingBurp’sCAcertificatetoanAndroiddevice. • ConfiguringaniOSDevicetoWorkWithBurp. • InstallingBurp’sCAcertificatetoaniOSdevice. Pleaserefertothesection“SettingupanInterceptionProxy”intheAndroidandiOS“BasicSecurityTesting”chaptersfor moreinformation. 559\\nWireshark Platform: network Availableat: https://github.com/wireshark/wireshark Anopen-sourcepacketanalyzer-https://www.wireshark.org/download.html OWASP ZAP Platform: network Availableat: https://github.com/zaproxy/zaproxy OWASP ZAP (Zed Attack Proxy) is a free security tool which helps to automatically find security vulnerabilities in web applicationsandwebservices. tcpdump Platform: network Acommandlinepacketcaptureutility-https://www.tcpdump.org/ MITM Relay Platform: network Availableat: https://github.com/jrmdev/mitm_relay Ascripttointerceptandmodifynon-HTTPprotocolsthroughBurpandotherswithsupportforSSLandSTARTTLSintercep- tion-https://github.com/jrmdev/mitm_relay Android tcpdump Platform: network Availableat: https://www.androidtcpdump.com AcommandlinepacketcaptureutilityforAndroid. r2frida Platform: generic Availableat: https://github.com/nowsecure/r2frida r2fridaisaprojectthatallowsradare2toconnecttoFrida,effectivelymergingthepowerfulreverseengineeringcapabilities ofradare2withthedynamicinstrumentationtoolkitofFrida. r2fridacanbeusedinbothonAndroidandiOS,allowingyou to: • Attachradare2toanylocalprocessorremotefrida-serverviaUSBorTCP. • Read/Writememoryfromthetargetprocess. • LoadFridainformationsuchasmaps,symbols,imports,classesandmethodsintoradare2. • Callr2commandsfromFridaasitexposesther2pipeinterfaceintotheFridaJavascriptAPI. 560\\nPleaserefertor2frida’sofficialinstallationinstructions. Withfrida-serverrunning,youshouldnowbeabletoattachtoitusingthepid,spawnpath,hostandport,ordevice-id. Forexample,toattachtoPID1234: r2frida://1234 Formoreexamplesonhowtoconnecttofrida-server,seetheusagesectioninther2frida’sREADMEpage. ThefollowingexampleswereexecutedusinganAndroidappbutalsoapplytoiOSapps. Onceinther2fridasession,allcommandsstartwith: or=!. Forexample,inradare2you’drunitodisplaythebinary information,butinr2fridayou’duse:i. Seealloptionswithr2 frida://?. [0x00000000]>:i arch x86 bits 64 os linux pid 2218 uid 1000 objc false runtime V8 java false cylang false pageSize 4096 pointerSize 8 codeSigningPolicy optional isDebuggerAttached false Tosearchinmemoryforaspecifickeyword,youmayusethesearchcommand\\/: [0x00000000]>\\/unacceptable Searching12bytes:756e61636365707461626c65 Searching12bytesin [0x0000561f05ebf000-0x0000561f05eca000] ... Searching12bytesin [0xffffffffff600000-0xffffffffff601000] hits:23 0x561f072d89eehit12_0unacceptablepolicyunsupportedmdalgorithmvarbadvaluec 0x561f0732a91ahit12_1unacceptableSearching12bytes:756e61636365707461 To output the search results in JSON format, we simply addj to our previous search command (just as we do in the r2 shell). Thiscanbeusedinmostofthecommands: [0x00000000]>\\/junacceptable Searching12bytes:756e61636365707461626c65 Searching12bytesin [0x0000561f05ebf000-0x0000561f05eca000] ... Searching12bytesin [0xffffffffff600000-0xffffffffff601000] hits:23 {\"address\":\"0x561f072c4223\",\"size\":12,\"flag\":\"hit14_1\",\"content\":\"unacceptable \\ policyunsupportedmdalgorithmvarbadvaluec0\"},{\"address\":\"0x561f072c4275\", \\ \"size\":12,\"flag\":\"hit14_2\",\"content\":\"unacceptableSearching12bytes:756e61 \\ 636365707461\"},{\"address\":\"0x561f072c42c8\",\"size\":12,\"flag\":\"hit14_3\",\\ \"content\":\"unacceptableSearching12bytes:756e61636365707461\"}, ... To list the loaded libraries use the command :il and filter the results using the internal grep from radare2 with the command~. Forexample,thefollowingcommandwilllisttheloadedlibrariesmatchingthekeywordskeystore,ssland crypto: [0x00000000]>:il~keystore,ssl,crypto 0x00007f3357b8e000libssl.so.1.1 0x00007f3357716000libcrypto.so.1.1 Similarly,tolisttheexportsandfiltertheresultsbyaspecifickeyword: 561\\n[0x00000000]>:iElibssl.so.1.1~CIPHER 0x7f3357bb7ef0fSSL_CIPHER_get_bits 0x7f3357bb8260fSSL_CIPHER_find 0x7f3357bb82c0fSSL_CIPHER_get_digest_nid 0x7f3357bb8380fSSL_CIPHER_is_aead 0x7f3357bb8270fSSL_CIPHER_get_cipher_nid 0x7f3357bb7ed0fSSL_CIPHER_get_name 0x7f3357bb8340fSSL_CIPHER_get_auth_nid 0x7f3357bb7930fSSL_CIPHER_description 0x7f3357bb8300fSSL_CIPHER_get_kx_nid 0x7f3357bb7ea0fSSL_CIPHER_get_version 0x7f3357bb7f10fSSL_CIPHER_get_id Tolistorsetabreakpointusethecommanddb. Thisisusefulwhenanalyzing/modifyingmemory: [0x00000000]>:db Finally,rememberthatyoucanalsorunFridaJavaScriptcodewith\\. plusthenameofthescript: [0x00000000]>\\.agent.js Youcanfindmoreexamplesonhowtouser2fridaontheirWikiproject. Frida Platform: generic Availableat: https://github.com/frida/frida FridaisafreeandopensourcedynamiccodeinstrumentationtoolkitwrittenbyOleAndréVadlaRavnåsthatworksby injectingtheQuickJSJavaScriptengine(previouslyDuktapeandV8)intotheinstrumentedprocess. Fridaletsyouexecute snippetsofJavaScriptintonativeappsonAndroidandiOS(aswellasonotherplatforms). ToinstallFridalocally,simplyrun: pipinstallfrida-tools Orrefertotheinstallationpageformoredetails. Codecanbeinjectedinseveralways. Forexample,XposedpermanentlymodifiestheAndroidapploader,providinghooks forrunningyourowncodeeverytimeanewprocessisstarted. Incontrast,Fridaimplementscodeinjectionbywriting codedirectlyintotheprocessmemory. Whenattachedtoarunningapp: • Fridausesptracetohijackathreadofarunningprocess. Thisthreadisusedtoallocateachunkofmemoryand populateitwithamini-bootstrapper. • Thebootstrapperstartsafreshthread, connectstotheFridadebuggingserverthat’srunningonthedevice, and loadsasharedlibrarythatcontainstheFridaagent(frida-agent.so). • Theagentestablishesabi-directionalcommunicationchannelbacktothetool(e.g.theFridaREPLoryourcustom Pythonscript). • Thehijackedthreadresumesafterbeingrestoredtoitsoriginalstate,andprocessexecutioncontinuesasusual. 562\\n• FridaArchitecture,source: https://www.frida.re/docs/hacking/ Fridaoffersthreemodesofoperation: 1. Injected: thisisthemostcommonscenariowhenfrida-serverisrunningasadaemonintheiOSorAndroiddevice. frida-core is exposed over TCP, listening on localhost:27042 by default. Running in this mode is not possible on devicesthatarenotrootedorjailbroken. 2. Embedded: thisisthecasewhenyourdeviceisnotrootednorjailbroken(youcannotuseptraceasanunprivileged user),you’reresponsiblefortheinjectionofthefrida-gadgetlibrarybyembeddingitintoyourapp,manuallyorvia third-partytoolssuchasObjection. 3. Preloaded: similar to LD_PRELOAD or DYLD_INSERT_LIBRARIES. You can configure the frida-gadget to run autonomouslyandloadascriptfromthefilesystem(e.g.pathrelativetowheretheGadgetbinaryresides). Independently of the chosen mode, you can make use of the Frida JavaScript APIs to interact with the running process anditsmemory. SomeofthefundamentalAPIsare: • Interceptor: WhenusingtheInterceptorAPI,Fridainjectsatrampoline(akain-linehooking)atthefunctionprologue whichprovokesaredirectiontoourcustomcode,executesourcode,andreturnstotheoriginalfunction. Notethat whileveryeffectiveforourpurpose,thisintroducesaconsiderableoverhead(duetothetrampolinerelatedjumping andcontextswitching)andcannotbeconsideredtransparentasitoverwritestheoriginalcodeandactssimilarto a debugger (putting breakpoints) and therefore can be detected in a similar manner, e.g. by applications that periodicallychecksumtheirowncode. • Stalker: If your tracing requirements include transparency, performance and high granularity, Stalker should be yourAPIofchoice. WhentracingcodewiththeStalkerAPI,Fridaleveragesjust-in-timedynamicrecompilation(by usingCapstone): whenathreadisabouttoexecuteitsnextinstructions,Stalkerallocatessomememory,copies the original code over, and interlaces the copy with your custom code for instrumentation. Finally, it executes thecopy(leavingtheoriginalcodeuntouched,andthereforeavoidinganyanti-debuggingchecks). Thisapproach 563\\nincreases instrumentation performance considerably and allows for very high granularity when tracing (e.g. by tracingexclusivelyCALLorRETinstructions). Youcanlearnmorein-depthdetailsintheblogpost“Anatomyofa codetracer”byFrida’screatorOle[#vadla]. SomeexamplesofuseforStalkerare,forexamplewho-does-it-callor diff-calls. • Java: WhenworkingonAndroidyoucanusethisAPItoenumerateloadedclasses,enumerateclassloaders,create andusespecificclassinstances,enumerateliveinstancesofclassesbyscanningtheheap,etc. • ObjC:WhenworkingoniOSyoucanusethisAPItogetamappingofallregisteredclasses,registerorusespecific classorprotocolinstances,enumerateliveinstancesofclassesbyscanningtheheap,etc. Frida",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 176
  },
  "embedding": [
    -0.00453204195946455,
    -0.018824536353349686,
    -0.008358757942914963,
    -0.0560922846198082,
    -0.018796764314174652,
    -0.02496831864118576,
    -0.05629533901810646,
    -0.019342076033353806,
    -0.033778779208660126,
    -0.04311002790927887,
    0.0377795547246933,
    -0.0657668262720108,
    0.020653732120990753,
    -0.0007774968980811536,
    0.06730882078409195,
    0.024263812229037285,
    0.08450854569673538,
    0.0051330691203475,
    0.07029163092374802,
    -0.03503534570336342,
    0.007985340431332588,
    0.01022425852715969,
    -0.007215375080704689,
    0.10988789796829224,
    -0.029451752081513405,
    0.003688967786729336,
    0.029305703938007355,
    -0.04539673030376434,
    -0.002227934543043375,
    -0.05130268260836601,
    -0.006151819601655006,
    -0.03150980547070503,
    -0.05975683033466339,
    0.009735162369906902,
    0.05900335684418678,
    -0.0616341307759285,
    0.05878007039427757,
    0.045001838356256485,
    -0.03163910284638405,
    -0.08204701542854309,
    0.06332413852214813,
    -0.038133006542921066,
    0.011645355261862278,
    0.044782038778066635,
    0.015596365556120872,
    -0.06050700321793556,
    0.009608794935047626,
    0.039797037839889526,
    0.037994153797626495,
    -0.020456792786717415,
    0.035710204392671585,
    -0.03493428975343704,
    0.06566715240478516,
    0.11080168932676315,
    -0.0021160212345421314,
    -0.05733610317111015,
    -0.004384421277791262,
    -0.008949358016252518,
    0.11206726729869843,
    0.0798085629940033,
    0.00373441562987864,
    -0.01620648242533207,
    -0.007889636792242527,
    0.0366985946893692,
    -0.032556887716054916,
    0.027650153264403343,
    -0.0344528891146183,
    0.0225856713950634,
    0.10821439325809479,
    -0.04427320510149002,
    0.006138909608125687,
    -0.04670288413763046,
    0.002278045052662492,
    0.05440608039498329,
    0.037206243723630905,
    0.043514035642147064,
    -0.02594951167702675,
    -0.004251136444509029,
    -0.017772961407899857,
    -0.050038475543260574,
    0.07710011303424835,
    0.0052712406031787395,
    -0.019304290413856506,
    0.10647937655448914,
    -0.02516520768404007,
    0.06102507933974266,
    0.04784006625413895,
    0.03202706202864647,
    0.031054241582751274,
    0.02463860623538494,
    0.027208425104618073,
    -0.03933479264378548,
    -0.07508573681116104,
    0.006411388516426086,
    -0.04084363207221031,
    -0.0013902602950111032,
    0.03676341846585274,
    -0.02318510413169861,
    -0.004028500523418188,
    0.08123501390218735,
    -0.04130515456199646,
    -0.06444094330072403,
    0.0229781586676836,
    -0.056092243641614914,
    -0.00037410471122711897,
    -0.009948153048753738,
    0.060096822679042816,
    0.002707856707274914,
    0.1410795897245407,
    -0.014370928518474102,
    -0.02214268036186695,
    -0.07230839878320694,
    0.06614083051681519,
    0.012080363929271698,
    0.0002762234362307936,
    -0.015732605010271072,
    0.047700878232717514,
    -0.03306708484888077,
    0.015586713328957558,
    -0.04416880011558533,
    0.06986719369888306,
    0.01428055390715599,
    0.012844529934227467,
    -0.04959581792354584,
    0.10012459009885788,
    0.05240989103913307,
    0.02024952694773674,
    1.5543096011286594e-32,
    0.07439529150724411,
    -0.0013024858199059963,
    -0.06846176832914352,
    0.07047634571790695,
    0.017989853397011757,
    -0.061425626277923584,
    0.08758274465799332,
    0.01922270469367504,
    -0.012378228828310966,
    -0.011783983558416367,
    0.006197317969053984,
    0.03432663530111313,
    -0.06323198229074478,
    0.035479072481393814,
    0.045337505638599396,
    -0.060016341507434845,
    -0.07539292424917221,
    0.050030577927827835,
    0.08758040517568588,
    0.025307035073637962,
    -0.0554000623524189,
    -0.09210612624883652,
    -0.033483996987342834,
    -0.02610795386135578,
    0.014330152422189713,
    0.020452022552490234,
    0.0022976757027208805,
    -0.00909418985247612,
    0.04300939664244652,
    0.04892387241125107,
    0.0838170051574707,
    0.0627971664071083,
    -0.11574411392211914,
    -0.0254495982080698,
    -0.02607833780348301,
    -0.07531685382127762,
    -0.032164912670850754,
    -0.08045759797096252,
    -0.06871664524078369,
    -0.013875297270715237,
    -0.050441429018974304,
    -0.021408433094620705,
    -0.13070467114448547,
    0.02221958339214325,
    0.06314927339553833,
    -0.22034017741680145,
    -0.1115691289305687,
    -0.011968933045864105,
    0.06880203634500504,
    0.012489350512623787,
    0.02315772883594036,
    -0.040368981659412384,
    0.0738837942481041,
    -0.011328195221722126,
    -0.022977430373430252,
    0.05993548408150673,
    -0.00341022782959044,
    -0.06450466811656952,
    0.030769405886530876,
    0.011131735518574715,
    -0.03264782950282097,
    0.04437271133065224,
    -0.07569217681884766,
    0.0011113049695268273,
    0.045332543551921844,
    -0.07317115366458893,
    0.003983131609857082,
    -0.017349887639284134,
    0.0007702751317992806,
    0.03457622602581978,
    -0.02897012233734131,
    -0.04519546404480934,
    -0.007213409058749676,
    0.008429858833551407,
    -0.0641135722398758,
    -0.03052585944533348,
    -0.02780918776988983,
    0.08342904597520828,
    0.0008275675354525447,
    -0.01662614569067955,
    0.022126099094748497,
    -0.06246059387922287,
    0.08071856200695038,
    0.04929111525416374,
    -0.00988776981830597,
    0.02167995274066925,
    -0.024354157969355583,
    -0.10298153758049011,
    -0.01692243106663227,
    0.023586714640259743,
    -0.019644033163785934,
    0.05522013083100319,
    0.02691681869328022,
    0.05427682027220726,
    -0.07312946021556854,
    -1.3419872564425284e-32,
    -0.003959366120398045,
    -0.03474126756191254,
    -0.004124253522604704,
    0.05004974082112312,
    -0.04729307070374489,
    -0.02537435106933117,
    -0.026058385148644447,
    0.021990476176142693,
    0.02006741426885128,
    -0.0053505371324718,
    -0.015290575101971626,
    0.027074024081230164,
    0.05831971764564514,
    -0.06383669376373291,
    0.019077733159065247,
    -0.0034258810337632895,
    -0.020875245332717896,
    -0.04490642994642258,
    -0.04607982188463211,
    -0.00421449588611722,
    -0.040149081498384476,
    0.03582018241286278,
    0.03216097503900528,
    -0.01057758554816246,
    -0.011953727342188358,
    -0.0020788651891052723,
    0.006938809994608164,
    0.060869429260492325,
    0.014988848008215427,
    0.00576546648517251,
    0.048438671976327896,
    0.10056037455797195,
    -0.02310122922062874,
    -0.01946118101477623,
    -0.007963236421346664,
    0.04957449808716774,
    0.024040257558226585,
    0.11837480962276459,
    0.01668565720319748,
    -0.062300894409418106,
    0.039791956543922424,
    0.036214739084243774,
    -0.1278398036956787,
    -0.1185985878109932,
    0.03364036977291107,
    0.057099923491477966,
    0.011915285140275955,
    -0.002028971677646041,
    0.01553145982325077,
    0.0013706730678677559,
    0.06706507503986359,
    0.006990242749452591,
    0.0497727170586586,
    0.054987985640764236,
    -0.028842151165008545,
    -0.015019051730632782,
    0.023221373558044434,
    -0.0072578927502036095,
    -0.04876574128866196,
    0.024982016533613205,
    0.029628444463014603,
    -0.02948714978992939,
    0.004081550054252148,
    0.016854707151651382,
    -0.025066018104553223,
    -0.0033368158619850874,
    -0.08171655982732773,
    -0.012710907496511936,
    -0.017313867807388306,
    0.029436582699418068,
    -0.022393113002181053,
    -0.06691524386405945,
    0.06291189789772034,
    0.011782950721681118,
    0.028524862602353096,
    -0.042681194841861725,
    -0.0066779726184904575,
    -0.13422825932502747,
    -0.03854896500706673,
    0.03290718048810959,
    0.004645044915378094,
    0.08447907865047455,
    -0.04997701197862625,
    -0.021604949608445168,
    0.007281303405761719,
    -0.03364576771855354,
    -0.027719920501112938,
    0.0249550212174654,
    0.04954439029097557,
    0.009158414788544178,
    -0.08611232042312622,
    -0.030338652431964874,
    -0.09567194432020187,
    -0.041396137326955795,
    0.02153930626809597,
    -6.727952239771184e-08,
    0.043570682406425476,
    0.00024281209334731102,
    -0.002849476644769311,
    0.016604643315076828,
    -0.03049221634864807,
    0.04700309783220291,
    -0.08699970692396164,
    -0.06977957487106323,
    -0.012670761905610561,
    -0.07077717781066895,
    0.03637929633259773,
    -0.0006906113703735173,
    -0.044113337993621826,
    0.05034733563661575,
    -0.013669798150658607,
    0.037784237414598465,
    0.04231349378824234,
    0.037262339144945145,
    -0.06874755769968033,
    -0.05098992586135864,
    -0.09398835152387619,
    -0.009290717542171478,
    0.03534383326768875,
    0.09686267375946045,
    -0.015677498653531075,
    0.025830816477537155,
    0.05646120384335518,
    0.04194542020559311,
    0.0507226288318634,
    0.04463183879852295,
    -0.02298343926668167,
    -0.0011333456495776772,
    -0.037668902426958084,
    -0.02157963253557682,
    0.022719357162714005,
    0.1550978124141693,
    -0.1393362283706665,
    0.005034555681049824,
    0.025330178439617157,
    0.05798914656043053,
    -0.039367564022541046,
    -0.0021794207859784365,
    0.008187176659703255,
    -0.06278097629547119,
    -0.06907711178064346,
    -0.054234471172094345,
    -0.11038162559270859,
    0.053116749972105026,
    -0.030478978529572487,
    -0.008267293684184551,
    0.09421082586050034,
    -0.09991449862718582,
    -0.019105440005660057,
    0.022566484287381172,
    -0.05126659944653511,
    0.026148514822125435,
    0.050204839557409286,
    -0.1605367511510849,
    0.009080998599529266,
    -0.00040197966154664755,
    0.07770170271396637,
    0.04122498258948326,
    0.11887568235397339,
    -0.020695308223366737
  ]
}