{
  "text": "toGDBcommands. Get Open Files Platform: ios lsofisapowerfulcommand,andprovidesaplethoraofinformationaboutarunningprocess. Itcanprovidealistofall openfiles, including a stream, a networkfile ora regularfile. Wheninvoking thelsof commandwithout anyoption it will list all open files belonging to all active processes on the system, while when invoking with the flags -c <process name>or-p <pid>,itreturnsthelistofopenfilesforthespecifiedprocess. Themanpageshowsvariousotheroptionsin detail. UsinglsofforaniOSapplicationrunningwithPID2828,listvariousopenfilesasshownbelow. iPhone:~root#lsof -p2828 COMMAND PID USER FD TYPEDEVICESIZE/OFF NODENAME iOweApp2828mobile cwd DIR 1,2 864 2/ iOweApp2828mobile txt REG 1,3 206144189774/private/var/containers/Bundle/Application/F390A491-3524-40EA-B3F8-6C1FA105A23A/iOweApp.app/iOweApp iOweApp2828mobile txt REG 1,3 5492213230/private/var/mobile/Containers/Data/Application/5AB3E437-9E2D-4F04-BD2B- ↪ 972F6055699E/tmp/com.apple.dyld/iOweApp-6346DC276FE6865055F1194368EC73CC72E4C5224537F7F23DF19314CF6FD8AA.closure iOweApp2828mobile txt REG 1,3 30628212198/private/var/preferences/Logging/.plist-cache.vqXhr1EE iOweApp2828mobile txt REG 1,2 50080234433/usr/lib/libobjc-trampolines.dylib iOweApp2828mobile txt REG 1,2 344204 74185/System/Library/Fonts/AppFonts/ChalkboardSE.ttc iOweApp2828mobile txt REG 1,2 664848234595/usr/lib/dyld ... 388\\nSetting up an Interception Proxy Platform: ios BurpSuiteisanintegratedplatformforsecuritytestingmobileandwebapplications. Itstoolsworktogetherseamlesslyto supporttheentiretestingprocess,frominitialmappingandanalysisofattacksurfacestofindingandexploitingsecurity vulnerabilities. Burp Proxy operates as a web proxy server for Burp Suite, which is positioned as a man-in-the-middle betweenthebrowserandwebserver(s). BurpSuiteallowsyoutointercept,inspect,andmodifyincomingandoutgoing rawHTTPtraffic. SettingupBurptoproxyyourtrafficisprettystraightforward. WeassumethatbothyouriOSdeviceandhostcomputer areconnectedtoaWi-Finetworkthatpermitsclient-to-clienttraffic. Ifclient-to-clienttrafficisnotpermitted,youcanuse usbmuxdtoconnecttoBurpviaUSB. PortSwiggerprovidesagoodtutorialonsettingupaniOSdevicetoworkwithBurpandatutorialoninstallingBurp’sCA certificatetoaniOSdevice. Using Burp via USB on a Jailbroken Device InthesectionAccessingtheDeviceShellwe’vealreadylearnedhowwecanuseiproxytouseSSHviaUSB.Whendoing dynamicanalysis,it’sinterestingtousetheSSHconnectiontorouteourtraffictoBurpthatisrunningonourcomputer. Let’sgetstarted: FirstweneedtouseiproxytomakeSSHfromiOSavailableonlocalhost. $iproxy222222 waitingforconnection Thenextstepistomakearemoteportforwardingofport8080ontheiOSdevicetothelocalhostinterfaceonourcomputer toport8080. ssh-R8080:localhost:8080root@localhost -p2222 YoushouldnowbeabletoreachBurponyouriOSdevice. OpenSafarioniOSandgoto127.0.0.1:8080andyoushould seetheBurpSuitePage. ThiswouldalsobeagoodtimetoinstalltheCAcertificateofBurponyouriOSdevice. ThelaststepwouldbetosettheproxygloballyonyouriOSdevice: 1. GotoSettings->Wi-Fi 2. ConnecttoanyWi-Fi(youcanliterallyconnecttoanyWi-Fiasthetrafficforport80and443willberoutedthrough USB,aswearejustusingtheProxySettingfortheWi-FisowecansetaglobalProxy) 3. OnceconnectedclickonthesmallblueiconontherightsideoftheconnectWi-Fi 4. ConfigureyourProxybyselectingManual 5. Typein127.0.0.1asServer 6. Typein8080asPort OpenSafariandgotoanywebpage,youshouldseenowthetrafficinBurp. Thanks@hweisheimerfortheinitialidea! Static Analysis on iOS Platform: ios ThepreferredmethodofstaticallyanalyzingiOSappsinvolvesusingtheoriginalXcodeprojectfiles. Ideally,youwillbe abletocompileanddebugtheapptoquicklyidentifyanypotentialissueswiththesourcecode. BlackboxanalysisofiOSappswithoutaccesstotheoriginalsourcecoderequiresreverseengineering. Forexample,no decompilersareavailableforiOSapps(althoughmostcommercialandopen-sourcedisassemblerscanprovideapseudo- sourcecodeviewofthebinary),soadeepinspectionrequiresyoutoreadassemblycode. 389\\nReverse Engineering iOS Apps Platform: ios iOSreverseengineeringisamixedbag. Ononehand,appsprogrammedinObjective-CandSwiftcanbedisassembled nicely. InObjective-C,objectmethodsarecalledviadynamicfunctionpointerscalled“selectors”,whichareresolvedby name during runtime. The advantage of runtime name resolution is that these names need to stay intact in the final binary,makingthedisassemblymorereadable. Unfortunately,thisalsomeansthatnodirectcross-referencesbetween methodsareavailableinthedisassemblerandconstructingaflowgraphischallenging. References • [#miller] - Charlie Miller, Dino Dai Zovi. The iOS Hacker’s Handbook. Wiley, 2012 - https://www.wiley.com/en- us/iOS+Hacker%27s+Handbook-p-9781118204122 • [#levin]JonathanLevin. MacOSXandiOSInternals: TotheApple’sCore. Wiley,2013-http://newosxbook.com/M OXiI.pdf Host-Device Data Transfer Platform: ios TheremightbevariousscenarioswhereyoumightneedtotransferdatafromtheiOSdeviceorappdatasandboxtoyour hostcomputerorviceversa. Thefollowingsectionwillshowyoudifferentwaysonhowtoachievethat. Copying App Data Files via SSH and SCP Asweknownow,filesfromourapparestoredintheDatadirectory. YoucannowsimplyarchivetheDatadirectorywith tarandpullitfromthedevicewithscp: iPhone:~root#tarczvf/tmp/data.tgz/private/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693 iPhone:~root#exit $scp -P2222root@localhost:/tmp/data.tgz. Grapefruit AfterstartingGrapefruityoucanselecttheappthatisinscopefortesting. Therearevariousfunctionsavailable,ofwhich oneiscalled“Finder”. Whenselectingit,youwillgetalistingofthedirectoriesoftheappsandbox. 390\\nWhen navigating through the directories and selecting a file, a pop-up will show up and display the data either as hex- adecimalortext. Whenclosingthispop-upyouhavevariousoptionsavailableforthefile,including: • Databaseviewer • Plistviewer • Download Objection WhenyouarestartingobjectionyouwillfindthepromptwithintheBundledirectory. 391\\norg.owasp.MSTGon (iPhone:10.3.3)[usb] #pwdprint Currentdirectory:/var/containers/Bundle/Application/DABF849D-493E-464C-B66B-B8B6C53A4E76/org.owasp.MSTG.app UsetheenvcommandtogetthedirectoriesoftheappandnavigatetotheDocumentsdirectory. org.owasp.MSTGon (iPhone:10.3.3)[usb] #cd/var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents Withthecommandfile download <filename>youcandownloadafilefromtheiOSdevicetoyourhostcomputerand cananalyzeitafterwards. org.owasp.MSTGon (iPhone:10.3.3)[usb] #filedownload.com.apple.mobile_container_manager.metadata.plist Downloading/var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/.com.apple.mobile_container_manager.metadata.plistto ↪ .com.apple.mobile_container_manager.metadata.plist Streamingfilefromdevice... Writingbytestodestination... Successfullydownloaded/var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/.com.apple.mobile_container_manager.metadata.plistto ↪ .com.apple.mobile_container_manager.metadata.plist YoucanalsouploadfilestotheiOSdevicewithfile upload <local_file_path>. Dynamic Analysis on iOS Platform: ios Lifeiseasywithajailbrokendevice: notonlydoyougaineasyprivilegedaccesstothedevice,thelackofcodesigning allowsyoutousemorepowerfuldynamicanalysistechniques. OniOS,mostdynamicanalysistoolsarebasedonCydia Substrate,aframeworkfordevelopingruntimepatches,orFrida,adynamicintrospectiontool. ForbasicAPImonitoring, you can get away with not knowing all the details of how Substrate or Frida work - you can simply use existing API monitoringtools. On iOS, collecting basic information about a running process or an application can be slightly more challenging than compared to Android. On Android (or any Linux-based OS), process information is exposed as readable text files via procfs. Thus,anyinformationaboutatargetprocesscanbeobtainedonarooteddevicebyparsingthesetextfiles. In contrast,oniOSthereisnoprocfsequivalentpresent. Also,oniOSmanystandardUNIXcommandlinetoolsforexploring processinformation,forinstancelsofandvmmap,areremovedtoreducethefirmwaresize. Inthissection,wewilllearnhowtocollectprocessinformationoniOSusingcommandlinetoolslikelsof. Sincemanyof thesetoolsarenotpresentoniOSbydefault,weneedtoinstallthemviaalternativemethods. Forinstance,lsofcanbe installedusingCydia(theexecutableisnotthelatestversionavailable,butneverthelessaddressesourpurpose). Obtaining and Extracting Apps Platform: ios Getting the IPA File from an OTA Distribution Link Duringdevelopment,appsaresometimesprovidedtotestersviaover-the-air(OTA)distribution. Inthatsituation,you’ll receiveanitms-serviceslink,suchasthefollowing: itms-services://?action=download-manifest&url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist YoucanusetheITMSservicesassetdownloadertooltodownloadtheIPAfromanOTAdistributionURL.Installitvianpm: npminstall -gitms-services SavetheIPAfilelocallywiththefollowingcommand: 392\\n##itms-services-u\"itms-services://?action=download-manifest&url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist\"-o->out.ipa Extracting the App Binary If you have an IPA with a decrypted app binary, unzip it and you are ready to go. The app binary is located in the mainbundledirectory(.app),e.g.Payload/Telegram X.app/Telegram X.Seethefollowingsubsectionfordetailsonthe extractionofthepropertylists. OnmacOS’sFinder,.appdirectoriesareopenedbyright-clickingthemandselecting“ShowPackageContent”. On theterminalyoucanjustcdintothem. Decrypting the App Binary IMPORTANT NOTE:IntheUnitedStates,theDigitalMillenniumCopyrightAct17U.S.C.1201,orDMCA,makesit illegalandactionabletocircumventcertaintypesofDRM.However,theDMCAalsoprovidesexemptions,suchas forcertainkindsofsecurityresearch. Aqualifiedattorneycanhelpyoudetermineifyourresearchqualifiesunder theDMCAexemptions. (Source: Corellium) If you don’t have the original IPA, then you need a jailbroken device where you will install the",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 134
  },
  "embedding": [
    0.018430659547448158,
    -0.01719200611114502,
    -0.09485816955566406,
    -0.02823484130203724,
    0.07797018438577652,
    0.014728941954672337,
    0.05118829756975174,
    0.03752927854657173,
    0.0291471965610981,
    0.0830792486667633,
    -0.007253228686749935,
    0.008262100629508495,
    -0.03784377500414848,
    0.01901349425315857,
    -0.0432896688580513,
    -0.020917562767863274,
    0.012692018412053585,
    -0.0540759339928627,
    -0.0025065147783607244,
    -0.0229730773717165,
    0.03589054197072983,
    0.0719582661986351,
    0.013552824035286903,
    -0.03912800922989845,
    -0.028316156938672066,
    0.012412849813699722,
    -0.07994265109300613,
    -0.1265937238931656,
    -0.02230183407664299,
    -0.021394168958067894,
    0.043137114495038986,
    0.029719701036810875,
    -0.03314804285764694,
    0.02867651917040348,
    0.15647487342357635,
    0.008125588297843933,
    0.06371650844812393,
    -0.06389971822500229,
    -0.04791376739740372,
    -0.0308421291410923,
    0.0950532779097557,
    0.017117228358983994,
    -0.050950635224580765,
    0.10448721796274185,
    -0.04239648953080177,
    0.03541101887822151,
    -0.07675231248140335,
    -0.059949565678834915,
    -0.04071859270334244,
    -0.05855077505111694,
    0.01594145968556404,
    0.052599336951971054,
    -0.017964545637369156,
    0.051236845552921295,
    0.03186793625354767,
    -0.0016560846706852317,
    -0.014771555550396442,
    -0.008089027367532253,
    0.03466207906603813,
    0.12184464186429977,
    -0.03216075152158737,
    0.006860136520117521,
    -0.04228270798921585,
    -0.007972657680511475,
    0.005948761478066444,
    0.06827006489038467,
    -0.052615467458963394,
    -0.007181356195360422,
    0.01440449245274067,
    -0.09717430919408798,
    -0.026780569925904274,
    0.008278566412627697,
    -0.001721454900689423,
    0.03002692572772503,
    0.008313300088047981,
    0.0019825275521725416,
    0.027315590530633926,
    -0.0031549206469208,
    -0.11970466375350952,
    -0.17637859284877777,
    0.049663934856653214,
    0.00932985357940197,
    0.05588984489440918,
    -0.004882567096501589,
    -0.005270474124699831,
    0.09010367095470428,
    -0.04470384120941162,
    -0.04940664395689964,
    0.09968815743923187,
    0.04670017957687378,
    -0.04340091720223427,
    0.03397652506828308,
    -0.13634942471981049,
    -0.0023587187752127647,
    0.01332563441246748,
    -0.00949790421873331,
    -0.0068087209947407246,
    0.004459664225578308,
    -0.0015842397697269917,
    -0.02044740878045559,
    0.023606853559613228,
    0.03720469027757645,
    0.014673897065222263,
    -0.03677137941122055,
    0.021715309470891953,
    -0.026057537645101547,
    0.010568803176283836,
    -0.0343468077480793,
    -0.002856308361515403,
    0.03173575922846794,
    -0.003222247352823615,
    -0.017492808401584625,
    0.05556129291653633,
    0.010970743373036385,
    0.0069123320281505585,
    -0.02027469500899315,
    -0.03596719354391098,
    0.04344372823834419,
    -0.025102723389863968,
    0.06436024606227875,
    -0.00614284910261631,
    -0.0027595539577305317,
    -0.00044246987090446055,
    0.033076077699661255,
    -0.09106077253818512,
    -0.0366172157227993,
    -0.017899855971336365,
    1.3728948232822865e-32,
    0.009321710094809532,
    -0.05698578804731369,
    0.0068989964202046394,
    0.0042159962467849255,
    -0.04790455475449562,
    -0.04985945671796799,
    0.07433228194713593,
    0.03420162945985794,
    0.01132907159626484,
    0.0911235585808754,
    -0.05987051874399185,
    0.04199029505252838,
    -0.0670388713479042,
    -0.0276767760515213,
    -0.02363397553563118,
    -0.004740499425679445,
    0.004070780239999294,
    0.0070830523036420345,
    -0.02311766892671585,
    -0.02208995819091797,
    -0.00532294949516654,
    0.009111347608268261,
    -0.13859446346759796,
    0.018067913129925728,
    0.060849763453006744,
    -8.318426807818469e-06,
    -0.0006958446465432644,
    -0.08269697427749634,
    0.08133624494075775,
    0.02351682260632515,
    0.06029779464006424,
    -0.02520066685974598,
    -0.03880668431520462,
    -0.009081481955945492,
    -0.06815428286790848,
    -0.04249901324510574,
    0.020024193450808525,
    0.02212800830602646,
    0.007802324835211039,
    -0.07597852498292923,
    -0.029436388984322548,
    0.0016039680922403932,
    -0.043371256440877914,
    0.009482217952609062,
    -0.053339432924985886,
    -0.02761746756732464,
    -0.11634909361600876,
    -0.04431811347603798,
    -0.018040282651782036,
    -0.013305372558534145,
    0.0786934643983841,
    -0.06246769055724144,
    -0.0518120713531971,
    -0.03403617441654205,
    -0.028627900406718254,
    0.012391815893352032,
    -0.032503675669431686,
    -0.02481992356479168,
    0.05962863564491272,
    0.051077693700790405,
    0.019213100895285606,
    0.030475793406367302,
    -0.07312708348035812,
    -0.05625048279762268,
    0.02586229518055916,
    -0.044578917324543,
    0.04255950450897217,
    -0.08513803780078888,
    -0.048355717211961746,
    0.05906733125448227,
    -0.13808758556842804,
    -0.007491922937333584,
    0.06658812612295151,
    -0.040323905646800995,
    0.06513699144124985,
    0.04269985482096672,
    -0.0045248582027852535,
    -0.013231727294623852,
    -0.06720693409442902,
    -0.026613721624016762,
    0.0514904223382473,
    -0.017106151208281517,
    0.026856377720832825,
    -0.027211766690015793,
    -0.025124993175268173,
    -0.03258759528398514,
    -0.049952659755945206,
    -0.08395958691835403,
    -0.06333249062299728,
    0.07948353886604309,
    0.033906470984220505,
    0.02401171438395977,
    -0.0025923673529177904,
    0.019385671243071556,
    -0.06728514283895493,
    -1.3559302357480131e-32,
    0.036986932158470154,
    -0.0188687052577734,
    -0.015452923253178596,
    -0.09426354616880417,
    0.02714509889483452,
    -0.012252547778189182,
    -0.0641498938202858,
    -0.021842332556843758,
    0.012873994186520576,
    -0.006800999864935875,
    0.04415832832455635,
    0.0015870967181399465,
    0.021022651344537735,
    -0.04803983494639397,
    -0.028133241459727287,
    0.009319083765149117,
    0.02672487683594227,
    0.0024515101686120033,
    -0.058914538472890854,
    0.13420969247817993,
    -0.059108708053827286,
    0.02770938165485859,
    0.13080228865146637,
    0.0010192540939897299,
    0.011841784231364727,
    0.004685570951551199,
    0.01646450348198414,
    0.03348357975482941,
    0.044764194637537,
    -0.026069168001413345,
    0.02375454641878605,
    -0.028924982994794846,
    -0.04998649284243584,
    -0.05277754366397858,
    -0.035860978066921234,
    -0.022204190492630005,
    -0.022910652682185173,
    0.07828648388385773,
    0.007541656494140625,
    -0.002705302555114031,
    0.0400700606405735,
    0.035563062876462936,
    -0.03426741063594818,
    -0.00804098416119814,
    -0.0058324309065938,
    0.016856303438544273,
    0.011155348271131516,
    -0.012078564614057541,
    -0.039787761867046356,
    -0.017663348466157913,
    0.0898704081773758,
    0.010353981517255306,
    0.03311862796545029,
    0.06919717788696289,
    0.0656362995505333,
    0.08702871203422546,
    0.18172702193260193,
    -0.09793217480182648,
    -0.08732619881629944,
    -0.0690002590417862,
    0.17521227896213531,
    -0.01964099518954754,
    -0.10263971239328384,
    -0.08045671135187149,
    -0.003220445243641734,
    0.059007033705711365,
    -0.008895493112504482,
    -0.02251531556248665,
    0.007280217949301004,
    -0.015655355527997017,
    -0.05995352193713188,
    -0.06952299922704697,
    -0.03919599950313568,
    -0.005583159159868956,
    -0.047426942735910416,
    0.05271128565073013,
    -0.0126564996317029,
    -0.15416750311851501,
    -0.017641514539718628,
    0.07385936379432678,
    -0.01794062741100788,
    0.07826720923185349,
    -0.037124160677194595,
    -0.042174432426691055,
    0.07564695924520493,
    0.008408332243561745,
    -0.017242496833205223,
    0.043714530766010284,
    0.0672796443104744,
    0.055341728031635284,
    -0.07117032259702682,
    0.03104722499847412,
    0.012507352977991104,
    0.005813698749989271,
    -0.011157124303281307,
    -6.028580656902705e-08,
    -0.06938936561346054,
    -0.073488749563694,
    0.04963534325361252,
    -0.0040110014379024506,
    0.052313752472400665,
    0.027313292026519775,
    0.026924801990389824,
    0.06871899217367172,
    0.03306059166789055,
    -0.0411575585603714,
    0.00031895804568193853,
    -0.02744244784116745,
    -0.031597238034009933,
    -0.029924413189291954,
    0.10012883692979813,
    -0.006578556261956692,
    0.09769334644079208,
    0.001345491036772728,
    0.031635627150535583,
    0.02516179531812668,
    0.028502268716692924,
    -0.008651205338537693,
    -0.02304847724735737,
    -0.0001545438135508448,
    -0.06789045035839081,
    0.019801834598183632,
    0.07023615390062332,
    -0.04382946342229843,
    -0.01593754068017006,
    0.04435187578201294,
    0.009008617140352726,
    -0.03483494743704796,
    0.018625980243086815,
    -0.043721169233322144,
    -0.068020761013031,
    0.13641655445098877,
    0.029230810701847076,
    -0.06368491053581238,
    0.016085801646113396,
    0.008383255451917648,
    -0.007799823768436909,
    0.06077662110328674,
    0.019731134176254272,
    0.045336320996284485,
    -0.026126060634851456,
    -0.01593802496790886,
    0.05640530213713646,
    0.01837356574833393,
    0.04036564379930496,
    -0.0008219063747674227,
    -0.06797541677951813,
    -0.03967892751097679,
    -0.026632295921444893,
    0.0265190452337265,
    -0.05612707510590553,
    0.022689053788781166,
    0.03995944559574127,
    -0.08144176751375198,
    -0.02727094292640686,
    0.032777804881334305,
    0.007165075745433569,
    -0.04223404452204704,
    0.0639900416135788,
    0.07307909429073334
  ]
}