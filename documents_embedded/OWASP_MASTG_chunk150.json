{
  "text": "app is using some specific resources. Unlike the entitlements related to app capabilities, device capabilities do not confer any right or accesstoprotectedresources. Additionalconfigurationstepsmightberequiredforthat,whichareveryspecifictoeach capability. Forexample,ifBLEisacorefeatureoftheapp,Apple’sCoreBluetoothProgrammingGuideexplainsthedifferentthings tobeconsidered: • Thebluetooth-ledevicecapabilitycanbesetinordertorestrictnon-BLEcapabledevicesfromdownloadingtheir app. • Appcapabilitieslikebluetooth-peripheralorbluetooth-central(bothUIBackgroundModes)shouldbeaddedif BLEbackgroundprocessingisrequired. However, this is not yet enough for the app to get access to the Bluetooth peripheral, the NSBluetoothPeripher- alUsageDescriptionkeyhastobeincludedintheInfo.plistfile,meaningthattheuserhastoactivelygivepermission. See“PurposeStringsintheInfo.plistFile”belowformoreinformation. Entitlements AccordingtoApple’siOSSecurityGuide: Entitlementsarekeyvaluepairsthataresignedintoanappandallowauthenticationbeyondruntimefactors,like UNIXuserID.Sinceentitlementsaredigitallysigned,theycan’tbechanged. Entitlementsareusedextensivelyby systemappsanddaemonstoperformspecificprivilegedoperationsthatwouldotherwiserequiretheprocesstorun asroot. Thisgreatlyreducesthepotentialforprivilegeescalationbyacompromisedsystemappordaemon. Manyentitlementscanbesetusingthe“Summary”taboftheXcodetargeteditor. Otherentitlementsrequireeditinga target’sentitlementspropertylistfileorareinheritedfromtheiOSprovisioningprofileusedtoruntheapp. EntitlementSources: 1. Entitlementsembeddedinaprovisioningprofilethatisusedtocodesigntheapp,whicharecomposedof: • CapabilitiesdefinedontheXcodeproject’stargetCapabilitiestab,and/or: • EnabledServicesontheapp’sAppIDwhichareconfiguredontheIdentifierssectionoftheCertificates,ID’s andProfileswebsite. • Otherentitlementsthatareinjectedbytheprofilegenerationservice. 2. Entitlementsfromacodesigningentitlementsfile. EntitlementDestinations: 1. Theapp’ssignature. 2. Theapp’sembeddedprovisioningprofile. TheAppleDeveloperDocumentationalsoexplains: • Duringcodesigning,theentitlementscorrespondingtotheapp’senabledCapabilities/Servicesaretransferredto theapp’ssignaturefromtheprovisioningprofileXcodechosetosigntheapp. • Theprovisioningprofileisembeddedintotheappbundleduringthebuild(embedded.mobileprovision). • Entitlements from the “Code Signing Entitlements” section in Xcode’s “Build Settings” tab are transferred to the app’ssignature. Forexample, ifyouwanttosetthe“DefaultDataProtection”capability, youwouldneedtogototheCapabilitiestab in Xcode and enable Data Protection. This is directly written by Xcode to the <appname>.entitlements file as the com.apple.developer.default-data-protection entitlement with default value NSFileProtectionComplete. In the IPAwemightfindthisintheembedded.mobileprovisionas: 444\\n<key>Entitlements</key> <dict> ... <key>com.apple.developer.default-data-protection</key> <string>NSFileProtectionComplete</string> </dict> For other capabilities such as HealthKit, the user has to be asked for permission, therefore it is not enough to add the entitlements,specialkeysandstringshavetobeaddedtotheInfo.plistfileoftheapp. Purpose Strings in the Info.plist File Purposestringsor_usagedescriptionstrings_arecustomtextsthatareofferedtousersinthesystem’spermissionrequest alertwhenrequestingpermissiontoaccessprotecteddataorresources. IflinkingonorafteriOS10,developersarerequiredtoincludepurposestringsintheirapp’sInfo.plistfile. Otherwise, iftheappattemptstoaccessprotecteddataorresourceswithouthavingprovidedthecorrespondingpurposestring,the accesswillfailandtheappmightevencrash. For an overview of the different purpose strings Info.plist keys available see Table 1-2 at the Apple App Programming GuideforiOS.ClickontheprovidedlinkstoseethefulldescriptionofeachkeyintheCocoaKeysreference. Code Signing Entitlements File Certaincapabilitiesrequireacodesigningentitlementsfile(<appname>.entitlements). Itisautomaticallygeneratedby Xcodebutmaybemanuallyeditedand/orextendedbythedeveloperaswell. Here is an example of entitlements file of the open source app Telegram including the App Groups entitlement (application-groups): <?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE plist PUBLIC\"-//Apple//DTDPLIST1.0//EN\"\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"> <plist version=\"1.0\"> <dict> ... <key>com.apple.security.application-groups</key> <array> <string>group.ph.telegra.Telegraph</string> </array> </dict> ... </plist> Theentitlementoutlinedabovedoesnotrequireanyadditionalpermissionsfromtheuser. However,itisalwaysagood practicetocheckallentitlements,astheappmightoverasktheuserintermsofpermissionsandtherebyleakinforma- tion. 445\\nAsdocumentedatAppleDeveloperDocumentation,theAppGroupsentitlementisrequiredtoshareinformationbetween differentappsthroughIPCorasharedfilecontainer,whichmeansthatdatacanbesharedonthedevicedirectlybetween theapps. Thisentitlementisalsorequiredifanappextensionrequirestoshareinformationwithitscontainingapp. Depending on the data to-be-shared it might be more appropriate to share it using another method such as through a backendwherethisdatacouldbepotentiallyverified,avoidingtamperingbye.g.theuserthemselves. Inter-Process Communication (IPC) Duringimplementationofamobileapplication,developersmayapplytraditionaltechniquesforIPC(suchasusingshared filesornetworksockets). TheIPCsystemfunctionalityofferedbymobileapplicationplatformsshouldbeusedbecauseitis muchmorematurethantraditionaltechniques. UsingIPCmechanismswithnosecurityinmindmaycausetheapplication toleakorexposesensitivedata. In contrast to Android’s rich Inter-Process Communication (IPC) capability, iOS offers some rather limited options for communicationbetweenapps. Infact, there’snowayforappstocommunicatedirectly. Inthissectionwewillpresent thedifferenttypesofindirectcommunicationofferedbyiOSandhowtotestthem. Here’sanoverview: • CustomURLSchemes • UniversalLinks • UIActivitySharing • AppExtensions • UIPasteboard Custom URL Schemes CustomURLschemesallowappstocommunicateviaacustomprotocol. Anappmustdeclaresupportfortheschemes andhandleincomingURLsthatusethoseschemes. ApplewarnsabouttheimproperuseofcustomURLschemesintheAppleDeveloperDocumentation: URLschemesofferapotentialattackvectorintoyourapp,somakesuretovalidateallURLparametersanddiscard anymalformedURLs. Inaddition,limittheavailableactionstothosethatdonotrisktheuser’sdata. Forexample, donotallowotherappstodirectlydeletecontentoraccesssensitiveinformationabouttheuser. Whentestingyour URL-handlingcode,makesureyourtestcasesincludeimproperlyformattedURLs. Theyalsosuggestusinguniversallinksinstead,ifthepurposeistoimplementdeeplinking: WhilecustomURLschemesareanacceptableformofdeeplinking,universallinksarestronglyrecommendedasa bestpractice. SupportingacustomURLschemeisdoneby: • definingtheformatfortheapp’sURLs, • registeringtheschemesothatthesystemdirectsappropriateURLstotheapp, • handlingtheURLsthattheappreceives. SecurityissuesarisewhenanappprocessescallstoitsURLschemewithoutproperlyvalidatingtheURLanditsparameters andwhenusersaren’tpromptedforconfirmationbeforetriggeringanimportantaction. OneexampleisthefollowingbugintheSkypeMobileapp, discoveredin2010: TheSkypeappregisteredtheskype:/ / protocol handler, which allowed other apps to trigger calls to other Skype users and phone numbers. Unfortunately, Skypedidn’taskusersforpermissionbeforeplacingthecalls,soanyappcouldcallarbitrarynumberswithouttheuser’s knowledge. Attackersexploitedthisvulnerabilitybyputtinganinvisible<iframe src=\"skype://xxx?call\"></iframe> (wherexxxwasreplacedbyapremiumnumber),soanySkypeuserwhoinadvertentlyvisitedamaliciouswebsitecalled thepremiumnumber. As a developer, you should carefully validate any URL before calling it. You can allow only certain applications which maybeopenedviatheregisteredprotocolhandler. PromptinguserstoconfirmtheURL-invokedactionisanotherhelpful control. AllURLsarepassedtotheappdelegate,eitheratlaunchtimeorwhiletheappisrunningorinthebackground. Tohandle incomingURLs,thedelegateshouldimplementmethodsto: 446\\n• retrieveinformationabouttheURLanddecidewhetheryouwanttoopenit, • opentheresourcespecifiedbytheURL. MoreinformationcanbefoundinthearchivedAppProgrammingGuideforiOSandintheAppleSecureCodingGuide. Inaddition,anappmayalsowanttosendURLrequests(aka. queries)tootherapps. Thisisdoneby: • registeringtheapplicationqueryschemesthattheappwantstoquery, • optionallyqueryingotherappstoknowiftheycanopenacertainURL, • sendingtheURLrequests. Universal Links UniversallinksaretheiOSequivalenttoAndroidAppLinks(aka. DigitalAssetLinks)andareusedfordeeplinking. When tappingauniversallink(totheapp’swebsite),theuserwillseamlesslyberedirectedtothecorrespondinginstalledapp withoutgoingthroughSafari. Iftheappisn’tinstalled,thelinkwillopeninSafari. Universallinksarestandardweblinks(HTTP/HTTPS)andarenottobeconfusedwithcustomURLschemes,whichoriginally werealsousedfordeeplinking. Forexample,theTelegramappsupportsbothcustomURLschemesanduniversallinks: • tg://resolve?domain=fridadotreisacustomURLschemeandusesthetg://scheme. • https://telegram.me/fridadotreisauniversallinkandusesthehttps://scheme. Both result in the same action, the user will be redirected to the specified chat in Telegram (“fridadotre” in this case). However,universallinksgiveseveralkeybenefitsthatarenotapplicablewhenusingcustomURLschemesandarethe recommendedwaytoimplementdeeplinking,accordingtotheAppleDeveloperDocumentation. Specifically,universal linksare: • Unique: UnlikecustomURLschemes,universallinkscan’tbeclaimedbyotherapps,becausetheyusestandard HTTPorHTTPSlinkstotheapp’swebsite. TheywereintroducedasawaytopreventURLschemehijackingattacks (anappinstalledaftertheoriginalappmaydeclarethesameschemeandthesystemmighttargetallnewrequests tothelastinstalledapp). • Secure: Whenusersinstalltheapp,iOSdownloadsandchecksafile(theAppleAppSiteAssociationorAASA)that wasuploadedtothewebservertomakesurethatthewebsiteallowstheapptoopenURLsonitsbehalf. Onlythe legitimateownersoftheURLcanuploadthisfile,sotheassociationoftheirwebsitewiththeappissecure. • Flexible: Universal links work even when the app is not installed. Tapping a link to the website would open the contentinSafari,asusersexpect. • Simple: OneURLworksforboththewebsiteandtheapp. • Private: Otherappscancommunicatewiththeappwithoutneedingtoknowwhetheritisinstalled. YoucanlearnmoreaboutUniversalLinksinthepost“LearningaboutUniversalLinksandFuzzingURLSchemesoniOS withFrida”byCarlosHolguera. UIActivity Sharing StartingoniOS6itispossibleforthird-partyappstosharedata(items)viaspecificmechanismslikeAirDrop,forexample. Fromauserperspective,thisfeatureisthewell-knownsystem-wide“ShareActivitySheet”thatappearsafterclickingon the“Share”button. 447\\nTheavailablebuilt-insharingmechanisms(aka. ActivityTypes)include: • airDrop • assignToContact • copyToPasteboard • mail • message",
  "metadata": {
    "doc_id": "OWASP_MASTG",
    "chunk_id": 150
  },
  "embedding": [
    0.018796773627400398,
    -0.04401138797402382,
    -0.012490341439843178,
    -0.055745597928762436,
    0.02720073238015175,
    0.028910161927342415,
    -0.007825805805623531,
    0.0493592843413353,
    -0.08473769575357437,
    0.03817850351333618,
    0.022109517827630043,
    -0.001597289927303791,
    0.04236388951539993,
    0.008945410139858723,
    0.03728032857179642,
    0.03015095926821232,
    0.12568725645542145,
    -0.04292028397321701,
    -0.0930391326546669,
    0.009434593841433525,
    0.032395701855421066,
    0.02805468812584877,
    0.048625487834215164,
    0.05904679745435715,
    0.02810884267091751,
    -0.07796502113342285,
    -0.05751839280128479,
    -0.00076916569378227,
    0.02855081297457218,
    0.06851872056722641,
    -0.02363809570670128,
    -0.0008239683811552823,
    0.072502002120018,
    0.006325275171548128,
    0.01380388718098402,
    -0.03216022625565529,
    0.023166565224528313,
    -0.03379354253411293,
    -0.08507902920246124,
    -0.05738488584756851,
    -0.0556061714887619,
    0.021098783239722252,
    -0.07894859462976456,
    0.08381982892751694,
    0.0005815632175654173,
    0.011296993121504784,
    -0.014852849766612053,
    0.026423605158925056,
    -0.03539092093706131,
    0.023681189864873886,
    0.07491032779216766,
    0.06883542984724045,
    0.052638307213783264,
    0.07519875466823578,
    -0.044929392635822296,
    0.0746510922908783,
    -0.01903594844043255,
    0.04509872943162918,
    0.10749991238117218,
    0.07153302431106567,
    0.0023711146786808968,
    -0.01034602615982294,
    0.003596222959458828,
    -0.08002349734306335,
    0.007785925175994635,
    -0.014842953532934189,
    -0.02559134177863598,
    -0.04567643627524376,
    -0.06642480194568634,
    -0.07849405705928802,
    0.028316980227828026,
    -0.0183259304612875,
    0.06756392121315002,
    -0.05937037989497185,
    0.09358132630586624,
    0.05525049939751625,
    0.017504962161183357,
    0.017049748450517654,
    -0.04982411861419678,
    -0.17619821429252625,
    0.007474368903785944,
    0.013261324726045132,
    0.033687084913253784,
    0.1026725023984909,
    -0.03471382334828377,
    0.0073799570091068745,
    -0.03746112808585167,
    -0.005714805796742439,
    -0.034901611506938934,
    0.06161854788661003,
    0.020100479945540428,
    0.008962998166680336,
    -0.06833046674728394,
    -0.08778707683086395,
    0.020403819158673286,
    -0.052593331784009933,
    -0.034321777522563934,
    -0.06692642718553543,
    -0.054533809423446655,
    -0.020154936239123344,
    -0.03655671700835228,
    -0.04782148823142052,
    -0.028051789849996567,
    -0.009160849265754223,
    0.023308096453547478,
    -0.06743597984313965,
    0.023072153329849243,
    -0.0008080937550403178,
    0.09721214324235916,
    0.03969626501202583,
    0.10977991670370102,
    -0.06213737279176712,
    0.062228549271821976,
    0.019737089052796364,
    0.02988424152135849,
    0.08193608373403549,
    -0.11118699610233307,
    0.05403323471546173,
    0.07558780908584595,
    -0.03673316538333893,
    0.012418157421052456,
    0.018454698845744133,
    0.0624486580491066,
    -0.10022854804992676,
    -0.040919579565525055,
    -0.04124286025762558,
    -0.03399747237563133,
    1.789857657071925e-32,
    0.0008456407813355327,
    0.006544290576130152,
    0.02465827576816082,
    0.014743627049028873,
    -0.08316608518362045,
    -0.09751906991004944,
    0.011201434768736362,
    0.08021822571754456,
    -0.0428081676363945,
    -0.07384735345840454,
    -0.020717857405543327,
    0.08570926636457443,
    -0.023571588099002838,
    -0.04945814609527588,
    0.026328060775995255,
    0.013079669326543808,
    0.002787776989862323,
    0.05845018848776817,
    0.011502353474497795,
    0.0997733399271965,
    -0.004993862938135862,
    -0.048240527510643005,
    -0.00975068286061287,
    -0.001032309839501977,
    0.027875816449522972,
    -0.013481362722814083,
    0.004268726799637079,
    0.03036188893020153,
    0.07039123773574829,
    0.036165282130241394,
    -0.0012707345886155963,
    0.09864719957113266,
    -0.06718093156814575,
    -0.09290191531181335,
    0.015232366509735584,
    -0.08101164549589157,
    0.0144942756742239,
    -0.03447965160012245,
    -0.05928851664066315,
    -0.05972684174776077,
    -0.05550583079457283,
    -0.03477291017770767,
    -0.07980106770992279,
    -0.017976893112063408,
    -0.03885394334793091,
    -0.062369637191295624,
    0.020455455407500267,
    -0.06357390433549881,
    -0.014856817200779915,
    0.08436902612447739,
    -0.07741473615169525,
    0.01908092573285103,
    0.04586581140756607,
    -0.13887101411819458,
    0.006834209430962801,
    -0.054466746747493744,
    -0.025114096701145172,
    0.009427555836737156,
    0.05575082451105118,
    -0.008397574536502361,
    0.05969718471169472,
    0.01483299769461155,
    0.0046630180440843105,
    -0.027998901903629303,
    0.0215127132833004,
    0.04267290234565735,
    0.013419898226857185,
    -0.05428636819124222,
    -0.06630150973796844,
    -0.0640747919678688,
    -0.06695452332496643,
    0.04256618395447731,
    0.036616742610931396,
    -0.013315649703145027,
    -0.06686145067214966,
    -0.0049502234905958176,
    0.05866159498691559,
    0.054821379482746124,
    -0.08818502724170685,
    -0.07209932804107666,
    -0.007318446412682533,
    0.020046891644597054,
    0.07008330523967743,
    0.017793431878089905,
    -0.021784983575344086,
    -0.024088868871331215,
    -0.03541369363665581,
    -0.10585884004831314,
    -0.048556435853242874,
    0.04972625523805618,
    -0.021217236295342445,
    -0.01973838172852993,
    -0.07144369184970856,
    0.015807749703526497,
    -0.09646943211555481,
    -1.65388705001796e-32,
    0.015873445197939873,
    -0.049652379006147385,
    -0.12319675832986832,
    -0.053850557655096054,
    0.03926294296979904,
    -0.06535324454307556,
    -0.029826749116182327,
    0.004482096526771784,
    0.02186189964413643,
    0.004808444529771805,
    0.013937563635408878,
    0.004701252095401287,
    -0.010505979880690575,
    -0.030216483399271965,
    -0.0024933454114943743,
    0.02234928496181965,
    0.011302037164568901,
    -0.028649302199482918,
    -0.011984685435891151,
    0.07963275909423828,
    -0.019292794167995453,
    0.013696607202291489,
    0.1014026328921318,
    -0.01720578409731388,
    -0.019457979127764702,
    -0.0008188016363419592,
    -0.03262747451663017,
    0.03817661851644516,
    -0.008431026712059975,
    -0.07339971512556076,
    0.06057274341583252,
    -0.0016426374204456806,
    -0.09172480553388596,
    -0.04713611304759979,
    -0.007195383310317993,
    -0.03568580746650696,
    -0.12344768643379211,
    -0.039796266704797745,
    -0.040020838379859924,
    0.04281003028154373,
    0.07339417189359665,
    0.04646550863981247,
    -0.0010031632846221328,
    -0.06636469066143036,
    0.02647322602570057,
    -0.013817164115607738,
    0.03506933152675629,
    -0.027858074754476547,
    0.02416292577981949,
    -0.003849331522360444,
    0.12297989428043365,
    0.03965770825743675,
    0.026057016104459763,
    0.06813488900661469,
    0.013422543182969093,
    0.07028838247060776,
    0.12596404552459717,
    0.026258079335093498,
    0.013220451772212982,
    -0.019299888983368874,
    0.12409097701311111,
    -0.01227362360805273,
    -0.01932685263454914,
    0.04208434745669365,
    0.023500215262174606,
    0.04747268185019493,
    0.02994396723806858,
    -0.0009336320799775422,
    0.013004785403609276,
    0.10396455973386765,
    -0.04291949048638344,
    -0.11730916053056717,
    0.09320913255214691,
    -0.01257486455142498,
    -0.03630505129694939,
    0.09886634349822998,
    -0.008565685711801052,
    -0.097191721200943,
    -0.11335054785013199,
    -0.026065964251756668,
    -0.024001937359571457,
    0.03994976729154587,
    0.02995981089770794,
    0.023226307705044746,
    0.06234441697597504,
    -0.01656474731862545,
    -0.010876568034291267,
    -0.02147970348596573,
    0.04456932470202446,
    0.013931590132415295,
    -0.030165009200572968,
    -0.02228524163365364,
    -0.0035206277389079332,
    0.07034868746995926,
    -0.05996457859873772,
    -6.325228696368868e-08,
    0.037441324442625046,
    0.03515325114130974,
    -0.02094157412648201,
    -0.024883780628442764,
    0.0200299471616745,
    -0.030970724299550056,
    0.04419993609189987,
    -0.0574958510696888,
    0.05680358409881592,
    0.01749320887029171,
    -0.07154813408851624,
    -0.0839928388595581,
    -0.09120936691761017,
    -0.001797615783289075,
    0.050509244203567505,
    -0.005963279400020838,
    0.010721524246037006,
    -0.038929786533117294,
    -0.014161713421344757,
    0.0038939930964261293,
    -0.05910154804587364,
    -0.07307268679141998,
    -0.028954174369573593,
    0.023640720173716545,
    0.03846531733870506,
    -0.026761364191770554,
    -0.008384770713746548,
    -0.06419175118207932,
    0.06042218953371048,
    0.0029273040127009153,
    0.02507457323372364,
    0.02460312470793724,
    0.048486363142728806,
    -0.029605228453874588,
    -0.04304412379860878,
    0.05754285678267479,
    -0.0631728395819664,
    0.09177566319704056,
    0.018105357885360718,
    0.020697707310318947,
    -0.0117730014026165,
    0.011442306451499462,
    0.00020953803323209286,
    0.03176691010594368,
    0.03196035325527191,
    -0.021189089864492416,
    0.007283075712621212,
    0.055766232311725616,
    0.02586868777871132,
    0.02898210845887661,
    -0.06448626518249512,
    -0.04015191271901131,
    -0.010843159630894661,
    -0.02642783150076866,
    0.07630960643291473,
    0.014902533032000065,
    0.030227717012166977,
    -0.06336542963981628,
    0.011407947167754173,
    0.002391632180660963,
    0.054371628910303116,
    -0.0008745755185373127,
    0.017221499234437943,
    0.03301062434911728
  ]
}