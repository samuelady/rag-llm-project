{"text": "An attacker may be able to use this to guess passwords and gain a foothold within the internal environment. If external services are set up with Active Directory authentication (such as VPN, Security Impact email, or remote application services) an attacker may be able to perform a targeted password spray to gain internal network access from an anonymous position on the internet.  INLANEFREIGHT.LOCAL Affected Domain See Appendix E – INLANEFREIGHT.LOCAL Domain Password Review for a detailed domain password analysis. Review the password policy and enforce a 12-character minimum password. Consider implementing an enterprise password manager to encourage the use of strong, randomized, Remediation passwords. Implement a password filter to restrict the use of common words such as variations on the words “welcome” and “password”, seasons, months, and variations on the company name. External References https://attack.mitre.org/mitigations/M1027/ Finding Evidence: Performing a password spraying attack against all domain users with the Kerbrute tool and finding two valid passwords. $ $kerbrute passwordspray --dc 192.168.195.204 -d INLANEFREIGHT.LOCAL domain_users.txt <PASSWORD REDACTED> __ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\ / ,< / __/ / / /_/ / / / /_/ / /_/ __/ /_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) - 05/31/22 - Ronnie Flathers @ropnop 2022/05/31 15:55:24 > Using KDC(s): 2022/05/31 15:55:24 > 192.168.195.204:88 2022/05/31 15:55:24 > [+] VALID LOGIN: pramirez@INLANEFREIGHT.LOCAL:<PASSWORD REDACTED> 2022/05/31 15:55:24 > [+] VALID LOGIN: asmith@INLANEFREIGHT.LOCAL:<PASSWORD REDACTED> 2022/05/31 15:55:24 > Done! Tested 1,974 logins (2 successes) in 0.161 seconds Figure 23: Password Spraying – Kerbrute Tool 23\\n5. Tomcat Manager Weak/Default Credentials - High CWE CWE-521 CVSS 3.1 Score 9.5 Description (Incl. Root An Apache Tomcat Server was found that was exposing the Tomcat Manager login URL and Cause) using weak/default credentials to enter the Manager (admin) backend. An attacker who gains access to the Tomcat Manager area can upload a malicious application via a WAR file containing custom JSP code. This code can be used to run arbitrary commands on the underlying server in the context of the service account that the Apache Tomcat instance Security Impact runs under. This Tomcat instance was running under a local service account assigned privileges that can be leveraged to escalate to the all-powerful NT AUTHORITY\\SYSTEM account and gain complete control over the server, potentially gaining access to credentials and other sensitive data. Affected Host(s)  192.168.195.205 (8080/TCP)  Restrict access to the Tomcat Manager URL to either localhost or only select IP addresses if this URL does need to be accessed remotely by administrators.  Change the default administrator account name to something unique and set a strong, Remediation randomized password that does not appear in any wordlists as the Tomcat Manager page uses Basic Authentication, which has no inherent protections against password brute-forcing attacks. External References https://attack.mitre.org/techniques/T1078/001/ Finding Evidence: Setting up the Metasploit auxiliary scanner to brute-force Tomcat manager usernames and passwords. msf6 > use auxiliary/scanner/http/tomcat_mgr_login msf6 auxiliary(scanner/http/tomcat_mgr_login) > set rhosts 192.168.195.205 msf6 auxiliary(scanner/http/tomcat_mgr_login) > set STOP_ON_SUCCESS true", "metadata": {"doc_id": "Hack the Box - sample-penetration-testing-report-template", "chunk_id": 12}}