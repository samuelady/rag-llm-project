{"text": "! ! ! ! ! ! Figure 3 192.168.1.75 Number of Risks ! ! ! Unsecure service (Telnet) is running: ! Threat Level ! \"#$!%&'(#)*)&'+!,!-./0!.-12!1.03!0045!.567!5895!.467!:;83!-/;0!383;! Medium Vulnerability Medium Analysis Telnet provides access to the server for remote administration as an example. Unfortunately telnet traffic is not encrypted. Suspicious users i.e. attacker with and easy accessible sniffer can sniff the traffic, which may include sensitive data and/or administrator credentials. By Telneting to 192.168.1.75, we were able to see telnet service version number 5.00 )*+,%\"&(!.$*&/01(2$*&/0342*0.-5%2( ( ( @ 2021 SANS Institute Author Retains Full Rights\\n! ! (A&0#0+4(*(M:+:#&*#0%+(C:,#0+4(N:<%&# >S( ! ( ! ! ! ! Figure 4 Telnet Service Banner ! ! Impact ! ! High ! Risk Rating ! ! Low ! Recommendation ! ! If deemed necessary for this server to be administered remotely, utilize secure ! administration tools such as SSH or Secure remote desktop access. ! ! ! Microsoft RPC Interface Buffer Overrun: ! C$0,(0,(I\",#(J%&(6:2%+,#&*#0%+(<\"&<%,:(0J(#$:(<:+` Threat Level ! #:,#:&(D%\".6(.0B:(#%(\"<.%*6(*+H(#%%.(0+(#$:(#*&4:#( ! High ,H,#:21(*(&\".:(%J(:+4*4:2:+#(,$%\".6(0+5.\"6:(,\"5$(*( ! ,#*#:2:+#a(C$:(#%%.,(2\",#(/:(&:2%7:6(*J#:&(#$:(#:,#-( Vulnerability ! ! Critical \"#$!%&'(#)*)&'+!,!-./0!.-12!1.03!0045!.567!5895!.467!:;83!-/;0!383;! Analysis The remote host is running a version of Windows, which has a flaw in its RPC interface, which may allow an attacker to execute arbitrary code and gain SYSTEM privileges. An attacker or a worm could use it to gain the control of this host. We exploit this vulnerability utilizing a ready exploit available in the internet. Figure 5 Exploiting RPC using dcom After exploiting this vulnerability we got a shell and as you can see the IP address is the server IP address. )*+,%\"&(!.$*&/01(2$*&/0342*0.-5%2( ( ( @ 2021 SANS Institute Author Retains Full Rights\\n! ! (A&0#0+4(*(M:+:#&*#0%+(C:,#0+4(N:<%&# >T( ! ( ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! Figure 6 Getting Shell Access ! ! We also utilize this vulnerability to upload and download file through meterpreter as ! ! described below: \"#$!%&'(#)*)&'+!,!-./0!.-12!1.03!0045!.567!5895!.467!:;83!-/;0!383;! Figure 7 Exploiting dcom - metasploit )*+,%\"&(!.$*&/01(2$*&/0342*0.-5%2( ( ( @ 2021 SANS Institute Author Retains Full Rights\\n! ! (A&0#0+4(*(M:+:#&*#0%+(C:,#0+4(N:<%&# O?( ! ( ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! \"#$!%&'(#)*)&'+!,!-./0!.-12!1.03!0045!.567!5895!.467!:;83!-/;0!383;! Figure 8 Uploading nc.exe as backdoor We uploaded a tool for further testing )*+,%\"&(!.$*&/01(2$*&/0342*0.-5%2( ( ( @ 2021 SANS Institute Author Retains Full Rights\\n! ! (A&0#0+4(*(M:+:#&*#0%+(C:,#0+4(N:<%&# O@( ! ( ! We opened a command shell using meterpreter and ran nc.exe to listen on port ! ! 2222/TCP: ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! ! \"#$!%&'(#)*)&'+!,!-./0!.-12!1.03!0045!.567!5895!.467!:;83!-/;0!383;! Figure 9 Shell command and running nc And downloading SAM file for cracking the system passwords offline: Figure 10 Downloading SAM file Impact Critical )*+,%\"&(!.$*&/01(2$*&/0342*0.-5%2( ( ( @ 2021 SANS Institute Author Retains Full Rights\\n! ! (A&0#0+4(*(M:+:#&*#0%+(C:,#0+4(N:<%&# O>( ! ( ! Risk Rating ! ! Critical ! Recommendation ! ! Patch the system with latest patches from MS. ! http://www.microsoft.com/technet/security/bulletin/MS03-039.mspx ! ! ! 4. References ! ! !", "metadata": {"doc_id": "SANS Institute - Writing a Penetration Testing", "chunk_id": 13}}