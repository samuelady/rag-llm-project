{"text": "The remote Windows host is affected by a remote code execution vulnerability due to improper processing of packets by the SecureChannel (Schannel) security package. An attacker can exploit this issue by sending specially crafted packets to a Windows server. Note that this plugin sends a client Certificate TLS handshake message followed by a CertificateVerify message. Some Windows hosts will close the connection upon receiving a client certificate for which it did not ask for with a CertificateRequest message. In this case, the plugin cannot proceed to detect the vulnerability as the CertificateVerify message cannot be sent. EXPLOIT: The exploit for this vulnerability is a remote code execution that typically results in a sales@purplesec.us 15\\nJANUARY 1, 2020 Denial of Service (DoS) Attack. Due to the nature of the testing, this exploit is out of scope for the exercise. Outsider Risk Rating: Insider Risk Rating: EXTREME Bottom Line: Nearly all CLIENT’s internal networks hosts appear to be properly patched and up-to- date. Attack vectors are available to an adversary who targeted CLIENT. Considering CLIENT’s lack of IT personnel or Security Engineer, an attacker could find success through Social Engineering or Physical attack methods due to the lack of training and resources found during this penetration testing. Recommendations: • Disable SMB on all systems where it is not required for business purposes. The service may be shut down via GPO on the domain, or through manual service disabling on local admin accounts. • Disable spoolsvc.exe and other non-essential processes on Critical Security Infrastructure such as the McAfee Security Server. Processes running increase the attack surface of the systems. Disabling these services can help harden the systems and create a smaller, more secure risk landscape. • Disable SSLv2 and SSLv3 on any system where legacy encryption is not necessary. Most applications use better encryption built-in but use SSL as a fallback option when needed for legacy support. (Remainder of page left intentionally blank) sales@purplesec.us 16\\nJANUARY 1, 2020 4.0 External Phase 4.1 Phase Summary The external phase of the pentest focused on the assets which are publicly accessible. Reconnaissance and scanning were conducted to identify opportunities for intrusion or malicious modification of the systems. Attacks were launched from PurpleSec network via Internet to the externally accessible assets at CLIENT using BurpSuite and network scanner NMAP. 4.2 Actions Taken To determine the risk level of CLIENT’s externally accessible hosts and servers, the analyst conducted internet-level scanning and analysis. From Zone: Internet Via: N/A To Zone: External Network Method: Internet penetration testing Current Zone Activities: xxx.xxx.93.188 The server’s certificate is not valid for the hostname. Cert is issued to wwcaws.keixna mplecom, wwcwas.ekxina mple.com, but you can reach the https certificate through this IP address. The hostname is technically not covered by the cert. HSTS is not enforced The application fails to prevent users from connecting to it over unencrypted connections. This opens the possibility of man-in-the-middle attacks performed on the site by users who visit unencrypted links. To remedy this, add a response header with the name", "metadata": {"doc_id": "PurpleSec - Sample-Penetration-Test-Report", "chunk_id": 4}}