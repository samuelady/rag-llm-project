{"text": "prevalenttypesofattack,suchasdisclosureofdataintransit,authenticationandauthorizationissues,andservercon- figurationerrors. 31\\nAvoiding False Positives Automated Scanning Tools Automatedtestingtools’lackofsensitivitytoappcontextisachallenge. Thesetoolsmayidentifyapotentialissuethat’s irrelevant. Suchresultsarecalled“falsepositives”. Forexample, securitytesterscommonlyreportvulnerabilitiesthatareexploitableinawebbrowserbutaren’trelevant to the mobile app. This false positive occurs because automated tools used to scan the backend service are based on regular browser-based web apps. Issues such as CSRF (Cross-site Request Forgery) and Cross-Site Scripting (XSS) are reportedaccordingly. Let’stakeCSRFasanexample. AsuccessfulCSRFattackrequiresthefollowing: • Theabilitytoenticethelogged-inusertoopenamaliciouslinkinthewebbrowserusedtoaccessthevulnerable site. • Theclient(browser)mustautomaticallyaddthesessioncookieorotherauthenticationtokentotherequest. Mobile apps don’t fulfill these requirements: even if WebViews and cookie-based session management are used, any maliciouslinktheuserclicksopensinthedefaultbrowser,whichhasaseparatecookiestore. Stored Cross-Site Scripting (XSS) can be an issue if the app includes WebViews, and it may even lead to command executioniftheappexportsJavaScriptinterfaces. However,reflectedCross-SiteScriptingisrarelyanissueforthereason mentionedabove(eventhoughwhethertheyshouldexistatallisarguable,escapingoutputissimplyabestpractice). In any case, consider exploit scenarios when you perform the risk assessment; don’t blindly trust your scanning tool’soutput. Penetration Testing (a.k.a. Pentesting) Theclassicapproachinvolvesall-aroundsecuritytestingoftheapp’sfinalornear-finalbuild,e.g.,thebuildthat’savailable attheendofthedevelopmentprocess. Fortestingattheendofthedevelopmentprocess, werecommendtheMobile AppSecurityVerificationStandard(MASVS)andtheassociatedchecklistasbaselinefortesting. Atypicalsecuritytestis structuredasfollows: • Preparation-definingthescopeofsecuritytesting,includingidentifyingapplicablesecuritycontrols,theorgani- zation’stestinggoals,andsensitivedata. Moregenerally,preparationincludesallsynchronizationwiththeclient aswellaslegallyprotectingthetester(whoisoftenathirdparty). Remember,attackingasystemwithoutwritten authorizationisillegalinmanypartsoftheworld! • IntelligenceGathering-analyzingtheenvironmentalandarchitecturalcontextoftheapptogainageneral contextualunderstanding. • MappingtheApplication-basedoninformationfromthepreviousphases;maybecomplementedbyautomated scanningandmanuallyexploringtheapp. Mappingprovidesathoroughunderstandingoftheapp,itsentrypoints, the data it holds, and the main potential vulnerabilities. These vulnerabilities can then be ranked according to thedamagetheirexploitationwouldcausesothatthesecuritytestercanprioritizethem. Thisphaseincludesthe creationoftestcasesthatmaybeusedduringtestexecution. • Exploitation-inthisphase,thesecuritytestertriestopenetratetheappbyexploitingthevulnerabilitiesidenti- fiedduringthepreviousphase. Thisphaseisnecessaryfordeterminingwhethervulnerabilitiesarerealandtrue positives. • Reporting - in this phase, which is essential to the client, the security tester reports the vulnerabilities. This includes the exploitation process in detail, classifies the type of vulnerability, documents the risk if an attacker wouldbeabletocompromisethetargetandoutlineswhichdatathetesterhasbeenabletoaccessillegitimately. Preparation Thesecuritylevelatwhichtheappwillbetestedmustbedecidedbeforetesting. Thesecurityrequirementsshouldbe decidedatthebeginningoftheproject. Differentorganizationshavedifferentsecurityneedsandresourcesavailablefor investingintestactivities. AlthoughthecontrolsinMASVSLevel1(L1)areapplicabletoallmobileapps,walkingthrough theentirechecklistofL1andLevel2(L2)MASVScontrolswithtechnicalandbusinessstakeholdersisagoodwaytodecide onaleveloftestcoverage. 32\\nOrganizations may have different regulatory and legal obligations in certain territories. Even if an app doesn’t handle sensitivedata,someL2requirementsmayberelevant(becauseofindustryregulationsorlocallaws). Forexample,two- factorauthentication(2FA)maybeobligatoryforafinancialappandenforcedbyacountry’scentralbankand/orfinancial regulatoryauthorities. Securitygoals/controlsdefinedearlierinthedevelopmentprocessmayalsobereviewedduringthediscussionwithstake- holders. SomecontrolsmayconformtoMASVScontrols,butothersmaybespecifictotheorganizationorapp. Allinvolvedpartiesmustagreeonthedecisionsandthescopeinthechecklistbecausethesewilldefinethebaselinefor allsecuritytesting. Coordinating with the Client Settingupaworkingtestenvironmentcanbeachallengingtask. Forexample,restrictionsontheenterprisewirelessac- cesspointsandnetworksmayimpededynamicanalysisperformedatclientpremises. Companypoliciesmayprohibitthe useofrootedphonesor(hardwareandsoftware)networktestingtoolswithinenterprisenetworks. Appsthatimplement rootdetectionandotherreverseengineeringcountermeasuresmaysignificantlyincreasetheworkrequiredforfurther analysis. Security testing involves many invasive tasks, including monitoring and manipulating the mobile app’s network traffic, inspectingtheappdatafiles,andinstrumentingAPIcalls. Securitycontrols,suchascertificatepinningandrootdetection, mayimpedethesetasksanddramaticallyslowtestingdown. Toovercometheseobstacles,youmaywanttorequesttwooftheapp’sbuildvariantsfromthedevelopmentteam. One variantshouldbeareleasebuildsothatyoucandeterminewhethertheimplementedcontrolsareworkingproperlyand can’t be bypassed easily. The second variant should be a debug build for which certain security controls have been deactivated. Testingtwodifferentbuildsisthemostefficientwaytocoveralltestcases. Dependingonthescopeoftheengagement,thisapproachmaynotbepossible. Requestingbothproductionanddebug buildsforawhite-boxtestwillhelpyoucompletealltestcasesandclearlystatetheapp’ssecuritymaturity. Theclientmay preferthatblack-boxtestsbefocusedontheproductionappandtheevaluationofitssecuritycontrols’effectiveness. Thescopeofbothtypesoftestingshouldbediscussedduringthepreparationphase. Forexample,whetherthesecurity controlsshouldbeadjustedshouldbedecidedbeforetesting. Additionaltopicsarediscussedbelow. Identifying Sensitive Data Classifications of sensitive information differ by industry and country. In addition, organizations may take a restrictive viewofsensitivedata,andtheymayhaveadataclassificationpolicythatclearlydefinessensitiveinformation. Therearethreegeneralstatesfromwhichdatamaybeaccessible: • Atrest-thedataissittinginafileordatastore • Inuse-anapphasloadedthedataintoitsaddressspace • In transit-datahasbeenexchangedbetweenmobileappandendpointorconsumingprocessesonthedevice, e.g.,duringIPC(Inter-ProcessCommunication) The degree of scrutiny that’s appropriate for each state may depend on the data’s importance and likelihood of being accessed. Forexample,dataheldinappmemorymaybemorevulnerablethandataonwebserverstoaccessviacore dumpsbecauseattackersaremorelikelytogainphysicalaccesstomobiledevicesthantowebservers. Whennodataclassificationpolicyisavailable,usethefollowinglistofinformationthat’sgenerallyconsideredsensitive: • userauthenticationinformation(credentials,PINs,etc.) • PersonallyIdentifiableInformation(PII)thatcanbeabusedforidentitytheft: socialsecuritynumbers,creditcard numbers,bankaccountnumbers,healthinformation • deviceidentifiersthatmayidentifyaperson • highlysensitivedatawhosecompromisewouldleadtoreputationalharmand/orfinancialcosts • anydatawhoseprotectionisalegalobligation • anytechnicaldatageneratedbytheapp(oritsrelatedsystems)andusedtoprotectotherdataorthesystemitself (e.g.,encryptionkeys) Adefinitionof“sensitivedata”mustbedecidedbeforetestingbeginsbecausedetectingsensitivedataleakagewithout adefinitionmaybeimpossible. 33\\nIntelligence Gathering Intelligencegatheringinvolvesthecollectionofinformationabouttheapp’sarchitecture,thebusinessusecasestheapp serves,andthecontextinwhichtheappoperates. Suchinformationmaybeclassifiedas“environmental”or“architec- tural”. Environmental Information Environmentalinformationincludes: • The organization’s goals for the app. Functionality shapes users’ interaction with the app and may make some surfacesmorelikelythanotherstobetargetedbyattackers. • Therelevantindustry. Differentindustriesmayhavedifferentriskprofiles. • Stakeholdersandinvestors;understandingwhoisinterestedinandresponsiblefortheapp. • Internal processes, workflows, and organizational structures. Organization-specific internal processes and work- flowsmaycreateopportunitiesforbusinesslogicvulnerabilities. Architectural Information Architecturalinformationincludes: • Themobileapp: Howtheappaccessesdataandmanagesitin-process,howitcommunicateswithotherresources andmanagesusersessions,andwhetheritdetectsitselfrunningonjailbrokenorrootedphonesandreactstothese situations. • TheOperatingSystem: TheoperatingsystemsandOSversionstheapprunson(includingAndroidoriOSversion restrictions),whethertheappisexpectedtorunondevicesthathaveMobileDeviceManagement(MDM)controls, andrelevantOSvulnerabilities. • Network: Usageofsecuretransportprotocols(e.g.,TLS),usageofstrongkeysandcryptographicalgorithms(e.g., SHA-2)tosecurenetworktrafficencryption,usageofcertificatepinningtoverifytheendpoint,etc. • Remote Services: Theremoteservicestheappconsumesandwhethertheirbeingcompromisedcouldcompro- misetheclient. Mapping the Application Oncethesecuritytesterhasinformationabouttheappanditscontext,thenextstepismappingtheapp’sstructureand content,e.g.,identifyingitsentrypoints,features,anddata. Whenpenetrationtestingisperformedinawhite-boxorgrey-boxparadigm,anydocumentsfromtheinterioroftheproject (architecturediagrams,functionalspecifications,code,etc.) maygreatlyfacilitatetheprocess. Ifsourcecodeisavailable, theuseofSASTtoolscanrevealvaluableinformationaboutvulnerabilities(e.g.,SQLInjection). DASTtoolsmaysupport black-boxtestingandautomaticallyscantheapp: whereasatesterwillneedhoursordays,ascannermayperformthe same task in a few minutes. However, it’s important to remember that automatic tools have limitations and will only find what they have been programmed to find. Therefore, human analysis may be necessary to augment results from automatictools(intuitionisoftenkeytosecuritytesting). Threat Modeling is an important artifact: documents from the workshop usually", "metadata": {"doc_id": "OWASP_MASTG", "chunk_id": 37}}