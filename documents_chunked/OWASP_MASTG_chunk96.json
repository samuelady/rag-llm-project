{"text": "ProtectionLevel ASTRONOMICAL android.permission.INSTALL_PACKAGES signature 245\\nRiskCategory Permissions ProtectionLevel CRITICAL android.permission.COPY_PROTECTED_DATA signature android.permission.WRITE_SECURE_SETTINGS signature android.permission.READ_FRAME_BUFFER signature android.permission.MANAGE_CA_CERTIFICATES signature android.permission.MANAGE_APP_OPS_MODES signature android.permission.GRANT_RUNTIME_PERMISSIONS signature android.permission.DUMP signature android.permission.CAMERA dangerous android.permission.SYSTEM_CAMERA systemOrSignature android.permission.MANAGE_PROFILE_AND_DEVICE_OWNERS signature android.permission.MOUNT_UNMOUNT_FILESYSTEMS signature HIGH android.permission.INSTALL_GRANT_RUNTIME_PERMISSIONS signature android.permission.READ_SMS dangerous android.permission.WRITE_SMS normal android.permission.RECEIVE_MMS dangerous android.permission.SEND_SMS_NO_CONFIRMATION signature android.permission.RECEIVE_SMS dangerous android.permission.READ_LOGS signature android.permission.READ_PRIVILEGED_PHONE_STATE signature android.permission.LOCATION_HARDWARE signature android.permission.ACCESS_FINE_LOCATION dangerous android.permission.ACCESS_BACKGROUND_LOCATION dangerous android.permission.BIND_ACCESSIBILITY_SERVICE signature android.permission.ACCESS_WIFI_STATE normal com.android.voicemail.permission.READ_VOICEMAIL signature android.permission.RECORD_AUDIO dangerous android.permission.CAPTURE_AUDIO_OUTPUT signature android.permission.ACCESS_NOTIFICATIONS signature android.permission.INTERACT_ACROSS_USERS_FULL signature android.permission.BLUETOOTH_PRIVILEGED signature android.permission.GET_PASSWORD signature android.permission.INTERNAL_SYSTEM_WINDOW signature MEDIUM android.permission.ACCESS_COARSE_LOCATION dangerous android.permission.CHANGE_COMPONENT_ENABLED_STATE signature android.permission.READ_CONTACTS dangerous android.permission.WRITE_CONTACTS dangerous android.permission.CONNECTIVITY_INTERNAL signature android.permission.ACCESS_MEDIA_LOCATION dangerous android.permission.READ_EXTERNAL_STORAGE dangerous android.permission.WRITE_EXTERNAL_STORAGE dangerous android.permission.SYSTEM_ALERT_WINDOW signature android.permission.READ_CALL_LOG dangerous 246\\nRiskCategory Permissions ProtectionLevel android.permission.WRITE_CALL_LOG dangerous android.permission.INTERACT_ACROSS_USERS signature android.permission.MANAGE_USERS signature android.permission.READ_CALENDAR dangerous android.permission.BLUETOOTH_ADMIN normal android.permission.BODY_SENSORS dangerous LOW android.permission.DOWNLOAD_WITHOUT_NOTIFICATION normal android.permission.PACKAGE_USAGE_STATS signature android.permission.MASTER_CLEAR signature android.permission.DELETE_PACKAGES normal android.permission.GET_PACKAGE_SIZE normal android.permission.BLUETOOTH normal android.permission.DEVICE_POWER signature NONE android.permission.ACCESS_NETWORK_STATE normal android.permission.RECEIVE_BOOT_COMPLETED normal android.permission.WAKE_LOCK normal android.permission.FLASHLIGHT normal android.permission.VIBRATE normal android.permission.WRITE_MEDIA_STORAGE signature android.permission.MODIFY_AUDIO_SETTINGS normal Notethatthiscategorizationcanchangeovertime. Thepapergivesusanexampleofthat: PriortoAndroid10, theREAD_PHONE_STATEpermissionwouldbeclassifiedasHIGH,duetothepermanentdevice identifiers (e.g. (IMEI/MEID, IMSI, SIM, and build serial) that it guards. However, starting from Android 10, a bulk of the sensitive information that can be used for tracking has been moved, refactored or rescoped into a new permissioncalledREAD_PRIVILEGED_PHONE_STATE,puttingthenewpermissionintheHIGHcategory,butresulting intheREAD_PHONE_STATEpermissionmovingtoLOW. Permission Changes per API Level Android8.0(APIlevel26)Changes: ThefollowingchangesaffectallappsrunningonAndroid8.0(APIlevel26),eventothoseappstargetinglowerAPIlevels. • Contacts provider usage stats change: when an app requests the READ_CONTACTS permission, queries for contact’susagedatawillreturnapproximationsratherthanexactvalues(theauto-completeAPIisnotaffectedby thischange). AppstargetingAndroid8.0(APIlevel26)orhigherareaffectedbythefollowing: • Account access and discoverability improvements: Appscannolongergetaccesstouseraccountsonlyby havingtheGET_ACCOUNTSpermissiongranted,unlesstheauthenticatorownstheaccountsortheusergrantsthat access. • New telephony permissions: the following permissions (classified as dangerous) are now part of the PHONE permissionsgroup: – The ANSWER_PHONE_CALLS permission allows to answer incoming phone calls programmatically (via accep- tRingingCall). 247\\n– TheREAD_PHONE_NUMBERSpermissiongrantsreadaccesstothephonenumbersstoredinthedevice. • Restrictions when granting dangerous permissions: Dangerous permissions are classified into permission groups(e.g.theSTORAGEgroupcontainsREAD_EXTERNAL_STORAGEandWRITE_EXTERNAL_STORAGE).BeforeAndroid 8.0 (API level 26), it was sufficient to request one permission of the group in order to get all permissions of that group also granted at the same time. This has changed starting at Android 8.0 (API level 26): whenever an app requests a permission at runtime, the system will grant exclusively that specific permission. However, note that allsubsequentrequestsforpermissionsinthatpermissiongroupwillbeautomaticallygrantedwithout showingthepermissionsdialogtotheuser. SeethisexamplefromtheAndroiddeveloperdocumentation: SupposeanapplistsbothREAD_EXTERNAL_STORAGEandWRITE_EXTERNAL_STORAGEinitsmanifest. The apprequestsREAD_EXTERNAL_STORAGEandtheusergrantsit. IftheapptargetsAPIlevel25orlower,the systemalsograntsWRITE_EXTERNAL_STORAGEatthesametime,becauseitbelongstothesameSTORAGE permissiongroupandisalsoregisteredinthemanifest. IftheapptargetsAndroid8.0(APIlevel26),thesystem grants only READ_EXTERNAL_STORAGE at that time; however, if the app later requests WRITE_EXTERNAL_- STORAGE,thesystemimmediatelygrantsthatprivilegewithoutpromptingtheuser. YoucanseethelistofpermissiongroupsintheAndroiddeveloperdocumentation. Tomakethisabitmoreconfusing, Googlealsowarnsthatparticularpermissionsmightbemovedfromonegrouptoanotherinfutureversionsofthe AndroidSDKandtherefore,thelogicoftheappshouldn’trelyonthestructureofthesepermissiongroups. Thebest practiceistoexplicitlyrequesteverypermissionwheneverit’sneeded. Android9(APILevel28)Changes: ThefollowingchangesaffectallappsrunningonAndroid9,eventothoseappstargetingAPIlevelslowerthan28. • Restricted access to call logs: READ_CALL_LOG, WRITE_CALL_LOG, and PROCESS_OUTGOING_CALLS (dangerous) permissionsare moved fromPHONE to the new CALL_LOG permissiongroup. This means that being able to make phonecalls(e.g.byhavingthepermissionsofthePHONEgroupgranted)isnotsufficienttogetaccesstothecall logs. • Restricted access to phone numbers: apps wanting to read the phone number require the READ_CALL_LOG permissionwhenrunningonAndroid9(APIlevel28). • RestrictedaccesstoWi-Filocationandconnectioninformation: SSIDandBSSIDvaluescannotberetrieved (e.g.viaWifiManager.getConnectionInfounlessallofthefollowingistrue: – TheACCESS_FINE_LOCATIONorACCESS_COARSE_LOCATIONpermission. – TheACCESS_WIFI_STATEpermission. – Locationservicesareenabled(underSettings->Location). AppstargetingAndroid9(APIlevel28)orhigherareaffectedbythefollowing: • Buildserialnumberdeprecation: device’shardwareserialnumbercannotberead(e.g.viaBuild.getSerial) unlesstheREAD_PHONE_STATE(dangerous)permissionisgranted. Android10(APIlevel29)Changes: Android10(APIlevel29)introducesseveraluserprivacyenhancements. Thechangesregardingpermissionsaffecttoall appsrunningonAndroid10(APIlevel29),includingthosetargetinglowerAPIlevels. • RestrictedLocationaccess: newpermissionoptionforlocationaccess“onlywhileusingtheapp”. • Scopedstoragebydefault: appstargetingAndroid10(APIlevel29)don’tneedtodeclareanystoragepermission toaccesstheirfilesintheappspecificdirectoryinexternalstorageaswellasforfilescreatesfromthemediastore. • Restricted access to screen contents: READ_FRAME_BUFFER,CAPTURE_VIDEO_OUTPUT,andCAPTURE_SECURE_- VIDEO_OUTPUT permissions are now signature-access only, which prevents silent access to the device’s screen contents. • User-facing permission check on legacy apps: when running an app targeting Android 5.1 (API level 22) or lowerforthefirsttime,userswillbepromptedwithapermissionsscreenwheretheycanrevokeaccesstospecific legacypermissions(whichpreviouslywouldbeautomaticallygrantedatinstallationtime). Permission Enforcement ActivityPermissionEnforcement: 248\\nPermissions are applied via android:permission attribute within the <activity> tag in the manifest. These permis- sionsrestrictwhichapplicationscanstartthatActivity. ThepermissionischeckedduringContext.startActivityand Activity.startActivityForResult. NotholdingtherequiredpermissionresultsinaSecurityExceptionbeingthrown fromthecall. ServicePermissionEnforcement: Permissions applied via android:permission attribute within the <service> tag in the", "metadata": {"doc_id": "OWASP_MASTG", "chunk_id": 96}}