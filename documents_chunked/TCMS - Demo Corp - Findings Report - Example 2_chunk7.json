{"text": "guidance, please reference the guidance here. Demo Corp BUSINESS CONFIDENTIAL Page 15 of 38\\nFinding IPT-004: Insufficient Hardening – Token Impersonation (Critical) Description: TCMS impersonated the token of “supcb” to obtain Domain Administrator privileges. Risk: Likelihood: High – The penetration tester viewed and impersonated tokens with the use of open-source tools. Impact: Very High - If exploited, an attacker gains domain administrator access. System: All Tools Used: Metasploit, Incognito References: NIST SP800-53 r4 CM-7 - Least Functionality NIST SP800-53 r4 AC-6 - Least Privilege https://docs.microsoft.com/en-us/windows-server/identity/ad- ds/manage/how-to-configure- protected-accounts Evidence Figure 5: Impersonation of “sup” Figure 6: Shell access as Domain Admin “sup” Remediation Restrict token delegation. For full mitigation and detection guidance, please reference the MITRE guidance here. Demo Corp BUSINESS CONFIDENTIAL Page 16 of 38\\nFinding IPT-005: Insufficient Password Complexity (Critical) Description: TCMS dumped hashes from the domain controller and proceeded to attempt common password guessing attacks against all users. TCMS cracked 2,226 passwords using basic password list guessing attacks and low effort brute forcing attacks. 17 cracked accounts had domain administrator rights. Risk: Likelihood: High - Simple passwords are susceptible to password cracking attacks. Encryption provides some protection, but dictionary attacks base on common word lists often crack weak passwords. Impact: Very High - Domain admin accounts with weak passwords could lead to an adversary critically impacting Demo Corp ability to operate. System: All Tools Used: Manual Review References: NIST SP800-53 IA-5(1) - Authenticator Management https://www.cisecurity.org/white-papers/cis-password-policy-guide/ Evidence Figure 7: Excerpt of cracked domain hashes Remediation Implement CIS Benchmark password requirements / PAM solution. TCMS recommends that Demo Corp enforce industry best practices around password complexity and management. A password filter to prevent users from using common and easily guessable passwords is also recommended. Additionally, TCMS recommends that Demo Corp enforce stricter password requirements for Domain Administrator and other sensitive accounts. Demo Corp BUSINESS CONFIDENTIAL Page 17 of 38\\nFinding IPT-006: Security Misconfiguration – IPv6 (Critical) Description: Through IPv6 DNS poisoning, the TCMS team was able to successfully relay credentials to the Demo Corp domain controller. Risk: Likelihood: High – IPv6 is enabled by default on Windows networks. The tools and techniques required to perform this task are trivial. Impact: Very High - If exploited, an attacker can gain domain administrator access. System: All Tools Used: Mitm6, Impacket References: https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via- ipv6/ Evidence Figure 8: Successfully relayed LDAP credentials via mitm6 Remediation 1. IPv6 poisoning abuses the fact that Windows queries for an IPv6 address even in IPv4-only environments. If you do not use IPv6 internally, the safest way to prevent mitm6 is to block DHCPv6 traffic and incoming router advertisements in Windows Firewall via Group Policy. Disabling IPv6 entirely may have unwanted side effects. Setting the following predefined rules to Block instead of Allow prevents the attack from working: a. (Inbound) Core Networking - Dynamic Host Configuration Protocol for IPv6(DHCPV6-In) b. (Inbound) Core Networking - Router Advertisement (ICMPv6-In) c. (Outbound) Core Networking - Dynamic Host Configuration Protocol for IPv6(DHCPV6- Out) 2. If WPAD is not in use internally, disable it via Group Policy", "metadata": {"doc_id": "TCMS - Demo Corp - Findings Report - Example 2", "chunk_id": 7}}