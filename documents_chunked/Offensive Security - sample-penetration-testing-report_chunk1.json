{"text": "Java applet for administrative users. We added a malicious payload to this applet, which gave us interactive access to workstations used by MegaCorp One’s administrators. Using the compromised webserver as a pivot point along with passwords recovered from it, we were able to target previously inaccessible internal resources. This resulted in Local Administrator access to numerous internal Windows hosts, complete compromise of a Citrix server, and full administrative control of the Windows Active Directory infrastructure. Existing network traffic controls were bypassed through encapsulation of malicious traffic into allowed protocols. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 2 of 34\\nAttack Narrative Remote System Discovery For the purposes of this assessment, MegaCorp One provided minimal information outside of the organizational domain name: megacorpone.com. The intent was to closely simulate an adversary without any internal information. To avoid targeting systems that were not owned by MegaCorp One, all identified assets were submitted for ownership verification before any attacks were conducted. In an attempt to identify the potential attack surface, we examined the name servers of the megacorpone.com domain name (Figure 1). Figure 1 – Information gathering for megacorpone.com reveals three active name servers. With the name servers identified, we attempted to conduct a zone transfer. We found that ns2.megacorpone.com was vulnerable to a full DNS zone transfer misconfiguration. This provided us with a listing of hostnames and associated IP addresses, which could be used to further target the organization. (Figure 2) Zone transfers can provide attackers with detailed information about the capabilities of the organization. It can also leak information about the network ranges owned by the organization. Please see Appendix A for more information. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 3 of 34\\nFigure 2 – A misconfigured name server allows a full and unrestricted DNS zone transfer. The list of identified hosts was submitted to MegaCorp One for verification, which verified that the entire 50.7.67.x network range should be included in the assessment scope. These systems were then scanned to enumerate any running services. All identified services were examined in detail to determine their potential exposure to a targeted attack. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 4 of 34\\nThrough a combination of DNS enumeration techniques and network scanning, we were able to build a composite that we feel reflects MegaCorp One’s network. The target network is shown below in Figure 3. Additional details regarding controls such as deep packet inspection were discovered later in the assessment but are included here for completeness. Figure 3 - Target Network PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 5 of 34\\nAdmin Webserver Interface Compromise The admin.megacorpone.com webserver was found to be running an Apache webserver on port 81. Accessing the root URL of this site resulted in the display of a blank page. We next conducted a quick enumeration scan of the system looking for common directories and files (Figure 4). Figure 4 –", "metadata": {"doc_id": "Offensive Security - sample-penetration-testing-report", "chunk_id": 1}}