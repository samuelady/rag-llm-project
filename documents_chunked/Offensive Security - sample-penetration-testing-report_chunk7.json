{"text": "with administrative privileges. Figure 32 – Complete compromise of the Citrix server is achieved. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 23 of 34\\nFigure 33 – An additional host in the network management subnet has been compromised. Escalation to Domain Administrator With the Citrix server compromised, we made an attempt to capture passwords from memory. A Citrix server is an ideal candidate for this attack vector, as it typically operates for long periods of time without reboots and services a large number of users. To capture passwords from memory, we utilized the Windows Credential Editor tool8 due to its ability to run on 64 bit systems without causing adverse effects. 8 http://www.ampliasecurity.com/research/wcefaq.html PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 24 of 34\\nFigure 34 – Windows Credentials Editor is used to retrieve plaintext passwords from the Citrix server. This revealed multiple passwords, including a Windows domain administrator account. Please see Appendix A for more information. In order to validate the newly recovered credentials, we successfully created a new remote desktop session to the Citrix server using the domain administrator credentials. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 25 of 34\\nFigure 35 - Domain Administrator credentials are validated against the Citrix host. At this point, full control of the Windows domain had been obtained. A malicious attacker would have multiple tools at their disposal, including: o Utilization of Group Policy to deploy backdoor software on Windows systems. o Complete exfiltration of all data stored on any system that uses Windows authentication. o Destruction of any and all network resources. o Targeted attacks against any and all employees of MegaCorp One, through the use of information gathering tools such as keystroke loggers to identify personal information. o Leveraging this systemic access to conduct attacks against MegaCorp One suppliers and partners that maintain a trust relationship with the company. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 26 of 34\\nIt was determined that while these steps would be possible, they would be considered outside the scope of the current engagement. It was demonstrated that a total compromise of the MegaCorp One domain had been accomplished with a complete loss of integrity for all local systems. Figure 36 - Full Domain Compromise PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 27 of 34\\nConclusion MegaCorp One suffered a series of control failures, which led to a complete compromise of critical company assets. These failures would have had a dramatic effect on MegaCorp One operations if a malicious party had exploited them. Current policies concerning password reuse and deployed access controls are not adequate to mitigate the impact of the discovered vulnerabilities. The specific goals of the penetration test were stated as: o Identifying if a remote attacker could penetrate MegaCorp One’s defenses o Determining the impact of a security breach on: o Confidentiality of the company’s information o Internal infrastructure and availability of", "metadata": {"doc_id": "Offensive Security - sample-penetration-testing-report", "chunk_id": 7}}