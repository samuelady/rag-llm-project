{"text": "use of a randomly generated 10 character salt value, we were able to easily convert the recovered hashes into their salted SHA1 equivalent and conduct a brute-force attack. This effort resulted in the recovery of two plaintext passwords. Although these values were not immediately useful, they were retained in hope that they may have been re-used on other systems within the organization. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 8 of 34\\nInteractive Shell to Admin Server The previously discovered SQLite Manager software was found to be vulnerable to a well-known code injection vulnerability3. Successful exploitation of this vulnerability results in shell access to the underlying system in the context of the webserver user. Using a modified public exploit, we were able to obtain limited interactive access to the admin.megacorpone.com webserver. Please see Appendix A for more information. Figure 10 – A publicly available SQLite exploit is used to gain unauthorized access on the admin.megacorpone.com host. 3 http://www.exploit-db.com/exploits/24320/ PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 9 of 34\\nFigure 11 – Control of the vulnerable server is limited to the context of the www-data user. The public version of the exploit targets a slightly different version of the SQLite Manager than the one deployed by MegaCorp One. Although the deployed version of the software is vulnerable to the same underlying issues, the exploit does not successfully run without modification. We were able to extend the original exploit to support HTTP authentication and customize it for the updated version. A copy of this updated exploit will be provided separately from this report. The extent of compromise at this point can be best visualized in Figure 12. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 10 of 34\\nFigure 12 - Web Server Compromise PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 11 of 34\\nAdministrative Privilege Escalation With interactive access to the underlying operating system of the administrative webserver obtained, we continued with the examination of the system searching for ways to escalate privileges to the administrative level. We found that the system was vulnerable to a local privilege escalation exploit4, which we were able to utilize successfully. Please see Appendix A for more information. Figure 13 – A local privilege escalation exploit is used to take advantage of an unpatched host and gain root-level access. The use of this exploit was partially made possible due to the inclusion of developer tools on the vulnerable system. If these tools were not present on the system, it would have still been possible to successfully exploit, although the difficulty in doing so would have been increased. In its current configuration, the webserver represents an internal attack platform for a malicious party. With the ability to gain full administrative access, a malicious party could utilize this vulnerable system for a multitude of purposes, ranging from attacks against MegaCorp One itself, to attacks against its customers. It’s highly likely that the", "metadata": {"doc_id": "Offensive Security - sample-penetration-testing-report", "chunk_id": 3}}