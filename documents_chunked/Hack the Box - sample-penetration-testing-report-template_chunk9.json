{"text": "a network file share audit  [Finding 8] – Enhance network logging and monitoring  [Finding 8] – Implement an enterprise endpoint detection & response solution Long Term  Perform ongoing internal network vulnerability assessments and domain password audits  Perform periodic Active Directory security assessments  Educate systems and network administrators and developers on security hardening best practices compromise  Enhance network segmentation to isolate critical hosts and limit the effects of an internal compromise 17\\nTechnical Findings Details 1. LLMNR/NBT-NS Response Spoofing - High CWE CWE-522 CVSS 3.1 Score 9.5 By responding to LLMNR/NBT-NS network traffic, adversaries may spoof an authoritative source for name resolution to force communication with an adversary-controlled system. This activity may be used to collect or relay authentication materials. Description (Incl. Root Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Cause) Microsoft Windows components that serve as alternate methods of host identification. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. NBT-NS identifies systems on a local network by their NetBIOS name. Adversaries can spoof an authoritative source for name resolution on a victim network by responding to LLMNR (UDP 5355)/NBT-NS (UDP 137) traffic as if they know the identity of the requested host, effectively poisoning the service so that the victims will communicate with the adversary-controlled system. If the requested host belongs to a resource that requires identification/authentication, the username and NTLMv2 hash will then be sent to the adversary-controlled system. The adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through Network Sniffing and crack Security Impact the hashes offline through Brute Force to obtain the plaintext passwords. In some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary- controlled system, the NTLMv2 hashes can be intercepted and relayed to access and execute code against a target system relay step can happen in conjunction with poisoning but may also be independent of it. Several tools exist that can be used to poison name services within local networks such as NBNSpoof, Metasploit, and Responder. Affected Domain  INLANEFREIGHT.LOCAL  Disable LLMNR and NetBIOS in local computer security settings or by group policy if they are not needed within an environment  Use host-based security software to block LLMNR/NetBIOS traffic. Enabling SMB Signing can stop NTLMv2 relay attacks. Remediation  Network intrusion detection and prevention systems that can identify traffic patterns indicative of MiTM activity can be used to mitigate activity at the network level.  Network segmentation can be used to isolate infrastructure components that do not require broad network access. This may mitigate, or at least alleviate, the scope of MiTM activity. External References https://attack.mitre.org/techniques/T1557/001/ Finding Evidence: 18\\nRunning the Responder tool to attempt to obtain user account password hashes. $ sudo responder", "metadata": {"doc_id": "Hack the Box - sample-penetration-testing-report-template", "chunk_id": 9}}