{"text": "the program flow. If stackcanariesareenabled,theywillbeoverwrittenaswellandtheCPUwillknowthatthememoryhasbeentampered with. Stackbufferoverflowisatypeofthemoregeneralprogrammingvulnerabilityknownasbufferoverflow(orbufferoverrun). Overfillingabufferonthestackismorelikelytoderailprogramexecutionthanoverfillingabufferontheheapbecause thestackcontainsthereturnaddressesforallactivefunctioncalls. 83\\nMobile App User Privacy Protection Overview IMPORTANTDISCLAIMER:TheMASTGisnotalegalhandbook. Therefore,wewillnotdeepdiveintotheGDPRorother possibly relevant legislation here. This chapter is meant to introduce you to the topics and provide you with essential referencesthatyoucanusetocontinueresearchingbyyourself. We’llalsodoourbestefforttoprovideyouwithtestsor guidelinesfortestingtheprivacy-relatedrequirementslistedintheOWASPMASVS. The Main Problem Mobileappshandleallkindsofsensitiveuserdata,fromidentificationandbankinginformationtohealthdata. Thereisan understandableconcernabouthowthisdataishandledandwhereitendsup. Wecanalsotalkabout“benefitsusersget fromusingtheapps”vs“therealpricethattheyarepayingforit”(usuallyandunfortunatelywithoutevenbeingaware ofit). The Solution (pre-2020) Toensurethatusersareproperlyprotected,legislationsuchastheGeneralDataProtectionRegulation(GDPR)inEurope hasbeendevelopedanddeployed(applicablesinceMay25,2018),forcingdeveloperstobemoretransparentregarding thehandlingofsensitiveuserdata. Thishasbeenmainlyimplementedusingprivacypolicies. The Challenge Therearetwomaindimensionstoconsiderhere: • DeveloperCompliance: Developersneedtocomplywithlegalprivacyprinciplessincetheyareenforcedbylaw. Developersneedtobettercomprehendthelegalprinciplesinordertoknowwhatexactlytheyneedtoimplement toremaincompliant. Ideally,atleast,thefollowingmustbefulfilled: – Privacy-by-Designapproach(Art. 25GDPR,“Dataprotectionbydesignandbydefault”). – PrincipleofLeastPrivilege(“Everyprogramandeveryuserofthesystemshouldoperateusingtheleast setofprivilegesnecessarytocompletethejob.”) • UserEducation: Usersneedtobeeducatedabouttheirsensitivedataandinformedabouthowtousetheappli- cationproperly(toensuresecurehandlingandprocessingoftheirinformation). Note: Moreoftenthannotappswillclaimtohandlecertaindata,butinrealitythat’snotthecase. TheIEEEarticle “EngineeringPrivacyin Smartphone Apps: A TechnicalGuideline Catalogfor App Developers” by Majid Hatamian givesaveryniceintroductiontothistopic. Protection Goals for Data Protection When an app needs personal information from a user for its business process, the user needs to be informed on what happenswiththedataandwhytheappneedsit. Ifthereisathirdpartydoingtheactualprocessingofthedata,theapp shouldinformtheuseraboutthattoo. Surelyyou’realreadyfamiliarwiththeclassictriadofsecurityprotectiongoals: confidentiality,integrity,andavailability. However,youmightnotbeawareofthethreeprotectiongoalsthathavebeenproposedtofocusondataprotection: • Unlinkability: – Users’privacy-relevantdatamustbeunlinkabletoanyothersetofprivacy-relevantdataoutsideofthedomain. – Includes: dataminimization,anonymization,pseudonymization,etc. • Transparency: 84\\n– Usersshouldbeabletorequestallinformationthattheapplicationhasonthem,andreceiveinstructionson howtorequestthisinformation. – Includes: privacypolicies,usereducation,properloggingandauditingmechanisms,etc. • Intervenability: – Usersshouldbeabletocorrecttheirpersonalinformation,requestitsdeletion,withdrawanygivenconsent atanytime,andreceiveinstructionsonhowtodoso. – Includes: privacy settings directly in the app, single points of contact for individuals’ intervention requests (e.g.in-appchat,telephonenumber,e-mail),etc. SeeSection5.1.1“Introductiontodataprotectiongoals”inENISA’s“Privacyanddataprotectioninmobileapplica- tions”formoredetaileddescriptions. Addressing both security and privacy protection goals at the same time is a very challenging task (if not impossible in many cases). There is an interesting visualization in IEEE’s publication Protection Goals for Privacy Engineering called “TheThreeAxes”representingtheimpossibilitytoensure100%ofeachofthesixgoalssimultaneously. Mostpartsoftheprocessesderivedfromtheprotectiongoalsaretraditionallycoveredinaprivacypolicy. However,this approachisnotalwaysoptimal: • developersarenotlegalexpertsbutstillneedtobecompliant. • userswouldberequiredtoreadusuallylongandwordypolicies. The New Approach (Google’s and Apple’s take on this) In order to address these challenges and help users easily understand how their data is being collected, handled, and shared, Google and Apple introduced new privacy labeling systems (very much along the lines of NIST’s proposal for ConsumerSoftwareCybersecurityLabeling: • theAppStoreNutritionLabels(since2020). • theGooglePlayDataSafetySection(since2021). Asanewrequirementonbothplatforms,it’svitalthattheselabelsareaccurateinordertoprovideuserassuranceand mitigateabuse. Google ADA MASA program Performingregularsecuritytestingcanhelpdevelopersidentifykeyvulnerabilitiesintheirapps. GooglePlaywillallow developerswhohavecompletedindependentsecurityvalidationtoshowcasethisontheirDatasafetysection. Thishelps usersfeelmoreconfidentaboutanapp’scommitmenttosecurityandprivacy. Inordertoprovidemoretransparencyintotheapp’ssecurityarchitecture,GooglehasintroducedtheMASA(MobileAppli- cationSecurityAssessment)programaspartoftheAppDefenseAlliance(ADA).WithMASA,Googlehasacknowledged theimportanceofleveragingagloballyrecognizedstandardformobileappsecuritytothemobileappecosystem. Devel- operscanworkdirectlywithanAuthorizedLabpartnertoinitiateasecurityassessment. Googlewillrecognizedevelopers whohavehadtheirapplicationsindependentlyvalidatedagainstasetofMASVSLevel1requirementsandwillshowcase thisontheirDatasafetysection. 85\\nIfyouareadeveloperandwouldliketoparticipate,youshouldcompletetheIndependentSecurityReviewform. Notethatthelimitednatureoftestingdoesnotguaranteecompletesafetyoftheapplication. Thisindependentreview maynotbescopedtoverifytheaccuracyandcompletenessofadeveloper’sDatasafetydeclarations. Developersremain solelyresponsibleformakingcompleteandaccuratedeclarationsintheirapp’sPlaystorelisting. References Youcanlearnmoreaboutthisandotherprivacyrelatedtopicshere: • iOSAppPrivacyPolicy • iOSPrivacyDetailsSectionontheAppStore • iOSPrivacyBestPractices • AndroidAppPrivacyPolicy • AndroidDataSafetySectiononGooglePlay • PreparingyourappforthenewDatasafetysectioninGooglePlay • AndroidPrivacyBestPractices Testing for Privacy in Mobile Apps Thefollowingisalistofcommonprivacyviolationsthatyouasasecuritytestershouldreport(althoughnotanexhaustive list): • Example 1: An app that accesses a user’s inventory of installed apps and doesn’t treat this data as personal or sensitivedatabysendingitoverthenetwork(violatingMSTG-STORAGE-4)ortoanotherappviaIPCmechanisms (violatingMSTG-STORAGE-6). • Example2: Anappdisplayssensitivedatasuchascreditcarddetailsoruserpasswordswithoutuserauthorization e.g.biometrics(violatingMSTG-AUTH-10). • Example3: Anappthataccessesauser’sphoneorcontactbookdataanddoesn’ttreatthisdataaspersonalor sensitivedata,additionallysendingitoveranunsecurednetworkconnection(violatingMSTG-NETWORK-1). • Example4: Anappcollectsdevicelocation(whichisapparentlynotrequiredforitsproperfunctioning)anddoes nothaveaprominentdisclosureexplainingwhichfeatureusesthisdata(violatingMSTG-PLATFORM-1). YoucanfindmorecommonviolationsinGooglePlayConsoleHelpbygoingtoPolicyCentre->Privacy,deception anddeviceabuse->Userdata. 86\\nAsyoucanseethisisdeeplyrelatedtoothertestingcategories. Whenyou’retestingthemyou’reoftenindirectlytesting forUserPrivacyProtection. Keepthisinmindsinceitwillhelpyouprovidebetterandmorecomprehensivereports. Often you’llalsobeabletoreuseevidencefromothertestsinordertotestforUserPrivacyProtection). Testing User Education on Data Privacy on the App Marketplace Atthispoint,we’reonlyinterestedinknowingwhichprivacy-relatedinformationisbeingdisclosedbythedevelopersand tryingtoevaluateifitseemsreasonable(similarlyasyou’ddowhentestingforpermissions). It’spossiblethatthedevelopersarenotdeclaringcertaininformationthatisindeedbeingcollectedand/orshared, butthat’satopicforadifferenttestextendingthisonehere. Aspartofthistest,youarenotsupposedtoprovide privacyviolationassurance. Static Analysis Youcanfollowthesesteps: 1. Searchfortheappinthecorrespondingappmarketplace(e.g.GooglePlay,AppStore). 2. Gotothesection“PrivacyDetails”(AppStore)or“SafetySection”(GooglePlay). 3. Verifyifthere’sanyinformationavailableatall. Thetestpassesifthedeveloperhascompliedwiththeappmarketplaceguidelinesandincludedtherequiredlabelsand explanations. Storeandprovidetheinformationyougotfromtheappmarketplaceasevidence,sothatyoucanlateruse ittoevaluatepotentialviolationsofprivacyordataprotection. Dynamic analysis Asanoptionalstep,youcanalsoprovidesomekindofevidenceaspartofthistest. Forinstance,ifyou’retestinganiOS appyoucaneasilyenableappactivityrecordingandexportaPrivacyReportcontainingdetailedappaccesstodifferent resourcessuchasphotos,contacts,camera,microphone,networkconnections,etc. Doing this has actually many advantages for testing other MASVS categories. It provides very useful information that youcanusetotestnetworkcommunicationforMASVS-NETWORKorwhentestingappinteractionwiththeplatformfor MASVS-PLATFORM.Whiletestingtheseothercategoriesyoumighthavetakensimilarmeasurementsusingothertesting tools. Youcanalsoprovidethisasevidenceforthistest. Ideally, the information available should be compared against what the app is actually meant to do. However, that’sfarfromatrivialtaskthatcouldtakefromseveraldaystoweekstocompletedependingonyourresources andsupportfromautomatedtooling. Italsoheavilydependsontheappfunctionalityandcontextandshouldbe ideallyperformedonawhiteboxsetupworkingverycloselywiththeappdevelopers. Testing User Education on Security Best Practices Testingthismightbeespeciallychallengingifyouintendtoautomateit. Werecommendusingtheappextensivelyand trytoanswerthefollowingquestionswheneverapplicable: • Fingerprint usage: when fingerprints are used for authentication providing access to high-risk transac- tions/information, doestheappinformtheuseraboutpotentialissueswhenhavingmultiplefingerprintsofotherpeopleregistered tothedeviceaswell? • Rooting/Jailbreaking: whenrootorjailbreakdetectionisimplemented, does the app inform the user of the fact that certain high-risk actions will carry additional risk due to the jailbro- ken/rootedstatusofthedevice? 87\\n• Specificcredentials: whenausergetsarecoverycode,apasswordorapinfromtheapplication(orsetsone), doestheappinstructtheusertoneversharethiswithanyoneelseandthatonlytheappwillrequestit? • Applicationdistribution: incaseofahigh-riskapplicationandinordertopreventusersfromdownloadingcom- promisedversionsoftheapplication, doestheappmanufacturerproperlycommunicatetheofficialwayofdistributingtheapp(e.g.fromGooglePlayor theAppStore)? • ProminentDisclosure: inanycase, doestheappdisplayprominentdisclosureofdataaccess,collection,use,andsharing? e.g.doestheappusethe AppTrackingTransparencyFrameworktoaskforthepermissiononiOS? Somereferencesinclude: • Open-SourceLicensesandAndroid-https://www.bignerdranch.com/blog/open-source-licenses-and-android/ • SoftwareLicensesinPlainEnglish-https://tldrlegal.com/ • AppleAccessingprivatedata-https://developer.apple.com/design/human-interface-guidelines/privacy •", "metadata": {"doc_id": "OWASP_MASTG", "chunk_id": 54}}