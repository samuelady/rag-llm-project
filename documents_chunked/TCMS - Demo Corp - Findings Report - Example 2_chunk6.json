{"text": "offline or relay in real-time and pivot laterally in the environment. System: All Tools Used: Responder, Hashcat References: Stern Security - Local Network Attacks: LLMNR and NBT-NS Poisoning NIST SP800-53 r4 IA-3 - Device Identification and Authentication NIST SP800-53 r4 CM-6(1) - Configuration Settings Evidence Figure 1: Captured hash of “production” Figure 2: Cracked hash of “production” Remediation Disable multicast name resolution via GPO. For full mitigation and detection guidance, please reference the MITRE guidance here. The cracked hashes demonstrate a deficient password complexity policy. If multicast name resolution is required, Network Access Control (NAC) combined with application whitelisting can limit these attacks. Demo Corp BUSINESS CONFIDENTIAL Page 13 of 38\\nFinding IPT-002: Security Misconfiguration – Local Admin Password Reuse (Critical) Description: TCMS utilized local administrator hashes to gain access to other machines in the network via a ‘pass-the-hash’ attack. The local administrator hashes were obtained via machine access provided by the cracked account in IPT-001. Pass-the-hash attacks do not require knowing the account password to successfully log into a machine. Thus, reusing the same local admin password (and therefore the same hash) on multiple machines will permit system access to those computers. TCMS leveraged this attack to gain access to ~50 machines within the main office. This led to further account access and the eventual compromise of the domain controller. Risk: Likelihood: High – This attack is effective in large networks with local admin password reuse. Impact: Very High – Pass-the-hash permits an attacker to move laterally and vertically throughout the network. System: All Tools Used: Impacket, Crackmapexec References: https://capec.mitre.org/data/definitions/644.html https://tcm-sec.com/pentest-tales-001-you-spent-how-much-on-security/ Evidence Figure 3: Local admin hash used to gain access to machine Remediation Utilize unique local admin passwords. Limit local admin users via least privilege. Consider implementing a PAM solution. For full mitigation and detection guidance, please reference the MITRE guidance here. Demo Corp BUSINESS CONFIDENTIAL Page 14 of 38\\nFinding IPT-003: Security Misconfiguration – WDigest (Critical) Description: Demo Corp permitted out-of-date operating systems within their network, including Windows 7, 8, Server 2008, and Server 2012. These operating systems, by default, permit WDigest, which stores all current logged-in user’s passwords in clear-text. TCMS leveraged machine access gained in IPT-001 and IPT-002 to move laterally throughout the network until uncovering a machine with Domain Admin credentials stored in WDigest. Risk: Likelihood: Moderate – This attack is effective in networks with older operating systems. Impact: Very High – WDigests credentials are stored in clear text, which can permit the theft of sensitive accounts, such as Domain Administrators. System: All systems older than Windows 10 and Server 2016 Tools Used: Metasploit, Kiwi References: https://stealthbits.com/blog/wdigest-clear-text-passwords-stealing-more-than- a-hash/ Evidence Figure 4: Cleartext passwords of Domain Administrators Remediation Disable WDigest via GPO. For full mitigation and detection guidance, please reference the guidance here. Demo Corp BUSINESS CONFIDENTIAL Page 15 of 38\\nFinding IPT-004: Insufficient Hardening – Token Impersonation (Critical) Description: TCMS impersonated the token of “supcb” to obtain Domain Administrator privileges. Risk: Likelihood: High – The penetration tester viewed and impersonated tokens with the use of open-source tools.", "metadata": {"doc_id": "TCMS - Demo Corp - Findings Report - Example 2", "chunk_id": 6}}