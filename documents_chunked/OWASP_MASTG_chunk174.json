{"text": "gitclonehttps://github.com/ios-control/ios-deploy.git cdios-deploy/ xcodebuild cdbuild/Release ./ios-deploy ln-s<your-path-to-ios-deploy>/build/Release/ios-deploy/usr/local/bin/ios-deploy Thelastlinecreatesasymboliclinkandmakestheexecutableavailablesystem-wide. Reloadyourshelltomakethenew commandsavailable: zsh: #.~/.zshrc bash: #.~/.bashrc iOSbackup Platform: ios Availableat: https://github.com/avibrazil/iOSbackup iOSbackupisaPython3classthatreadsandextractsfilesfromapassword-encryptediOSbackupcreatedbyiTuneson MacandWindows. MobSF for iOS Platform: ios Availableat: https://github.com/MobSF/Mobile-Security-Framework-MobSF ByrunningMobSFlocallyonamacOShostyou’llbenefitfromaslightlybetterclass-dumpoutput. OnceyouhaveMobSFupandrunningyoucanopenitinyourbrowserbynavigatingtohttp://127.0.0.1:8000. Simply dragtheIPAyouwanttoanalyzeintotheuploadareaandMobSFwillstartitsjob. AfterMobSFisdonewithitsanalysis,youwillreceiveaone-pageoverviewofalltheteststhatwereexecuted. Thepage issplitupintomultiplesectionsgivingsomefirsthintsontheattacksurfaceoftheapplication. 550\\nThefollowingisdisplayed: • Basicinformationabouttheappanditsbinaryfile. • Someoptionsto: – ViewtheInfo.plistfile. – Viewthestringscontainedintheappbinary. – Download a class-dump, if the app was written in Objective-C; if it is written in Swift no class-dump can be created. • ListallPurposeStringsextractedfromtheInfo.plistwhichgivesomehintsontheapp’spermissions. • ExceptionsintheAppTransportSecurity(ATS)configurationwillbelisted. • Abriefbinaryanalysisshowingiffreebinarysecurityfeaturesareactivatedore.g.ifthebinarymakesuseofbanned APIs. • ListoflibrariesusedbytheappbinaryandlistofallfilesinsidetheunzippedIPA. IncontrasttotheAndroidusecase,MobSFdoesnotofferanydynamicanalysisfeaturesforiOSapps. RefertoMobSFdocumentationformoredetails. class-dump Platform: ios Availableat: http://stevenygard.com/projects/class-dump/ class-dumpbySteveNygardisacommandlineutilityforexaminingtheObjective-CruntimeinformationstoredinMach-O (Machobject)files. Itgeneratesdeclarationsfortheclasses,categories,andprotocols. Sileo Platform: ios Availableat: https://cydia-app.com/sileo/ SinceiOS11jailbreaksareintroducingSileo,whichisanewjailbreakapp-storeforiOSdevices. ThejailbreakChimerafor iOS12isalsorelyingonSileoasapackagemanager. 551\\nCydia Platform: ios Availableat: https://cydia.saurik.com/ CydiaisanalternativeappstoredevelopedbyJayFreeman(aka“saurik”)forjailbrokendevices. Itprovidesagraphical user interface and a version of the Advanced Packaging Tool (APT). You can easily access many “unsanctioned” app packagesthroughCydia. MostjailbreaksinstallCydiaautomatically. Many tools on a jailbroken device can be installed by using Cydia, which is the unofficial AppStore for iOS devices and allowsyoutomanagerepositories. InCydiayoushouldadd(ifnotalreadydonebydefault)thefollowingrepositoriesby navigatingtoSources->Edit,thenclickingAddinthetopleft: • http://apt.thebigboss.org/repofiles/cydia/: OneofthemostpopularrepositoriesisBigBoss,whichcontainsvarious packages,suchastheBigBossRecommendedToolspackage. • https://cydia.akemi.ai/: Add“Karen’sRepo”togettheAppSyncpackage. • https://build.frida.re: InstallFridabyaddingtherepositorytoCydia. • https://repo.chariz.io: UsefulwhenmanagingyourjailbreakoniOS11. • https://apt.bingner.com/: Anotherrepository,withquietafewgoodtools,isElucubratus,whichgetsinstalledwhen youinstallCydiaoniOS12usingUnc0ver. IncaseyouareusingtheSileoAppStore,pleasekeepinmindthattheSileoCompatibilityLayersharesyoursources betweenCydiaandSileo,however,CydiaisunabletoremovesourcesaddedinSileo,andSileoisunabletoremove sourcesaddedinCydia. Keepthisinmindwhenyou’retryingtoremovesources. AfteraddingallthesuggestedrepositoriesaboveyoucaninstallthefollowingusefulpackagesfromCydiatogetstarted: • adv-cmds: Advancedcommandline,whichincludestoolssuchasfinger,fingerd,last,lsvfs,md,andps. • AppList: Allowsdeveloperstoquerythelistofinstalledappsandprovidesapreferencepanebasedonthelist. • Apt: AdvancedPackageTool,whichyoucanusetomanagetheinstalledpackagessimilarlytoDPKG,butinamore friendlyway. Thisallowsyoutoinstall,uninstall,upgrade,anddowngradepackagesfromyourCydiarepositories. ComesfromElucubratus. • AppSyncUnified: AllowsyoutosyncandinstallunsignediOSapplications. • BigBossRecommendedTools: InstallsmanyusefulcommandlinetoolsforsecuritytestingincludingstandardUnix utilitiesthataremissingfromiOS,includingwget,unrar,less,andsqlite3client. • class-dump: A command line tool for examining the Objective-C runtime information stored in Mach-O files and generatingheaderfileswithclassinterfaces. • class-dump-z: AcommandlinetoolforexaminingtheSwiftruntimeinformationstoredinMach-Ofilesandgener- atingheaderfileswithclassinterfaces. ThisisnotavailableviaCydia,thereforepleaserefertoinstallationstepsin ordertogetclass-dump-zrunningonyouriOSdevice. Notethatclass-dump-zisnotmaintainedanddoesnotwork wellwithSwift. Itisrecommendedtousedsdumpinstead. • Clutch: Usedtodecryptanappexecutable. • Cycript: Is an inlining, optimizing, Cycript-to-JavaScript compiler and immediate-mode console environment that canbeinjectedintorunningprocesses(associatedtoSubstrate). • CydiaSubstrate: Aplatformthatmakesdevelopingthird-partyiOSadd-onseasierviadynamicappmanipulation orintrospection. • cURL:Isawellknownhttpclientwhichyoucanusetodownloadpackagesfastertoyourdevice. Thiscanbeagreat helpwhenyouneedtoinstalldifferentversionsofFrida-serveronyourdeviceforinstance. • DarwinCCTools: Ausefulsetoftoolslikenm,andstripthatarecapableofauditingmach-ofiles. • IPAInstallerConsole: ToolforinstallingIPAapplicationpackagesfromthecommandline. Afterinstallingtwocom- mandswillbeavailableinstallipaandipainstallerwhichareboththesame. • Frida: Anappyoucanusefordynamicinstrumentation. PleasenotethatFridahaschangeditsimplementationof itsAPIsovertime,whichmeansthatsomescriptsmightonlyworkwithspecificversionsoftheFrida-server(which forces you to update/downgrade the version also on macOS). Running Frida Server installed via APT or Cydia is recommended. Upgrading/downgradingafterwardscanbedone,byfollowingtheinstructionsofthisGithubissue. • Grep: Handytooltofilterlines. • Gzip: AwellknownZIPutility. • PreferenceLoader: ASubstrate-basedutilitythatallowsdeveloperstoaddentriestotheSettingsapplication,similar totheSettingsBundlesthatAppStoreappsuse. 552\\n• SOcketCAT:autilitywithwhichyoucanconnecttosocketstoreadandwritemessages. Thiscancomeinhandyif youwanttotracethesyslogoniOS12devices. BesidesCydiayoucanalsosshintoyouriOSdeviceandyoucaninstallthepackagesdirectlyviaapt-get,likeforexample adv-cmds. apt-getupdate apt-getinstalladv-cmds class-dump-z Platform: ios Availableat: https://code.google.com/archive/p/networkpx/wikis/class_dump_z.wiki class-dump-zisclass-dumpre-writtenfromscratchinC++,avoidingtheuseofdynamiccalls. Removingtheseunneces- sarycallsmakesclass-dump-znearly10timesfasterthanitspredecessor. Plutil Platform: ios Availableat: https://www.theiphonewiki.com/wiki/Plutil Aprogramthatcanconvert.plistfilesbetweenabinaryversionandanXMLversion-https://www.theiphonewiki.com/wi ki/Plutil otool Platform: ios Availableat: http://www.manpagez.com/man/1/otool/ otoolisatoolfordisplayingspecificpartsofobjectfilesorlibraries. ItworkswithMach-Ofilesanduniversalfileformats. BinaryCookieReader Platform: ios Availableat: https://github.com/as0ler/BinaryCookieReader AtooltodumpallthecookiesfromthebinaryCookies.binarycookiesfile-https://github.com/as0ler/BinaryCookieReader /blob/master/BinaryCookieReader.py objection for iOS Platform: ios Availableat: https://github.com/sensepost/objection ObjectionoffersseveralfeaturesspecifictoiOS.Youcanfindthefulllistoffeaturesontheproject’spage,butherearea fewinterestingones: • RepackageapplicationstoincludetheFridagadget • DisableSSLpinningforpopularmethods 553\\n• Accessapplicationstoragetodownloadoruploadfiles • ExecutecustomFridascripts • DumptheKeychain • Readplistfiles Allthesetasksandmorecanbeeasilydonebyusingthecommandsinobjection’sREPL.Forexample,youcanobtainthe classesusedinanapp,functionsofclassesorinformationaboutthebundlesofanappbyrunning: OWASP.iGoat-Swifton (iPhone:12.0)[usb] #ioshookinglistclasses OWASP.iGoat-Swifton (iPhone:12.0)[usb] #ioshookinglistclass_methods<ClassName> OWASP.iGoat-Swifton (iPhone:12.0)[usb] #iosbundleslist_bundles If you have a jailbroken device with frida-server installed, Objection can connect directly to the running Frida server to provideallitsfunctionalitywithoutneedingtorepackagetheapplication. However,itisnotalwayspossibletojailbreak thelatestversionofiOS,oryoumayhaveanapplicationwithadvancedjailbreakdetectionmechanisms. Theabilitytoperformadvanceddynamicanalysisonnon-jailbrokendevicesisoneofthefeaturesthatmakesOb- jectionincrediblyuseful. Afterfollowingtherepackagingprocessyouwillbeabletorunalltheaforementionedcommands whichmakeitveryeasytoquicklyanalyzeanapplication,orgetaroundbasicsecuritycontrols. Using Objection on iOS StartingupObjectiondependsonwhetheryou’vepatchedtheIPAorwhetheryouareusingajailbrokendevicerunning Frida-server. ForrunningapatchedIPA,objectionwillautomaticallyfindanyattacheddevicesandsearchforalistening Frida gadget. However, when using frida-server, you need to explicitly tell frida-server which application you want to analyze. ##ConnectingtoapatchedIPA $objectionexplore ##Usingfrida-pstogetthecorrectapplicationname $frida-ps -Ua|grep -iTelegram 983 Telegram ##ConnectingtotheTelegramappthroughFrida-server $objection --gadget=\"Telegram\" explore OnceyouareintheObjectionREPL,youcanexecuteanyoftheavailablecommands. Belowisanoverviewofsomeof themostusefulones: ##Showthedifferentstoragelocationsbelongingtotheapp $env ##Disablepopularsslpinningmethods $iossslpinningdisable ##DumptheKeychain $ioskeychaindump ##DumptheKeychain,includingaccessmodifiers.Theresultwillbewrittentothehostinmyfile.json $ioskeychaindump --json <myfile.json> ##Showthecontentofaplistfile $iosplistcat <myfile.plist> MoreinformationonusingtheObjectionREPLcanbefoundontheObjectionWiki swift-demangle Platform: ios swift-demangleisanXcodetoolthatdemanglesSwiftsymbols. Formoreinformationrunxcrun swift-demangle -help onceinstalled. 554\\nKeychain-Dumper Platform: ios Availableat: https://github.com/mechanico/Keychain-Dumper Keychain-dumperisaniOStooltocheckwhichkeychainitemsareavailabletoanattackeronceaniOSdevicehasbeen jailbroken. TheeasiestwaytogetthetoolistodownloadthebinaryfromitsGitHubrepoandrunitfromyourdevice: $gitclonehttps://github.com/ptoomey3/Keychain-Dumper $scp -P2222Keychain-Dumper/keychain_dumperroot@localhost:/tmp/ $ssh -p2222root@localhost iPhone:~root#chmod+x/tmp/keychain_dumper iPhone:~root#/tmp/keychain_dumper ForusageinstructionspleaserefertotheKeychain-dumperGitHubpage. Grapefruit Platform: ios Availableat: https://github.com/ChiChou/grapefruit GrapefruitisaniOSappassessmenttoolthatisusingtheFridaserverontheiOSdeviceandisabstractingmanypene- trationtestingtasksintoaWebUI.Itcanbeinstalledvianpm. $npminstall -gigf $grapefruit listeningonhttp://localhost:31337 Whenyouexecutethecommandgrapefruitalocalserverwillbestartedonport31337. Connectyourjailbrokendevice withtheFridaserverrunning,oranon-jailbrokendevicewitharepackagedappincludingFridatoyourmachineviaUSB. Onceyouclickonthe“iPhone”iconyouwillgetanoverviewofallinstalledapps. With Grapfruit it’s possible to explore different kinds of information concerning an iOS app. Once you selected the iOS appyoucanperformmanytaskssuchas: • Getinformationaboutthebinary • Viewfoldersandfilesusedbytheapplicationanddownloadthem • InspecttheInfo.plist • GetaUIDumpoftheappscreenshownontheiOSdevice • Listthemodulesthatareloadedbytheapp • Dumpclassnames •", "metadata": {"doc_id": "OWASP_MASTG", "chunk_id": 174}}