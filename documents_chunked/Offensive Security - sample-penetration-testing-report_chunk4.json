{"text": "configuration, the webserver represents an internal attack platform for a malicious party. With the ability to gain full administrative access, a malicious party could utilize this vulnerable system for a multitude of purposes, ranging from attacks against MegaCorp One itself, to attacks against its customers. It’s highly likely that the attackers would leverage this system for both purposes. 4 http://www.exploit-db.com/exploits/18411/ PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 12 of 34\\nJava Client Attacks Using the administrative access to the system, we conducted an analysis of the exploited system. This resulted in the discovery of a private section of the website that serves a Java applet only to specific workstations. This network range in question was later discovered to be the management network for MegaCorp One. Figure 14 - Htaccess rules reveal an additional subnet on the compromised network. Through examination of the log files and the Java applet present on the system, we found that the applet provided administrative functionality to a subset of internal users of MegaCorp One. This was advantageous to us as attackers, as it provided us with a potential path to internal systems that otherwise were not easily accessible. Upon obtaining permission from MegaCorp One, we added an additional applet to be downloaded by clients. The theory of this attack was that clients would access the trusted applet, allow it to run, and provide us with direct access to additional client hosts. This is a derivative of a common social engineering attack in which the victim is manipulated into running a malicious applet. In this case however, no effort was required to mislead the victim as the applet is already regarded as trusted. This attack worked as intended, providing us with access to an additional client system. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 13 of 34\\nFigure 15 – Using a malicious java applet it is possible to exploit a host on the management subnet. With this compromise in place, we obtained access to systems in the management network as indicated in Figure 16. Figure 16 – Successful java applet attack compromises the MegaCorp One management subnet. PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 14 of 34\\nEscalation to Local Administrator The access provided by the Java applet attack was limited to the level of a standard user. To maximize the impact of the compromise we wanted to escalate access to the level of Domain Administrator. As the first step, we needed to obtain local administrative access. In an effort to accomplish this, we examined the compromised system to identify how it could be leveraged. Using this approach we found a Group Policy Preferences file on the system that allowed us to decrypt the local administrative password56. Please see Appendix A for more information. Figure 17 – Using the newly gained access it is possible to retrieve the Groups.xml file from a domain controller. 5http://msdn.microsoft.com/en-us/library/cc422924.aspx 6http://blogs.technet.com/b/grouppolicy/archive/2009/04/22/passwords-in-group-policy-preferences- updated.aspx PTR-20130513 Copyright © 2013 Offensive Security", "metadata": {"doc_id": "Offensive Security - sample-penetration-testing-report", "chunk_id": 4}}