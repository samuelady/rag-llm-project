{"text": "• Open-source • Freetouse • CapableofanalyzingrecentAndroid/iOSapplications • Regularlyupdated • Strongcommunitysupport Ininstanceswherenosuitableopen-sourcealternativeexists,wemayincludeclosed-sourcetools. However,anyclosed- sourcetoolsincludedmustbefreetouse,asweaimtoavoidfeaturingpaidtoolswheneverpossible. Thisalsoextends tofreewareorcommunityeditionsofcommercialtools. Ourgoalistobevendor-neutralandtoserveasatrustedlearningresource,sothespecificcategoryof“automatedmobile applicationsecurityscanners”presentsauniquechallenge. Forthisreason,wehavehistoricallyavoidedincludingsuch toolsduetothecompetitivedisadvantagestheycancreateamongvendors. Incontrast, weprioritizetoolslikeMobSF thatprovidefullaccesstotheircodeandacomprehensivesetoftests,makingthemexcellentforeducationalpurposes. Toolsthatlackthisleveloftransparency,eveniftheyofferafreeversion,generallydonotmeettheinclusioncriteriaof theOWASPMASproject. Disclaimer: Each tool included in the MASTG examples was verified to be functional at the time it was added. However,thetoolsmaynotworkproperlydependingontheOSversionofbothyourhostcomputerandyourtest device. Thefunctionalityofthetoolscanalsobeaffectedbywhetheryou’reusingarootedorjailbrokendevice,the specific version of the rooting or jailbreaking method, and/or the tool version itself. The OWASP MASTG does not assumeanyresponsibilityfortheoperationalstatusofthesetools. Ifyouencounterabrokentoolorexample,we recommendsearchingonlineforasolutionorcontactingthetool’sproviderdirectly. IfthetoolhasaGitHubpage, youmayalsoopenanissuethere. gplaycli Platform: android Availableat: https://github.com/matlink/gplaycli gplaycliisaPythonbasedCLItooltosearch,installandupdateAndroidapplicationsfromtheGooglePlayStore. Follow the installation steps and you’re ready to run it. gplaycli offers several options, please refer to its help (-h) for more information. Ifyou’reunsureaboutthepackagename(orAppID)ofanapp,youmayperformakeywordbasedsearchforAPKs(-s): $gplaycli -s\"googlekeep\" Title Creator Size LastUpdate AppID Version GoogleKeep -notesandlists GoogleLLC 15.78MB 4Sep2019 com.google.android.keep 193510330 Maps -Navigate & Explore GoogleLLC 35.25MB 16May2019 com.google.android.apps.maps 1016200134 Google GoogleLLC 82.57MB 30Aug2019 com.google.android.googlequicksearchbox 301008048 Notethatregional(GooglePlay)restrictionsapplywhenusinggplaycli. Inordertoaccessappsthatarerestricted inyourcountryyoucanusealternativeappstoressuchastheonesdescribedin“AlternativeAppStores”. Xposed 524\\nPlatform: android Availableat: https://github.com/ElderDrivers/EdXposed Xposed does not work on Android 9 (API level 28). However, it was unofficially ported in 2019 under the name EdXposed,supportingAndroid8-10(APIlevel26till29). YoucanfindthecodeandusageexamplesatEdXposed Githubrepo. Xposedisaframeworkthatallowstomodifythesystemorapplicationaspectandbehavioratruntime,withoutmodifying anyAndroidapplicationpackage(APK)orre-flashing. Technically,itisanextendedversionofZygotethatexportsAPIs for running Java code when a new process is started. Running Java code in the context of the newly instantiated app makesitpossibletoresolve,hook,andoverrideJavamethodsbelongingtotheapp. Xposedusesreflectiontoexamine and modify the running app. Changes are applied in memory and persist only during the process’ runtime since the applicationbinariesarenotmodified. TouseXposed,youneedtofirstinstalltheXposedframeworkonarooteddeviceasexplainedonXDA-DevelopersXposed frameworkhub. ModulescanbeinstalledthroughtheXposedInstallerapp,andtheycanbetoggledonandoffthrough theGUI. Note: given that a plain installation of the Xposed framework is easily detected with SafetyNet, we recommend using MagisktoinstallXposed. Thisway,applicationswithSafetyNetattestationshouldhaveahigherchanceofbeingtestable withXposedmodules. XposedhasbeencomparedtoFrida. WhenyourunFridaserveronarooteddevice,youwillendupwithasimilarlyeffective setup. Both frameworks deliver a lot of value when you want to do dynamic instrumentation. When Frida crashes the app,youcantrysomethingsimilarwithXposed. Next,similartotheabundanceofFridascripts,youcaneasilyuseone ofthemanymodulesthatcomewithXposed, suchastheearlierdiscussedmoduletobypassSSLpinning(JustTrustMe andSSLUnpinning). Xposedincludesothermodules,suchasInspeckagewhichallowyoutodomoreindepthapplication testing as well. On top of that, you can create your own modules as well to patch often used security mechanisms of Androidapplications. Xposedcanalsobeinstalledonanemulatorthroughthefollowingscript: ##!/bin/sh echo \"Startyouremulatorwith'emulator-avdNAMEOFX86A8.0-writable-system-selinuxpermissive-wipe-data'\" adbroot && adbremount adbinstallSuperSU\\v2.79.apk #binarycanbedownloadedfromhttp://www.supersu.com/download adbpushroot_avd-master/SuperSU/x86/su/system/xbin/su adbshellchmod0755/system/xbin/su adbshellsetenforce0 adbshellsu --install adbshellsu --daemon& adbpushbusybox/data/busybox #binarycanbedownloadedfromhttps://busybox.net/ ##adbshell\"mount-oremount,rw/system&&mv/data/busybox/system/bin/busybox&&chmod755/system/bin/busybox&&/system/bin/busybox--install/system/bin\" adbshellchmod755/data/busybox adbshell 'sh-c\"./data/busybox--install/data\"' adbshell 'sh-c\"mkdir/data/xposed\"' adbpushxposed8.zip/data/xposed/xposed.zip #canbedownloadedfromhttps://dl-xda.xposed.info/framework/ adbshellchmod0755/data/xposed adbshell 'sh-c\"./data/unzip/data/xposed/xposed.zip-d/data/xposed/\"' adbshell 'sh-c\"cp/data/xposed/xposed/META-INF/com/google/android/*.*/data/xposed/xposed/\"' echo \"Nowadbshellanddo'su',next:goto./data/xposed/xposed,makeflash-script.shexecutableandrunitinthatdirectoryafter runningSUperSU\" echo \"Next,restartemulator\" echo \"Next,adbinstallXposedInstaller_3.1.5.apk\" echo \"Next,runinstallerandthenadbreboot\" echo \"Wanttouseitagain?Startyouremulatorwith'emulator-avdNAMEOFX86A8.0-writable-system-selinuxpermissive'\" APKiD Platform: android Availableat: https://github.com/rednaga/APKiD APKiDgivesyouinformationabouthowanAPKwasmade. Itidentifiesmanycompilers,packers,obfuscators,andother weirdstuff. Formoreinformationonwhatthistoolcanbeusedfor,checkout: 525\\n• AndroidCompilerFingerprinting • DetectingPiratedandMaliciousAndroidAppswithAPKiD • APKiD:PEiDforAndroidApps • APKiD:FastIdentificationofAppShieldingProducts JustTrustMe Platform: android Availableat: https://github.com/Fuzion24/JustTrustMe AnXposedModuletobypassSSLcertificatepinning-https://github.com/Fuzion24/JustTrustMe objection for Android Platform: android Availableat: https://github.com/sensepost/objection ObjectionoffersseveralfeaturesspecifictoAndroid. Youcanfindthefulllistoffeaturesontheproject’spage,buthere areafewinterestingones: • RepackageapplicationstoincludetheFridagadget • DisableSSLpinningforpopularmethods • Accessapplicationstoragetodownloadoruploadfiles • ExecutecustomFridascripts • ListtheActivities,ServicesandBroadcastreceivers • StartActivities Ifyouhavearooteddevicewithfrida-serverinstalled,ObjectioncanconnectdirectlytotherunningFridaservertoprovide allitsfunctionalitywithoutneedingtorepackagetheapplication. However, itisnotalwayspossibletorootanAndroid deviceortheappmaycontainadvancedRASPcontrolsforrootdetection,soinjectingafrida-gadgetmaybetheeasiest waytobypassthosecontrols. Theabilitytoperformadvanceddynamicanalysisonnon-rooteddevicesisoneofthefeaturesthatmakesObjection incrediblyuseful. Afterfollowingtherepackagingprocessyouwillbeabletorunalltheaforementionedcommandswhich makeitveryeasytoquicklyanalyzeanapplication,orbypassbasicsecuritycontrols. Using Objection on Android Starting up Objection depends on whether you’ve patched the APK or whether you are using a rooted device running Frida-server. ForrunningapatchedAPK,objectionwillautomaticallyfindanyattacheddevicesandsearchforalistening Frida gadget. However, when using frida-server, you need to explicitly tell frida-server which application you want to analyze. ##ConnectingtoapatchedAPK objectionexplore ##Findthecorrectnameusingfrida-ps $frida-ps -Ua|grep -itelegram 30268 Telegram org.telegram.messenger ##ConnectingtotheTelegramappthroughFrida-server $objection --gadget=\"org.telegram.messenger\" explore OnceyouareintheObjectionREPL,youcanexecuteanyoftheavailablecommands. Belowisanoverviewofsomeof themostusefulones: 526\\n##Showthedifferentstoragelocationsbelongingtotheapp $env ##Disablepopularsslpinningmethods $androidsslpinningdisable ##Listitemsinthekeystore $androidkeystorelist ##Trytocircumventrootdetection $androidrootdisable MoreinformationonusingtheObjectionREPLcanbefoundontheObjectionWiki Drozer Platform: android Availableat: https://github.com/FSecureLABS/drozer Drozer is an Android security assessment framework that allows you to search for security vulnerabilities in apps and devicesbyassumingtheroleofathird-partyappinteractingwiththeotherapplication’sIPCendpointsandtheunderlying OS. The advantage of using drozer consists on its ability to automate several tasks and that it can be expanded through modules. Themodulesareveryhelpfulandtheycoverdifferentcategoriesincludingascannercategorythatallowsyou toscanforknowndefectswithasimplecommandsuchasthemodulescanner.provider.injectionwhichdetectsSQL injections in content providers in all", "metadata": {"doc_id": "OWASP_MASTG", "chunk_id": 168}}