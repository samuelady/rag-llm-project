{"text": "binary, such as the architecture, the list of shared libraries, the list of classesandmethods,stringsandmore. Let’susetheDamnVulnerableiOSAppDVIAv1asanexample. Openitsmainbinarywithradare2: r2DamnVulnerableIOSApp Binary Information Togetinformationaboutthebinary, youcanusetheicommand. Thiscommandwilllistinformationaboutthebinary, suchasthearchitecture,thelistofsharedlibraries,thelistofclassesandmethods,stringsandmore. [0x1000180c8]>i ... size 0x43d5f0 humansz 4.2M mode r-x format mach064 iorw false block 0x100 packet xtr.fatmach0 ... lang objcwithblocks linenum false lsyms false nx false os ios pic true relocs true sanitizefalse static false strippedtrue Classes and Methods Andthenwecanproceedtoextractinformationaboutthemethodsintheapplication’ssourcecode. Todothis,weneed toloadtheapplicationbinaryintoradareandthenlisttheclassesandmethodsinthebinary. [0x1000180c8]>icc ... @interfaceSFAntiPiracy:NSObject { } +(int)isPirated +(int)isJailbroken +(void)killApplication +(bool)isTheDeviceJailbroken +(bool)isTheApplicationCracked +(bool)isTheApplicationTamperedWith +(int)urlCheck ... @end Notetheplussign,whichmeansthatthisisaclassmethodthatreturnsaBOOLtype. Aminussignwouldmeanthatthis isaninstancemethod. Refertolatersectionstounderstandthepracticaldifferencebetweenthese. Linked Libraries Thefollowingcommandislistingsharedlibraries: 369\\n[0x1000180c8]>il [Linkedlibraries] /System/Library/Frameworks/SystemConfiguration.framework/SystemConfiguration /System/Library/Frameworks/StoreKit.framework/StoreKit /System/Library/Frameworks/Security.framework/Security /System/Library/Frameworks/QuartzCore.framework/QuartzCore /System/Library/Frameworks/MobileCoreServices.framework/MobileCoreServices /usr/lib/libz.1.dylib /System/Library/Frameworks/CoreLocation.framework/CoreLocation /System/Library/Frameworks/CoreGraphics.framework/CoreGraphics /System/Library/Frameworks/CFNetwork.framework/CFNetwork /System/Library/Frameworks/AudioToolbox.framework/AudioToolbox /System/Library/Frameworks/CoreData.framework/CoreData /System/Library/Frameworks/UIKit.framework/UIKit /System/Library/Frameworks/Foundation.framework/Foundation /usr/lib/libobjc.A.dylib /usr/lib/libSystem.B.dylib /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation 16libraries Strings Obtainingstringsisveryusefulwhenreverseengineeringanappbecauseitcangiveyoualotofinformationaboutthe app’sfunctionality. Forexample,youcanfindURLs,APIendpoints,encryptionkeys,andmore. Youcanalsofindstrings that will point you to interesting functions, such as the login function or a function that checks whether the device is jailbroken. [0x1000180c8]>izz~cstring |less 299030x001d0b4c0x1001d0b4c5 6 5.__TEXT.__cstring ascii Admin 299040x001d0b520x1001d0b5213 14 5.__TEXT.__cstring ascii This!sA5Ecret 299050x001d0b600x1001d0b6015 16 5.__TEXT.__cstring ascii pushSuccessPage 299060x001d0b700x1001d0b704 5 5.__TEXT.__cstring ascii Oops 299070x001d0b750x1001d0b7530 31 5.__TEXT.__cstring ascii IncorrectUsernameorPassword 299080x001d0b940x1001d0b9417 18 5.__TEXT.__cstring ascii usernameTextField 299090x001d0ba60x1001d0ba639 40 5.__TEXT.__cstring ascii T@\"UITextField\",&,N,V_usernameTextField 299100x001d0bce0x1001d0bce17 18 5.__TEXT.__cstring ascii passwordTextField ... 299150x001d0ca80x1001d0ca818 19 5.__TEXT.__cstring ascii http://google.com/ 299260x001d0d730x1001d0d7337 38 5.__TEXT.__cstring ascii RequestSentusingpinning,lookout! 299270x001d0d990x1001d0d9977 78 5.__TEXT.__cstring ascii Certificatevalidationfailed. Youwillhavetodobetterthanthis,myboy!! Patching React Native Apps Platform: ios IftheReactNativeframeworkhasbeenusedfordevelopment,themainapplicationcodeisinthefilePayload/[APP]. app/main.jsbundle. ThisfilecontainstheJavaScriptcode. Mostofthetime,theJavaScriptcodeinthisfileisminified. WiththetoolJStillery,ahuman-readableversionofthefilecanberetried,whichwillallowcodeanalysis. TheCLIversion ofJStilleryandthelocalserverarepreferabletotheonlineversionbecausethelatterdisclosesthesourcecodetoathird party. Atinstallationtime,theapplicationarchiveisunpackedintothefolder/private/var/containers/Bundle/Application/ [GUID]/[APP].appfromiOS10onward,sothemainJavaScriptapplicationfilecanbemodifiedatthislocation. Toidentifytheexactlocationoftheapplicationfolder,youcanusethetoolipainstaller: 1. Use the command ipainstaller -l to list the applications installed on the device. Get the name of the target applicationfromtheoutputlist. 2. Usethecommandipainstaller -i [APP_NAME]todisplayinformationaboutthetargetapplication,includingthe installationanddatafolderlocations. 3. TakethepathreferencedatthelinethatstartswithApplication:. UsethefollowingapproachtopatchtheJavaScriptfile: 1. Navigatetotheapplicationfolder. 2. CopythecontentsofthefilePayload/[APP].app/main.jsbundletoatemporaryfile. 370\\n3. UseJStillerytobeautifyandde-obfuscatethecontentsofthetemporaryfile. 4. Identifythecodeinthetemporaryfilethatshouldbepatchedandpatchit. 5. PutthepatchedcodeonasinglelineandcopyitintotheoriginalPayload/[APP].app/main.jsbundlefile. 6. Closeandrestarttheapplication. Patching Platform: ios Timetogetserious! Asyoualreadyknow,IPAfilesareactuallyZIParchives,soyoucanuseanyZIPtooltounpackthe archive. unzip UnCrackable-Level1.ipa Retrieving Cross References Platform: ios Ghidra can be used for analyzing the iOS binaries and obtaining cross references by right clicking the desired function andselectingShowReferencesto. Installing Apps Platform: ios When you install an application without using Apple’s App Store, this is called sideloading. There are various ways of sideloadingwhicharedescribedbelow. OntheiOSdevice,theactualinstallationprocessisthenhandledbytheinstalld daemon, which will unpack and install the application. To integrate app services or be installed on an iOS device, all applicationsmustbesignedwithacertificateissuedbyApple. Thismeansthattheapplicationcanbeinstalledonlyafter successful code signature verification. On a jailbroken phone, however, you can circumvent this security feature with AppSync,apackageavailableintheCydiastore. Itcontainsnumeroususefulapplicationsthatleveragejailbreak-provided root privileges to execute advanced functionality. AppSync is a tweak that patches installd, allowing the installation of fake-signedIPApackages. DifferentmethodsexistforinstallinganIPApackageontoaniOSdevice,whicharedescribedindetailbelow. PleasenotethatiTunesisnolongeravailableinmacOSCatalina. IfyouareusinganolderversionofmacOS,iTunes isstillavailablebutsinceiTunes12.7itisnotpossibletoinstallapps. Cydia Impactor CydiaImpactorwasoriginallycreatedtojailbreakiPhones,buthasbeenrewrittentosignandinstallIPApackagestoiOS devices via sideloading (and even APK files to Android devices). Cydia Impactor is available for Windows, macOS and Linux. Astepbystepguideandtroubleshootingstepsareavailableonyalujailbreak.net. libimobiledevice OnLinuxandalsomacOS,youcanalternativelyuselibimobiledevice,across-platformsoftwareprotocollibraryandaset oftoolsfornativecommunicationwithiOSdevices. ThisallowsyoutoinstallappsoveraUSBconnectionbyexecuting ideviceinstaller. TheconnectionisimplementedwiththeUSBmultiplexingdaemonusbmuxd,whichprovidesaTCPtunnel overUSB. ThepackageforlibimobiledevicewillbeavailableinyourLinuxpackagemanager. OnmacOSyoucaninstalllibimobilede- viceviabrew: 371\\nbrewinstalllibimobiledevice brewinstallideviceinstaller After the installation you have several new command line tools available, such as ideviceinfo, ideviceinstaller or idevicedebug. ##ThefollowingcommandwillshowdetailedinformationabouttheiOSdeviceconnectedviaUSB. $ideviceinfo ##ThefollowingcommandwillinstalltheIPAtoyouriOSdevice. $ideviceinstaller -iiGoat-Swift_v1.0-frida-codesigned.ipa ... Install:Complete ##Thefollowingcommandwillstarttheappindebugmode,byprovidingthebundlename.Thebundlenamecanbefoundinthepreviouscommandafter\"Installing\". $idevicedebug -drunOWASP.iGoat-Swift ipainstaller TheIPAcanalsobedirectlyinstalledontheiOSdeviceviathecommandlinewithipainstaller. Aftercopyingthefileover tothedevice,forexampleviascp,youcanexecuteipainstallerwiththeIPA’sfilename: ipainstallerApp_name.ipa ios-deploy OnmacOSyoucanalsousetheios-deploytooltoinstalliOSappsfromthecommandline. You’llneedtounzipyourIPA sinceios-deployusestheappbundlestoinstallapps. unzip Name.ipa ios-deploy --bundle 'Payload/Name.app' -W-d-v AftertheappisinstalledontheiOSdevice,youcansimplystartitbyaddingthe-mflagwhichwilldirectlystartdebugging withoutinstallingtheappagain. ios-deploy --bundle 'Payload/Name.app' -W-d-v-m Xcode ItisalsopossibletousetheXcodeIDEtoinstalliOSappsbydoingthefollowingsteps: 1. StartXcode 2. SelectWindow/DevicesandSimulators 3. SelecttheconnectediOSdeviceandclickonthe+signinInstalledApps. Allow Application Installation on a Non-iPad Device SometimesanapplicationcanrequiretobeusedonaniPaddevice. IfyouonlyhaveiPhoneoriPodtouchdevicesthen youcanforcetheapplicationtoaccepttobeinstalledandusedonthesekindsofdevices. Youcandothisbychanging thevalueofthepropertyUIDeviceFamilytothevalue1intheInfo.plistfile. <?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE plist PUBLIC\"-//Apple//DTDPLIST1.0//EN\"\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"> <plist version=\"1.0\"> <dict> <key>UIDeviceFamily</key> <array> <integer>1</integer> </array> </dict> </plist> 372\\nItisimportanttonotethatchangingthisvaluewillbreaktheoriginalsignatureoftheIPAfilesoyouneedtore-signthe IPA,aftertheupdate,inordertoinstallitonadeviceonwhichthesignaturevalidationhasnotbeendisabled. ThisbypassmightnotworkiftheapplicationrequirescapabilitiesthatarespecifictomoderniPadswhileyouriPhoneor iPodisabitolder. PossiblevaluesforthepropertyUIDeviceFamilycanbefoundintheAppleDeveloperdocumentation. Onefundamentalstepwhenanalyzingappsisinformationgathering. Thiscanbedonebyinspectingtheapppackage on your host computer or remotely by", "metadata": {"doc_id": "OWASP_MASTG", "chunk_id": 130}}