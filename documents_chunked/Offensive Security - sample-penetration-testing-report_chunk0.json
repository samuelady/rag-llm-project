{"text": "Penetration Test Report MegaCorp One August 10th, 2013 Offensive Security Services, LLC 19706 One Norman Blvd. Suite B #253 Cornelius, NC 28031 United States of America Tel: 1-402-608-1337 Fax: 1-704-625-3787 Email: info@offsec.com\\nTable of Contents Executive Summary 1 Summary of Results 2 Attack Narrative 3 Remote System Discovery 3 Admin Webserver Interface Compromise 6 Interactive Shell to Admin Server 9 Administrative Privilege Escalation 12 Java Client Attacks 13 Escalation to Local Administrator 15 Deep Packet Inspection Bypass 16 Citrix Environment Compromise 20 Escalation to Domain Administrator 24 Conclusion 28 Recommendations 29 Risk Rating 30 Appendix A: Vulnerability Detail and Mitigation 31 Risk Rating Scale 31 Default or Weak Credentials 31 Password Reuse 32 Shared Local Administrator Password 32 Patch Management 33 DNS Zone Transfer 33 Default Apache Files 33 Appendix B: About Offensive Security 34 PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page i\\nExecutive Summary Offensive Security was contracted by MegaCorp One to conduct a penetration test in order to determine its exposure to a targeted attack. All activities were conducted in a manner that simulated a malicious actor engaged in a targeted attack against MegaCorp One with the goals of: o Identifying if a remote attacker could penetrate MegaCorp One’s defenses o Determining the impact of a security breach on: o Confidentiality of the company’s private data o Internal infrastructure and availability of MegaCorp One’s information systems Efforts were placed on the identification and exploitation of security weaknesses that could allow a remote attacker to gain unauthorized access to organizational data. The attacks were conducted with the level of access that a general Internet user would have. The assessment was conducted in accordance with the recommendations outlined in NIST SP 800-1151 with all tests and actions being conducted under controlled conditions. 1 http://csrc.nist.gov/publications/nistpubs/800-115/SP800-115.pdf PTR-20130513 Copyright © 2013 Offensive Security Services LLC. All rights reserved. Page 1 of 34\\nSummary of Results Initial reconnaissance of the MegaCorp One network resulted in the discovery of a misconfigured DNS server that allowed a DNS zone transfer. The results provided us with a listing of specific hosts to target for this assessment. An examination of these hosts revealed a password-protected administrative webserver interface. After creating a custom wordlist using terms identified on the MegaCorp One’s website we were able to gain access to this interface by uncovering the password via brute-force. An examination of the administrative interface revealed that it was vulnerable to a remote code injection vulnerability, which was used to obtain interactive access to the underlying operating system. This initial compromise was escalated to administrative access due to a lack of appropriate system updates on the webserver. After a closer examination, we discovered that the compromised webserver utilizes a Java applet for administrative users. We added a malicious payload to this applet, which gave us interactive access to workstations used by MegaCorp One’s administrators. Using the compromised webserver as a pivot point along with passwords recovered from it, we were able to target previously inaccessible internal resources. This resulted", "metadata": {"doc_id": "Offensive Security - sample-penetration-testing-report", "chunk_id": 0}}